import{r as y,j as e,R as _,b as D,y as L,W as re,Y as oe,a as Z}from"./app-CF7YME_T.js";import{r as a}from"./index-DKFUDnck.js";import{_ as Q,A as ce,C as de}from"./AuthenticatedLayout-BuQHVsRe.js";import{D as xe,S as ie,E as ue,C as fe,P as he}from"./ExportButton-nZQNGxrB.js";import{T as X}from"./TextInput-Byy2MORQ.js";import{U as je}from"./UploadItemField-CEqukf77.js";import{I as k}from"./InputLabel-BdHT6X-y.js";import{I as w}from"./InputError-BtSJWETP.js";import"./transition-D6OMmc5L.js";import"./index-DAXshhI0.js";function ee({siteId:u,name:c,value:s,handleEditAbleItem:h}){const[n,l]=y.useState(s||""),j=x=>{l(x),h(u,c,x)};return e.jsx("div",{className:"w-full h-full",children:e.jsx(xe,{selected:n,onChange:x=>j(x),className:"border-none focus:ring-0 w-full bg-transparent !shadow-none text-[12px] font-medium",dateFormat:"dd/MM/yyyy"})})}function se({siteId:u,name:c,value:s,options:h,handleEditAbleItem:n}){const[l,j]=y.useState(s||""),x=b=>{j(b),n(u,c,b)};return e.jsx("div",{className:"w-full h-full",children:e.jsxs("select",{value:l,onChange:b=>{x(b.target.value)},className:"border-none focus:ring-0 w-full bg-transparent !shadow-none text-[12px] font-medium",children:[e.jsx("option",{value:"",children:"Select"}),h.length>0&&h.map((b,v)=>e.jsx("option",{value:b.value,children:b.label},v))]})})}function te({siteId:u,name:c,value:s,handleEditAbleItem:h}){const[n,l]=y.useState(s||""),j=x=>{l(x),h(u,c,x)};return e.jsx("div",{className:"w-full h-full",children:e.jsx("textarea",{className:"border-none focus:ring-0 bg-transparent !shadow-none text-[12px] font-medium w-full",value:n,rows:1,onChange:x=>{j(x.target.value)}})})}function ye({mappingDialog:u,setMappingDialog:c,mappingData:s,setBatchId:h}){var P,T,W,A,V,J,O,M,R,H,U,K,Y;const n=()=>c(!u),[l,j]=y.useState({file_path:s?s==null?void 0:s.filePath:"",site_name:"",cell_name:"",lon:"",lat:"",bb_type:"",rru_type:"",antenna_type:"",frequency:"",pci:"",azimuth:"",height:"",last_epo:"",next_epo:""}),[x,b]=y.useState({}),[v,S]=y.useState(!1),[m,$]=y.useState(""),[N,i]=y.useState(""),f=(t,o)=>{j(E=>({...E,[t]:o}))};y.useEffect(()=>{f("file_path",s!=null&&s.filePath?s==null?void 0:s.filePath:"")},[s]);const z=async t=>{var E,G,B,q,r,p;t.preventDefault();let o={};if(["site_name","cell_name","lon","lat","bb_type","rru_type","antenna_type","frequency","pci","azimuth","height","last_epo","next_epo"].forEach(d=>{l[d]||(o[d]="This field is required.")}),b(o),Object.keys(o).length>0){console.log(o);return}try{S(!0);const d=await D.post(route("site.field.map.save"),l);d!=null&&d.data&&(i((G=(E=d==null?void 0:d.data)==null?void 0:E.success)==null?void 0:G.message),h((B=d==null?void 0:d.data)==null?void 0:B.batch_id),setTimeout(()=>{c(!1),i(""),$("")},3e3),L.visit(route("site.field.name.index")))}catch(d){console.log("error:",d),$(`${(p=(r=(q=d==null?void 0:d.response)==null?void 0:q.data)==null?void 0:r.error)==null?void 0:p.message}`)}finally{S(!1)}};return e.jsx(_.Fragment,{children:e.jsxs(a.Dialog,{open:u,size:"xs",children:[e.jsx(a.DialogHeader,{children:"CSV Mapping"}),m&&e.jsx("p",{className:"text-red-500 font-medium text-[12px] px-4",children:m}),N&&e.jsx("p",{className:"text-green-500 font-medium text-[12px] px-4",children:N}),e.jsxs(a.DialogBody,{className:"px-6 overflow-scroll",children:[e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{value:"Site Name",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:l.site_name,onChange:t=>f("site_name",t.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((P=s==null?void 0:s.header)==null?void 0:P.length)>0&&(s==null?void 0:s.header.map((t,o)=>e.jsx("option",{value:t,children:t},o)))]}),e.jsx(w,{message:x.site_name,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{value:"Cell Name",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:l.cell_name,onChange:t=>f("cell_name",t.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((T=s==null?void 0:s.header)==null?void 0:T.length)>0&&(s==null?void 0:s.header.map((t,o)=>e.jsx("option",{value:t,children:t},o)))]}),e.jsx(w,{message:x.cell_name,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{value:"Lon",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:l.lon,onChange:t=>f("lon",t.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((W=s==null?void 0:s.header)==null?void 0:W.length)>0&&(s==null?void 0:s.header.map((t,o)=>e.jsx("option",{value:t,children:t},o)))]}),e.jsx(w,{message:x.lon,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{value:"Lat",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:l.lat,onChange:t=>f("lat",t.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((A=s==null?void 0:s.header)==null?void 0:A.length)>0&&(s==null?void 0:s.header.map((t,o)=>e.jsx("option",{value:t,children:t},o)))]}),e.jsx(w,{message:x.lat,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{value:"BB Type",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:l.bb_type,onChange:t=>f("bb_type",t.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((V=s==null?void 0:s.header)==null?void 0:V.length)>0&&(s==null?void 0:s.header.map((t,o)=>e.jsx("option",{value:t,children:t},o)))]}),e.jsx(w,{message:x.bb_type,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{value:"RRU Type",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:l.rru_type,onChange:t=>f("rru_type",t.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((J=s==null?void 0:s.header)==null?void 0:J.length)>0&&(s==null?void 0:s.header.map((t,o)=>e.jsx("option",{value:t,children:t},o)))]}),e.jsx(w,{message:x.rru_type,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{value:"Antenna Type",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:l.antenna_type,onChange:t=>f("antenna_type",t.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((O=s==null?void 0:s.header)==null?void 0:O.length)>0&&(s==null?void 0:s.header.map((t,o)=>e.jsx("option",{value:t,children:t},o)))]}),e.jsx(w,{message:x.antenna_type,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{value:"Frequency",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:l.frequency,onChange:t=>f("frequency",t.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((M=s==null?void 0:s.header)==null?void 0:M.length)>0&&(s==null?void 0:s.header.map((t,o)=>e.jsx("option",{value:t,children:t},o)))]}),e.jsx(w,{message:x.frequency,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{value:"PCI",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:l.pci,onChange:t=>f("pci",t.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((R=s==null?void 0:s.header)==null?void 0:R.length)>0&&(s==null?void 0:s.header.map((t,o)=>e.jsx("option",{value:t,children:t},o)))]}),e.jsx(w,{message:x.pci,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{value:"Azimuth",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:l.azimuth,onChange:t=>f("azimuth",t.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((H=s==null?void 0:s.header)==null?void 0:H.length)>0&&(s==null?void 0:s.header.map((t,o)=>e.jsx("option",{value:t,children:t},o)))]}),e.jsx(w,{message:x.azimuth,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{value:"Height",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:l.height,onChange:t=>f("height",t.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((U=s==null?void 0:s.header)==null?void 0:U.length)>0&&(s==null?void 0:s.header.map((t,o)=>e.jsx("option",{value:t,children:t},o)))]}),e.jsx(w,{message:x.height,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{value:"Last EPO",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:l.last_epo,onChange:t=>f("last_epo",t.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((K=s==null?void 0:s.header)==null?void 0:K.length)>0&&(s==null?void 0:s.header.map((t,o)=>e.jsx("option",{value:t,children:t},o)))]}),e.jsx(w,{message:x.last_epo,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{value:"Next EPO",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:l.next_epo,onChange:t=>f("next_epo",t.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((Y=s==null?void 0:s.header)==null?void 0:Y.length)>0&&(s==null?void 0:s.header.map((t,o)=>e.jsx("option",{value:t,children:t},o)))]}),e.jsx(w,{message:x.next_epo,className:"!text-[12px] font-medium"})]})]})})]}),e.jsxs(a.DialogFooter,{children:[e.jsx(a.Button,{variant:"text",color:"red",onClick:n,className:"mr-1",disabled:v,children:e.jsx("span",{children:"Cancel"})}),e.jsx(a.Button,{variant:"gradient",color:"green",onClick:z,loading:v,children:e.jsx("span",{children:"Confirm"})})]})]})})}function ve({site_id:u,changedItems:c,setChangedItems:s}){const[h,n]=y.useState(!1),l=async j=>{var x,b,v;if(c.length>0){let S=c.filter(m=>m.site_id===j)[0];if(S){n(!0);const m=await axios.post(route("site.field.name.save.item"),{site_id:S==null?void 0:S.site_id,items:S==null?void 0:S.items});(x=m==null?void 0:m.data)!=null&&x.success&&(n(!1),Q.success((v=(b=m==null?void 0:m.data)==null?void 0:b.success)==null?void 0:v.message),s($=>$.filter(N=>N.site_id!==j)))}}};return e.jsx(a.Button,{size:"sm",className:"capitalize py-1 px-2 rounded font-semibold",disabled:!c.some(j=>j.site_id===u),onClick:()=>{l(u)},loading:h,children:"Save"})}const me={text:te,date:ee,dropdown:se};function Ne({column:u,item:c,value:s,handleEditAbleItem:h}){const n=me[u.input_type];return e.jsx(n,{siteId:c==null?void 0:c.id,name:u.key,value:s,handleEditAbleItem:h,options:JSON.parse(u==null?void 0:u.options)})}function be({addColumnDialog:u,setAddColumnDialog:c}){const{data:s,setData:h,post:n,processing:l,errors:j,reset:x}=re({type:"fw_site",name:"",key:"",input_type:"",options:""}),b=v=>{v.preventDefault(),n(route("additional.columns.save.item"),{onSuccess:()=>{c(!1),x()}})};return e.jsxs(a.Dialog,{open:u,size:"xs",children:[e.jsx(a.DialogHeader,{children:"Add New Column"}),e.jsxs(a.DialogBody,{children:[e.jsxs("div",{className:"form-item mb-4",children:[e.jsx(k,{value:"Column Name",className:"mb-1"}),e.jsx(X,{className:"w-full text-sm font-medium text-gray-600",placeholder:"Column Name...",value:s.name,onChange:v=>h("name",v.target.value)}),e.jsx(w,{message:j.name,className:"text-sm font-medium"})]}),e.jsxs("div",{className:"form-item mb-4",children:[e.jsx(k,{value:"Column Key",className:"mb-1"}),e.jsx(X,{className:"w-full text-sm font-medium text-gray-600",placeholder:"Column key...",value:s.key,onChange:v=>h("key",v.target.value)}),e.jsx(w,{message:j.key,className:"text-sm font-medium"})]}),e.jsxs("div",{className:"form-item mb-4",children:[e.jsx(k,{value:"Column Input Type",className:"mb-1"}),e.jsxs("select",{className:"w-full rounded text-sm border-gray-300 shadow-sm font-medium text-gray-600 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600",value:s.input_type,onChange:v=>h("input_type",v.target.value),children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"text",children:"Text"}),e.jsx("option",{value:"date",children:"Date"}),e.jsx("option",{value:"dropdown",children:"DropDown"})]}),e.jsx(w,{message:j.input_type,className:"text-sm font-medium"})]}),(s==null?void 0:s.input_type)==="dropdown"&&e.jsxs("div",{className:"form-item mb-4",children:[e.jsx(k,{value:"Dropdown Options seprated by (|)",className:"mb-1"}),e.jsx("textarea",{className:"w-full rounded text-sm border-gray-300 shadow-sm font-normal focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600",placeholder:"Dropdown Options seprated by | ...",rows:4,value:s.options,onChange:v=>h("options",v.target.value)}),e.jsx(w,{message:j.options,className:"text-sm font-medium"})]})]}),e.jsxs(a.DialogFooter,{children:[e.jsx(a.Button,{variant:"text",color:"red",onClick:()=>c(!u),className:"mr-1 capitalize",children:e.jsx("span",{children:"Cancel"})}),e.jsx(a.Button,{variant:"gradient",color:"green",onClick:v=>b(v),className:"capitalize",loading:l,children:e.jsx("span",{children:"Submit"})})]})]})}function pe({hideColumnDialog:u,setHideColumnDialog:c,columns:s,additional_columns:h,hidden_columns:n}){const l=()=>c(!u),{data:j,setData:x,post:b,processing:v,errors:S,reset:m}=re({type:"fw_site",key:"hide",items:(n==null?void 0:n.length)>0?n:[]}),$=(i,f)=>{const z=i.target.checked;x(P=>z?{...P,items:[...P.items,f]}:{...P,items:P.items.filter(T=>T!==f)})},N=i=>{i.preventDefault(),b(route("hide.columns.item"),{onSuccess:()=>{c(!1),m()}})};return e.jsxs(a.Dialog,{open:u,size:"xs",children:[e.jsx(a.DialogHeader,{children:"Hide Column"}),e.jsx(a.DialogBody,{children:e.jsxs("div",{className:"form-item",children:[e.jsx("p",{className:"text-[#333] font-semibold",children:"Please select the column you want to hide"}),e.jsxs("div",{className:"form-item grid grid-cols-2",children:[(s==null?void 0:s.length)>0&&s.map((i,f)=>e.jsx(_.Fragment,{children:e.jsx(a.Checkbox,{containerProps:{className:"py-3"},className:"w-5 h-5 rounded-md",label:e.jsx(a.Typography,{color:"blue-gray",className:"font-medium text-sm",children:i==null?void 0:i.name}),onChange:z=>$(z,i==null?void 0:i.key),defaultChecked:n==null?void 0:n.includes(i==null?void 0:i.key)})},f)),(h==null?void 0:h.length)>0&&h.map((i,f)=>e.jsx(_.Fragment,{children:e.jsx(a.Checkbox,{containerProps:{className:"py-3"},className:"w-5 h-5 rounded-md",label:e.jsx(a.Typography,{color:"blue-gray",className:"font-medium text-sm",children:i==null?void 0:i.name}),onChange:z=>$(z,i==null?void 0:i.key),defaultChecked:n==null?void 0:n.includes(i==null?void 0:i.key)})},f))]})]})}),e.jsxs(a.DialogFooter,{children:[e.jsx(a.Button,{variant:"text",color:"red",onClick:l,className:"mr-1 capitalize",children:e.jsx("span",{children:"Cancel"})}),e.jsx(a.Button,{variant:"gradient",color:"green",onClick:i=>{N(i)},className:"capitalize",children:e.jsx("span",{children:"Confirm"})})]})]})}function ge({renameColumnDialog:u,setRenameColumnDialog:c,columns:s,additional_columns:h}){var $;const{data:n,setData:l,post:j,processing:x,errors:b,reset:v}=re({type:"fw_site",key:"rename",items:[]});y.useEffect(()=>{u&&l(N=>{const i=[...s.map(f=>({key:f.key,name:f.name})),...h.map(f=>({key:f.key,name:f.name}))];return{...N,items:i}})},[u]);const S=(N,i)=>{l(f=>({...f,items:f.items.map(z=>z.key===N?{...z,name:i}:z)}))},m=N=>{N.preventDefault(),j(route("rename.columns.item"),{onSuccess:()=>{c(!1),v()}})};return e.jsxs(a.Dialog,{open:u,size:"xs",children:[e.jsx(a.DialogHeader,{children:"Rename Columns"}),e.jsx(a.DialogBody,{className:"h-[42rem] overflow-scroll",children:e.jsx("div",{className:"grid grid-cols-2 gap-3",children:(n==null?void 0:n.items.length)>0&&(($=n==null?void 0:n.items)==null?void 0:$.map((N,i)=>e.jsx("div",{className:"form-item mb-2",children:e.jsx(X,{className:"w-full text-sm font-medium text-gray-600",value:N==null?void 0:N.name,onChange:f=>S(N==null?void 0:N.key,f.target.value)})},i)))})}),e.jsxs(a.DialogFooter,{children:[e.jsx(a.Button,{variant:"text",color:"red",className:"mr-1 capitalize",onClick:()=>c(!1),children:"Cancel"}),e.jsx(a.Button,{variant:"gradient",color:"green",className:"capitalize",onClick:N=>m(N),loading:x,children:"Submit"})]})]})}function Ce({columns:u,additional_columns:c,hidden_columns:s}){const[h,n]=y.useState(!1),[l,j]=y.useState(!1),[x,b]=y.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(a.Menu,{children:[e.jsx(a.MenuHandler,{children:e.jsx(a.Button,{variant:"gradient",size:"sm",className:"capitalize",children:"Column Options"})}),e.jsxs(a.MenuList,{className:"font-semibold text-gray-600",children:[e.jsx(a.MenuItem,{onClick:()=>{n(!0)},children:"Add Column"}),e.jsx(a.MenuItem,{onClick:()=>{j(!0)},children:"Hide Columns"}),e.jsx(a.MenuItem,{onClick:()=>{b(!0)},children:"Rename Columns"})]})]}),e.jsx(be,{addColumnDialog:h,setAddColumnDialog:n}),e.jsx(pe,{hideColumnDialog:l,setHideColumnDialog:j,columns:u,additional_columns:c,hidden_columns:s}),e.jsx(ge,{renameColumnDialog:x,setRenameColumnDialog:b,columns:u,additional_columns:c})]})}function Oe({auth:u,sites:c,get_data:s,batch:h,additional_columns:n,hidden_columns:l,renamed_columns:j}){var q;const{role:x}=u,b=[{name:"Site Name",sortable:!0,key:"site_name"},{name:"Cell Name",sortable:!0,key:"cell_name"},{name:"Lon",sortable:!0,key:"lon"},{name:"Lat",sortable:!0,key:"lat"},{name:"BB Type",sortable:!0,key:"bb_type"},{name:"RRU Type",sortable:!0,key:"rru_type"},{name:"Antenna Type",sortable:!0,key:"antenna_type"},{name:"Frequency",sortable:!0,key:"frequency"},{name:"PCI",sortable:!1,key:"pci"},{name:"Azimuth",sortable:!1,key:"azimuth"},{name:"Height",sortable:!1,key:"height"},{name:"Last EPO",sortable:!1,key:"last_epo"},{name:"Next EPO",sortable:!1,key:"next_epo"},{name:"Solution Type",sortable:!1,key:"solution_type"},{name:"Start Date",sortable:!1,key:"start_date"},{name:"End Date",sortable:!1,key:"end_date"},{name:"Status",sortable:!1,key:"status"},{name:"Remarks",sortable:!1,key:"remarks"},{name:"Artifacts",sortable:!1,key:"artifacts"}],[v,S]=y.useState(b),[m,$]=y.useState(n);y.useEffect(()=>{if(j){const r=[...v];r.forEach(d=>{const C=j.find(I=>I.key===d.key);C&&(d.name=C.name)});const p=[...m];p.forEach(d=>{const C=j.find(I=>I.key===d.key);C&&(d.name=C.name)}),S(r),$(p)}},[j]);const N=y.useRef(null),[i,f]=y.useState(s!=null&&s.search?s==null?void 0:s.search:""),[z,P]=y.useState(s!=null&&s.per_page?s==null?void 0:s.per_page:10),[T]=y.useState(c),[W,A]=y.useState(!1),[V,J]=y.useState(""),[O,M]=y.useState(null),[R,H]=y.useState([]),U=r=>{N.current.click()},K=async r=>{var d,C,I;const p=new FormData;p.append("import_file",r.target.files[0]);try{const g=await D.post(route("site.field.name.import"),p);g!=null&&g.data&&(J(g==null?void 0:g.data),A(!0))}catch(g){Q.error(`${(I=(C=(d=g==null?void 0:g.response)==null?void 0:d.data)==null?void 0:C.error)==null?void 0:I.message}`)}},Y=async()=>{i&&L.get(route("site.field.name.index",{search:i}))},t=async(r,p)=>{L.get(route("site.field.name.index",{order_by:r,order:p}))},o=(r,p)=>{var d;if(r)return(d=r[p])==null?void 0:d.value},E=async(r,p)=>{L.get(route("site.field.name.index",{filter_by:r,value:p}))},G=r=>{P(r),L.get(route("site.field.name.index",{...s,per_page:r}))};y.useEffect(()=>{h!=null&&h.batch_field_id&&M(h==null?void 0:h.batch_field_id)},[]),y.useEffect(()=>{const r=async()=>{var d,C,I;try{let g=0;const F=await D.get(route("import.progress",{batchId:O}));if(F!=null&&F.data){let le=parseInt((d=F==null?void 0:F.data)==null?void 0:d.total_jobs),ae=parseInt((C=F==null?void 0:F.data)==null?void 0:C.pending_jobs),ne=le-ae;parseInt((I=F==null?void 0:F.data)==null?void 0:I.failed_jobs)>0?clearInterval(p):(g=parseInt(ne/le*100).toFixed(0),g<100?Q.loading(`CSV Data Import Progress: ${g}%.
 Please wait....`,{id:"loading-toast",style:{backgroundColor:"#424242",color:"#ffffff",fontSize:14,borderRadius:4,fontWeight:"bold"}}):(Q.dismiss("loading-toast"),clearInterval(p)))}}catch(g){console.log(g)}},p=setInterval(()=>{O&&r()},5e3);return()=>clearInterval(p)},[O]);const B=(r,p,d)=>{const C=R.findIndex(I=>I.site_id===r);H(C!==-1?I=>{const g=[...I];return g[C]={...g[C],items:{...g[C].items,[p]:d}},g}:I=>[...I,{site_id:r,items:{[p]:d}}])};return e.jsxs(ce,{user:u==null?void 0:u.user,children:[e.jsx(oe,{title:"FW Sites"}),e.jsx("div",{className:"top-section p-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"",children:[e.jsx(a.Typography,{variant:"h3",className:"tracking-tight",children:"FW Site"}),e.jsxs("ul",{className:"flex gap-1 text-gray-600 text-sm",children:[e.jsx("li",{children:e.jsx(Z,{href:route("dashboard"),children:"Dashboard"})}),e.jsx("li",{children:"/"}),e.jsx("li",{children:e.jsx(Z,{href:route("site.field.name.index"),children:"FW Site"})})]})]})})}),e.jsx("div",{className:"filter-wrapper md:px-4",children:e.jsxs("div",{className:"flex filter-details justify-end gap-1",children:[e.jsxs("div",{className:"search-wrapper w-1/3 flex relative",children:[e.jsx(X,{placeholder:"Search...",className:"w-full text-sm rounded-md rounded-r-none border-r-0 focus:ring-0 h-8",value:i,onChange:r=>f(r.target.value)}),e.jsx("div",{className:"search-icon",children:e.jsx(a.IconButton,{size:"sm",className:"rounded-l-none",onClick:Y,children:e.jsx(ie,{color:"white",size:18})})})]}),e.jsx("div",{className:"status-filter",children:e.jsxs("select",{className:"w-52 text-sm rounded-md focus:ring-0 h-8 border-gray-300 py-1 text-gray-600 font-medium",onChange:r=>E("status",r.target.value),value:(s==null?void 0:s.filter_by)==="status"?s==null?void 0:s.value:"",children:[e.jsx("option",{value:"",children:"Filter by Status"}),e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"not_started",children:"Not Started"}),e.jsx("option",{value:"completed",children:"Completed"})]})}),e.jsx("div",{className:"filter-solution-type",children:e.jsxs("select",{className:"w-52 text-sm rounded-md focus:ring-0 h-8 border-gray-300 py-1 text-gray-600 font-medium",onChange:r=>E("solution_type",r.target.value),value:(s==null?void 0:s.filter_by)==="solution_type"?s==null?void 0:s.value:"",children:[e.jsx("option",{value:"",children:"Filter by Solution Type"}),e.jsx("option",{value:"opti_type_1",children:"Opti Type-1"}),e.jsx("option",{value:"opti_type_5",children:"Opti Type-5"}),e.jsx("option",{value:"opti_type_6",children:"Opti Type-6"})]})}),x==="super-admin"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"import-type-field",children:[e.jsx(a.Button,{variant:"gradient",className:"capitalize",size:"sm",onClick:U,children:"Import from CSV"}),e.jsx("input",{type:"file",onChange:K,ref:N,style:{display:"none"}})]}),e.jsx(Ce,{columns:v,additional_columns:m,hidden_columns:l})]}),e.jsx(ue,{route_name:"site.field.name.export",file_name:"FW Sites_Export"})]})}),e.jsxs("div",{className:"content mt-6",children:[e.jsx(a.Card,{className:"h-full w-full rounded-none",children:e.jsxs("div",{className:"overflow-x-auto overflow-hidden",children:[e.jsxs("table",{className:"w-full table-auto",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[v.map(r=>e.jsx("th",{className:`border-y border-blue-gray-100 bg-blue-gray-50/50 p-2 border-l cursor-pointer ${l!=null&&l.includes(r==null?void 0:r.key)?"hidden":""}`,children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx(a.Typography,{variant:"small",className:"leading-none text-gray-800 font-medium text-sm",children:r.name}),(r==null?void 0:r.sortable)&&e.jsxs("div",{className:"relative mt-1",children:[e.jsx("span",{className:"absolute -top-2 right-0 hover:bg-blue-gray-100 rounded-sm",children:e.jsx(fe,{size:12,strokeWidth:2,onClick:()=>{t(r.key,"asc")}})}),e.jsx("span",{className:"absolute -bottom-1 right-0 hover:bg-blue-gray-100 rounded-sm",children:e.jsx(de,{size:12,strokeWidth:2,onClick:()=>{t(r.key,"desc")}})})]})]})},r.name)),(m==null?void 0:m.length)>0&&(m==null?void 0:m.map(r=>e.jsx("th",{className:`border-y border-blue-gray-100 bg-blue-gray-50/50 p-2 border-l cursor-pointer ${l!=null&&l.includes(r==null?void 0:r.key)?"hidden":""}`,children:e.jsx("div",{className:"flex justify-between",children:e.jsx(a.Typography,{variant:"small",className:"leading-none text-gray-800 font-medium text-sm",children:r.name})})},r.name))),e.jsx("th",{className:"border-y border-blue-gray-100 bg-blue-gray-50/50 p-2 border-l cursor-pointer"})]})}),e.jsx("tbody",{children:T==null?void 0:T.data.map((r,p)=>e.jsxs("tr",{className:"even:bg-blue-gray-50/50",children:[e.jsx("td",{className:`border-l h-10 text-[12px] font-medium ps-2 ${l!=null&&l.includes("site_name")?"hidden":""}`,children:e.jsx(Z,{href:"#",className:"font-semibold",children:r==null?void 0:r.site_name})}),e.jsx("td",{className:`border-l h-10 text-[12px] font-medium ps-2 ${l!=null&&l.includes("cell_name")?"hidden":""}`,children:r==null?void 0:r.cell_name}),e.jsx("td",{className:`border-l h-10 text-[12px] font-medium ps-2 ${l!=null&&l.includes("lon")?"hidden":""}`,children:r==null?void 0:r.lon}),e.jsx("td",{className:`border-l h-10 text-[12px] font-medium ps-2 ${l!=null&&l.includes("lat")?"hidden":""}`,children:r==null?void 0:r.lat}),e.jsx("td",{className:`border-l h-10 text-[12px] font-medium ps-2 ${l!=null&&l.includes("bb_type")?"hidden":""}`,children:r==null?void 0:r.bb_type}),e.jsx("td",{className:`border-l h-10 text-[12px] font-medium ps-2 ${l!=null&&l.includes("rru_type")?"hidden":""}`,children:r==null?void 0:r.rru_type}),e.jsx("td",{className:`border-l h-10 text-[12px] font-medium ps-2 ${l!=null&&l.includes("antenna_type")?"hidden":""}`,children:r==null?void 0:r.antenna_type}),e.jsx("td",{className:`border-l h-10 text-[12px] font-medium ps-2 ${l!=null&&l.includes("frequency")?"hidden":""}`,children:r==null?void 0:r.frequency}),e.jsx("td",{className:`border-l h-10 text-[12px] font-medium ps-2 ${l!=null&&l.includes("pci")?"hidden":""}`,children:r==null?void 0:r.pci}),e.jsx("td",{className:`border-l h-10 text-[12px] font-medium ps-2 ${l!=null&&l.includes("azimuth")?"hidden":""}`,children:r==null?void 0:r.azimuth}),e.jsx("td",{className:`border-l h-10 text-[12px] font-medium ps-2 ${l!=null&&l.includes("height")?"hidden":""}`,children:r==null?void 0:r.height}),e.jsx("td",{className:`border-l h-10 text-[12px] font-medium ps-2 ${l!=null&&l.includes("last_epo")?"hidden":""}`,children:r==null?void 0:r.last_epo}),e.jsx("td",{className:`border-l h-10 text-[12px] font-medium ps-2 ${l!=null&&l.includes("next_epo")?"hidden":""}`,children:r==null?void 0:r.next_epo}),e.jsx("td",{className:`border-l h-10 ${l!=null&&l.includes("solution_type")?"hidden":""}`,children:e.jsx(se,{value:o(r==null?void 0:r.tracking,"solution_type"),name:"solution_type",siteId:r==null?void 0:r.id,options:[{label:"Opti Type-1",value:"opti_type_1"},{label:"Opti Type-5",value:"opti_type_5"},{label:"Opti Type-6",value:"opti_type_6"}],handleEditAbleItem:B})}),e.jsx("td",{className:`border-l h-10 ${l!=null&&l.includes("start_date")?"hidden":""}`,children:e.jsx(ee,{value:o(r==null?void 0:r.tracking,"start_date"),name:"start_date",siteId:r==null?void 0:r.id,handleEditAbleItem:B})}),e.jsx("td",{className:`border-l h-10 ${l!=null&&l.includes("end_date")?"hidden":""}`,children:e.jsx(ee,{value:o(r==null?void 0:r.tracking,"end_date"),name:"end_date",siteId:r==null?void 0:r.id,handleEditAbleItem:B})}),e.jsx("td",{className:`border-l h-10 ${l!=null&&l.includes("status")?"hidden":""}`,children:e.jsx(se,{value:o(r==null?void 0:r.tracking,"status"),name:"status",siteId:r==null?void 0:r.id,options:[{label:"In Progress",value:"in_progress"},{label:"Not Started",value:"not_started"},{label:"Completed",value:"completed"}],handleEditAbleItem:B})}),e.jsx("td",{className:`border-l h-10 ${l!=null&&l.includes("remarks")?"hidden":""}`,children:e.jsx(te,{value:o(r==null?void 0:r.tracking,"remarks"),name:"remarks",siteId:r==null?void 0:r.id,handleEditAbleItem:B})}),e.jsx("td",{className:`border-l h-10 ${l!=null&&l.includes("artifacts")?"hidden":""}`,children:e.jsx(je,{value:o(r==null?void 0:r.tracking,"artifacts"),name:"artifacts",siteId:r==null?void 0:r.id})}),(n==null?void 0:n.length)>0&&n.map((d,C)=>e.jsx("td",{className:`border-l h-10 ${l!=null&&l.includes(d.key)?"hidden":""}`,children:e.jsx(Ne,{column:d,item:r,value:o(r==null?void 0:r.tracking,d.key),handleEditAbleItem:B})},C)),e.jsx("td",{className:"border-l h-10 px-3",children:e.jsx(ve,{site_id:r==null?void 0:r.id,changedItems:R,setChangedItems:H})})]},r==null?void 0:r.id))})]}),((q=T==null?void 0:T.data)==null?void 0:q.length)===0&&e.jsx(a.Typography,{variant:"h6",color:"blue-gray",className:"text-center py-6",children:"No data found"}),e.jsxs("div",{className:"md:flex grid justify-start md:justify-end items-center pt-6 mb-8 gap-3 px-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-sm font-medium",children:"Rows per Page"}),e.jsxs("select",{className:"rounded-md text-sm font-medium border-gray-400 focus:ring-0 py-2",value:z,onChange:r=>{G(r.target.value)},children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"15",children:"15"}),e.jsx("option",{value:"20",children:"20"}),e.jsx("option",{value:"20",children:"25"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"all",children:"All"})]})]}),e.jsx("div",{className:"text-sm font-medium",children:`${c==null?void 0:c.from}-${c==null?void 0:c.to} of ${c==null?void 0:c.total} Records`}),e.jsx(he,{links:T==null?void 0:T.links,perPage:z})]})]})}),e.jsx(ye,{mappingDialog:W,setMappingDialog:A,mappingData:V,setBatchId:M})]})]})}export{Oe as default};
