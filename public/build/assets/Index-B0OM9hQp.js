import{r as i,j as e,Y as C,a as m,d as f}from"./app-CPKu8S1y.js";import{I as g}from"./InputError-CInvTRNA.js";import{I as E}from"./InputLabel-DE6E3RCu.js";import{A as L}from"./AuthenticatedLayout-BeW3pDi6.js";import{r as n}from"./index-Cp0RQjEy.js";import"./transition-CDjHa9uH.js";import"./createLucideIcon-dEeMQcGL.js";import"./floating-ui.dom-BJX5GPEt.js";function W({auth:c}){const[d,b]=i.useState(""),[y,x]=i.useState(""),[o,u]=i.useState([]),[N,p]=i.useState(!1),[v,h]=i.useState(!1),[S,I]=i.useState(""),[j,w]=i.useState(""),k=async s=>{var l,t,r;s.preventDefault();try{p(!0);const a=await f.post(route("sql.run"),{sql_query:d});u((l=a==null?void 0:a.data)==null?void 0:l.data),x("")}catch(a){x((r=(t=a==null?void 0:a.response)==null?void 0:t.data)==null?void 0:r.error.message),u([])}finally{p(!1)}},M=async()=>{var s,l,t;if((o==null?void 0:o.length)>0)try{h(!0);const r=await f.post(route("sql.store"),{data:o});w((s=r==null?void 0:r.data)==null?void 0:s.success.message)}catch(r){I((t=(l=r==null?void 0:r.response)==null?void 0:l.data)==null?void 0:t.error.message)}finally{h(!1)}},q=({data:s})=>{if((s==null?void 0:s.length)>0){const l=Array.from(new Set(s.flatMap(t=>Object.keys(t))));return e.jsxs("div",{className:"mt-8",children:[e.jsxs("table",{className:"w-full min-w-max table-auto text-left",children:[e.jsx("thead",{children:e.jsx("tr",{children:l==null?void 0:l.map(t=>e.jsx("th",{className:"border-y border-blue-gray-100 bg-blue-gray-50/50 p-2 border-l cursor-pointer",children:e.jsx(n.Typography,{variant:"small",className:"leading-none text-gray-800 font-medium text-sm",children:t})},t))})}),e.jsx("tbody",{children:s==null?void 0:s.map((t,r)=>e.jsx("tr",{className:"even:bg-blue-gray-50/50",children:Object.keys(t).map(a=>e.jsx("td",{className:"border-l h-10 text-[12px] font-medium ps-2",children:t[a]},a))},r))})]}),e.jsxs("div",{className:"flex justify-between mt-6",children:[e.jsxs("div",{className:"",children:[e.jsx(g,{message:S,className:"mt-2 font-medium text-red-500"}),j&&e.jsxs(n.Typography,{className:"font-medium text-green-500",children:[j,e.jsx(m,{href:route("wireless.sites.index"),className:"ps-1 underline",children:"Click here to check"})]})]}),e.jsx(n.Button,{variant:"gradient",size:"sm",className:"capitalize",onClick:M,disabled:v,children:"Import Data"})]})]})}};return e.jsxs(L,{user:c==null?void 0:c.user,children:[e.jsx(C,{title:"Wireless Sites"}),e.jsx("div",{className:"top-section p-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"",children:[e.jsx(n.Typography,{variant:"h3",className:"tracking-tight",children:"SQL Import"}),e.jsxs("ul",{className:"flex gap-1 text-gray-600 text-sm",children:[e.jsx("li",{children:e.jsx(m,{href:route("dashboard"),children:"Dashboard"})}),e.jsx("li",{children:"/"}),e.jsx("li",{children:e.jsx(m,{href:route("sql.import"),children:"SQL Import"})})]})]})})}),e.jsxs("div",{className:"filter-wrapper px-4",children:[e.jsxs(n.Card,{className:"mt-6 w-full px-6 py-4",children:[e.jsx(E,{value:"SQl Code",className:"mb-2"}),e.jsx("textarea",{className:"border rounded-md border-gray-300 text-base font-medium focus:ring-0",rows:3,value:d,onChange:s=>b(s.target.value)}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:e.jsx(g,{message:y,className:"mt-2 font-medium text-red-500"})}),e.jsx(n.Button,{className:"mt-4 block capitalize",onClick:k,disabled:N,children:"Run"})]})]}),e.jsx(q,{data:o})]})]})}export{W as default};
