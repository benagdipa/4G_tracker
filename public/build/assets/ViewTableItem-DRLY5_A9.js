import{q as R,r as N,j as e,R as F,y as P,W as I,Y as A,a as E}from"./app-MJI2P0uu.js";import{c as L,_ as W,A as $,C as q}from"./AuthenticatedLayout-BW0qwIxT.js";import{r}from"./index-Dia_wP9H.js";import{T as M}from"./TextInput-K136X6ST.js";import{I as H}from"./InputLabel-CE7AgfwI.js";import{I as T}from"./InputError-B1Wsx1C6.js";import{M as U,S as J,C as Y}from"./search-7SeBB02b.js";import"./transition-MKz1PCtb.js";/**
 * @license lucide-react v0.376.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=L("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);function K({mappingDialog:d,setMappingDialog:s,columns:t,mappingData:l}){const{id:i,slug:m}=R().props.entity,f=t==null?void 0:t.reduce((u,C)=>(u[C.slug]="",u),{}),[h,b]=N.useState({...f,file_path:l?l==null?void 0:l.filePath:"",entity_id:i}),[o,x]=N.useState({}),[a,c]=N.useState(!1),[n,v]=N.useState(""),[g,k]=N.useState(""),_=()=>s(!d),p=(u,C)=>{b(S=>({...S,[u]:C}))};N.useEffect(()=>{p("file_path",l!=null&&l.filePath?l==null?void 0:l.filePath:"")},[l]);const D=async u=>{var S,w,z,B,y;u.preventDefault();let C={};if(Object.keys(h).forEach(j=>{h[j]||(C[j]="This field is required.")}),x(C),Object.keys(C).length>0){console.log(C);return}try{c(!0);const j=await axios.post(route("table.map.save"),h);j!=null&&j.data&&(k((w=(S=j==null?void 0:j.data)==null?void 0:S.success)==null?void 0:w.message),setTimeout(()=>{s(!1),k(""),v("")},3e3),P.visit(route("view.table.item",m)))}catch(j){console.log("error:",j),v(`${(y=(B=(z=j==null?void 0:j.response)==null?void 0:z.data)==null?void 0:B.error)==null?void 0:y.message}`)}finally{c(!1)}};return e.jsx(F.Fragment,{children:e.jsxs(r.Dialog,{open:d,size:"xs",children:[e.jsx(r.DialogHeader,{children:"CSV Mapping"}),e.jsx(r.DialogBody,{className:"px-6 overflow-scroll",children:(t==null?void 0:t.length)>0&&(t==null?void 0:t.map((u,C)=>{var S;return e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{value:u==null?void 0:u.name,className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:h[u==null?void 0:u.slug],onChange:w=>p(u==null?void 0:u.slug,w.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((S=l==null?void 0:l.header)==null?void 0:S.length)>0&&(l==null?void 0:l.header.map((w,z)=>e.jsx("option",{value:w,children:w},z)))]}),e.jsx(T,{message:o[u==null?void 0:u.slug],className:"!text-[12px] font-medium mt-1"})]})]})},C)}))}),e.jsxs(r.DialogFooter,{children:[e.jsx(r.Button,{variant:"text",color:"red",onClick:_,className:"mr-1 capitalize",disabled:a,children:e.jsx("span",{children:"Cancel"})}),e.jsx(r.Button,{variant:"gradient",color:"green",className:"capitalize",onClick:D,loading:a,children:e.jsx("span",{children:"Confirm"})})]})]})})}function Q({columns:d}){const s=N.useRef(null),[t,l]=N.useState(!1),[i,m]=N.useState(""),f=b=>{s.current.click()},h=async b=>{var x,a,c;const o=new FormData;o.append("import_file",b.target.files[0]);try{const n=await axios.post(route("table.import.csv"),o);n!=null&&n.data&&(m(n==null?void 0:n.data),l(!0))}catch(n){W.error(`${(c=(a=(x=n==null?void 0:n.response)==null?void 0:x.data)==null?void 0:a.error)==null?void 0:c.message}`)}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"import-type-field",children:[e.jsx(r.Button,{variant:"gradient",className:"capitalize",size:"sm",onClick:f,children:"Import from CSV"}),e.jsx("input",{type:"file",onChange:h,ref:s,style:{display:"none"}})]}),e.jsx(K,{mappingDialog:t,setMappingDialog:l,mappingData:i,columns:d})]})}function X({addColumnDialog:d,setAddColumnDialog:s}){var x;const{id:t}=(x=R().props)==null?void 0:x.entity,{data:l,setData:i,post:m,processing:f,errors:h,reset:b}=I({entity_id:t,name:"",slug:"",sortable:!1,editable:!1,input_type:"",options:""}),o=a=>{a.preventDefault(),m(route("table.add.column"),{onSuccess:()=>{s(!1),b()}})};return e.jsxs(r.Dialog,{open:d,size:"xs",children:[e.jsx(r.DialogHeader,{children:"Add New Column"}),e.jsxs(r.DialogBody,{children:[e.jsxs("div",{className:"form-item mb-4",children:[e.jsx(H,{value:"Column Name",className:"mb-1"}),e.jsx(M,{className:"w-full text-sm font-medium text-gray-600",placeholder:"Column Name...",value:l.name,onChange:a=>i("name",a.target.value)}),e.jsx(T,{message:h.name,className:"text-sm font-medium"})]}),e.jsxs("div",{className:"form-item mb-4",children:[e.jsx(H,{value:"Column Slug",className:"mb-1"}),e.jsx(M,{className:"w-full text-sm font-medium text-gray-600",placeholder:"Column slug...",value:l.slug,onChange:a=>i("slug",a.target.value)}),e.jsx(T,{message:h.slug,className:"text-sm font-medium"})]}),e.jsx("div",{className:"form-item",children:e.jsx(r.Checkbox,{label:e.jsx(r.Typography,{className:"text-sm font-medium pl-2",children:"Sortable"}),defaultChecked:l.sortable,onChange:a=>i("sortable",a.target.checked)})}),e.jsx("div",{className:"form-item",children:e.jsx(r.Checkbox,{label:e.jsx(r.Typography,{className:"text-sm font-medium pl-2",children:"Editable"}),defaultChecked:l.editable,onChange:a=>i("editable",a.target.checked)})}),(l==null?void 0:l.editable)&&e.jsxs("div",{className:"form-item mb-4",children:[e.jsx(H,{value:"Column Input Type",className:"mb-1"}),e.jsxs("select",{className:"w-full rounded text-sm border-gray-300 shadow-sm font-medium text-gray-600 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600",value:l.input_type,onChange:a=>i("input_type",a.target.value),children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"text",children:"Text"}),e.jsx("option",{value:"date",children:"Date"}),e.jsx("option",{value:"dropdown",children:"DropDown"})]}),e.jsx(T,{message:h.input_type,className:"text-sm font-medium"})]}),(l==null?void 0:l.input_type)==="dropdown"&&e.jsxs("div",{className:"form-item mb-4",children:[e.jsx(H,{value:"Dropdown Options seprated by (|)",className:"mb-1"}),e.jsx("textarea",{className:"w-full rounded text-sm border-gray-300 shadow-sm font-normal focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600",placeholder:"Dropdown Options seprated by | ...",rows:4,value:l.options,onChange:a=>i("options",a.target.value)}),e.jsx(T,{message:h.options,className:"text-sm font-medium"})]})]}),e.jsxs(r.DialogFooter,{children:[e.jsx(r.Button,{variant:"text",color:"red",onClick:()=>s(!d),className:"mr-1 capitalize",children:e.jsx("span",{children:"Cancel"})}),e.jsx(r.Button,{variant:"gradient",color:"green",onClick:a=>o(a),className:"capitalize",loading:f,children:e.jsx("span",{children:"Submit"})})]})]})}function Z({hideColumnDialog:d,setHideColumnDialog:s,columns:t}){const l=()=>s(!d),{data:i,setData:m,post:f,processing:h,errors:b,reset:o}=I({items:[],unHiddenItems:[]}),x=c=>{const{value:n,checked:v}=c.target;v?(m(g=>({...g,items:[...g.items,parseInt(n)]})),m(g=>({...g,unHiddenItems:g.unHiddenItems.filter(k=>k!==parseInt(n))}))):(m(g=>({...g,items:g.items.filter(k=>k!==parseInt(n))})),m(g=>({...g,unHiddenItems:[...g.unHiddenItems,parseInt(n)]})))},a=c=>{c.preventDefault(),f(route("table.hide.column"),{onSuccess:()=>{s(!1),o()}})};return e.jsx(e.Fragment,{children:e.jsxs(r.Dialog,{open:d,size:"xs",children:[e.jsx(r.DialogHeader,{children:"Hide Column"}),e.jsx(r.DialogBody,{children:e.jsxs("div",{className:"form-item",children:[e.jsx("p",{className:"text-[#333] font-semibold",children:"Please select the column you want to hide"}),e.jsx("div",{className:"form-item grid grid-cols-2",children:(t==null?void 0:t.length)>0&&t.map((c,n)=>e.jsx(F.Fragment,{children:e.jsx(r.Checkbox,{label:e.jsx(r.Typography,{color:"blue-gray",className:"font-medium text-sm",children:c==null?void 0:c.name}),value:c==null?void 0:c.id,onChange:v=>x(v),defaultChecked:c==null?void 0:c.hidden})},n))})]})}),e.jsxs(r.DialogFooter,{children:[e.jsx(r.Button,{variant:"text",color:"red",onClick:l,className:"mr-1 capitalize",children:e.jsx("span",{children:"Cancel"})}),e.jsx(r.Button,{variant:"gradient",color:"green",className:"capitalize",onClick:c=>{a(c)},loading:h,children:e.jsx("span",{children:"Confirm"})})]})]})})}function ee({renameColumnDialog:d,setRenameColumnDialog:s,columns:t}){var a,c;const{data:l,setData:i,post:m,processing:f,errors:h,reset:b}=I({items:t}),o=(n,v)=>{i(g=>({...g,items:g.items.map(k=>k.slug===n?{...k,name:v}:k)}))},x=n=>{n.preventDefault(),m(route("table.rename.column"),{onSuccess:()=>{s(!1),b()}})};return e.jsxs(r.Dialog,{open:d,size:"xs",children:[e.jsx(r.DialogHeader,{children:"Rename Columns"}),e.jsx(r.DialogBody,{className:"max-h-[42rem] overflow-scroll",children:e.jsx("div",{className:"grid grid-cols-2 gap-3",children:((a=l==null?void 0:l.items)==null?void 0:a.length)>0&&((c=l==null?void 0:l.items)==null?void 0:c.map((n,v)=>e.jsx("div",{className:"form-item mb-2",children:e.jsx(M,{className:"w-full text-sm font-medium text-gray-600",value:n!=null&&n.alternative_name?n==null?void 0:n.alternative_name:n==null?void 0:n.name,onChange:g=>o(n==null?void 0:n.slug,g.target.value)})},v)))})}),e.jsxs(r.DialogFooter,{children:[e.jsx(r.Button,{variant:"text",color:"red",className:"mr-1 capitalize",onClick:()=>s(!1),children:"Cancel"}),e.jsx(r.Button,{variant:"gradient",color:"green",className:"capitalize",onClick:n=>x(n),loading:f,children:"Submit"})]})]})}function se({deleteColumnDialog:d,setDeleteColumnDialog:s,columns:t}){const{data:l,setData:i,post:m,processing:f,errors:h,reset:b}=I({items:[]}),o=(a,c)=>{const n=a.target.checked;i(v=>n?{...v,items:[...v.items,c]}:{...v,items:v.items.filter(g=>g!==c)})},x=a=>{a.preventDefault(),m(route("table.delete.column"),{onSuccess:()=>{s(!1),b()}})};return e.jsxs(r.Dialog,{size:"xs",open:d,children:[e.jsx(r.DialogHeader,{children:"Delete Columns"}),e.jsx(r.DialogBody,{className:"max-h-[42rem] overflow-scroll",children:e.jsxs("div",{className:"form-item",children:[e.jsx("p",{className:"text-[#333] font-semibold",children:"Please select the column you want to delete."}),e.jsx("div",{className:"grid grid-cols-2",children:(t==null?void 0:t.length)>0&&t.map((a,c)=>e.jsx(F.Fragment,{children:e.jsx(r.Checkbox,{containerProps:{className:"py-3"},className:"w-5 h-5 rounded-md",label:e.jsx(r.Typography,{color:"blue-gray",className:"font-medium text-sm",children:a!=null&&a.alternative_name?a==null?void 0:a.alternative_name:a==null?void 0:a.name}),onChange:n=>{o(n,a==null?void 0:a.id)}})},c))})]})}),e.jsxs(r.DialogFooter,{children:[e.jsx(r.Button,{variant:"text",color:"red",onClick:()=>s(!1),children:"Cancel"}),e.jsx(r.Button,{variant:"text",color:"red",onClick:a=>x(a),children:"Delete"})]})]})}function re({arrangeColumnDialog:d,setArrangeColumnDialog:s,columns:t}){const[l,i]=N.useState([]),[m,f]=N.useState(null),{data:h,setData:b,post:o,processing:x,errors:a,reset:c}=I({items:[]});N.useEffect(()=>{d&&i(t)},[d]);const n=(p,D)=>{f(D)},v=()=>{f(null)},g=p=>{p.preventDefault()},k=(p,D)=>{if(!m)return;const u=l.indexOf(m),C=l.indexOf(D);if(u!==-1&&C!==-1){const w=[...(j=>j.map((O,V)=>({...O,position:V+1})))(l)],[z]=w.splice(u,1);w.splice(C,0,z);const B=w.map((j,O)=>({...j,position:O+1}));i(B);const y=B.map(j=>({slug:j.slug,position:j.position}));b("items",y)}},_=p=>{p.preventDefault(),o(route("table.rearrange.column"),{onSuccess:()=>{s(!1),c()}})};return e.jsxs(r.Dialog,{open:d,size:"xs",children:[e.jsx(r.DialogHeader,{children:"Re-arrange Columns"}),e.jsxs(r.DialogBody,{className:"max-h-[42rem] overflow-scroll",children:[e.jsx("p",{className:"text-[#333] font-semibold mb-3",children:"Please drag and drop the column you want to arrange."}),e.jsx("div",{className:"draggable-wrapper border rounded-md py-2",children:(l==null?void 0:l.length)>0&&(l==null?void 0:l.map((p,D)=>e.jsx("div",{className:"text-gray-600 font-medium py-1 px-2 text-sm  cursor-move",draggable:"true",onDragStart:u=>n(u,p),onDragEnd:v,onDragOver:g,onDrop:u=>k(u,p),children:e.jsxs("div",{className:"flex items-center gap-3 border py-2 px-2 rounded-md ",children:[e.jsx("div",{className:"icon-wrapper",children:e.jsx(U,{strokeWidth:1.5,size:18})}),p!=null&&p.alternative_name?p==null?void 0:p.alternative_name:p.name]})},D)))})]}),e.jsxs(r.DialogFooter,{children:[e.jsx(r.Button,{variant:"text",color:"red",className:"mr-1 capitalize",onClick:()=>s(!1),children:"cancel"}),e.jsx(r.Button,{variant:"gradient",color:"green",className:"capitalize",onClick:p=>_(p),loading:x,children:"Submit"})]})]})}function le({columns:d}){const[s,t]=N.useState(!1),[l,i]=N.useState(!1),[m,f]=N.useState(!1),[h,b]=N.useState(!1),[o,x]=N.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(r.Menu,{children:[e.jsx(r.MenuHandler,{children:e.jsx(r.Button,{variant:"gradient",size:"sm",className:"capitalize",children:"Column Options"})}),e.jsxs(r.MenuList,{className:"font-semibold text-gray-600",children:[e.jsx(r.MenuItem,{onClick:()=>{t(!0)},children:"Add Column"}),e.jsx(r.MenuItem,{onClick:()=>{i(!0)},children:"Show/Hide Columns"}),e.jsx(r.MenuItem,{onClick:()=>{f(!0)},children:"Rename Columns"}),e.jsx(r.MenuItem,{onClick:()=>{x(!0)},children:"Rearrange Columns"}),e.jsx(r.MenuItem,{className:"text-red-500",onClick:()=>{b(!0)},children:"Delete Columns"})]})]}),e.jsx(X,{addColumnDialog:s,setAddColumnDialog:t}),e.jsx(Z,{columns:d,hideColumnDialog:l,setHideColumnDialog:i}),e.jsx(ee,{renameColumnDialog:m,setRenameColumnDialog:f,columns:d}),e.jsx(se,{deleteColumnDialog:h,setDeleteColumnDialog:b,columns:d}),e.jsx(re,{arrangeColumnDialog:o,setArrangeColumnDialog:x,columns:d})]})}function ae({entity_id:d}){const{post:s,processing:t,reset:l}=I({entity_id:d}),i=()=>{d&&s(route("table.restore.column"),{preserveScroll:!0,onSuccess:()=>{l()}})};return e.jsx("div",{className:"restore-table",children:e.jsx(r.Button,{variant:"gradient",size:"sm",className:"capitalize",loading:t,onClick:i,children:"Restore Table"})})}function ne({deleteTableDialog:d,setDeleteTableDialog:s,tableId:t}){const{processing:l,delete:i}=I(),m=()=>{t&&i(route("table.delete",t),{preserveScroll:!0,onSuccess:()=>{P.visit(route("dashboard"))}})};return e.jsx(e.Fragment,{children:e.jsxs(r.Dialog,{open:d,size:"xs",className:"rounded py-5",children:[e.jsxs(r.DialogBody,{children:[e.jsx(r.Typography,{variant:"h4",className:"text-center",color:"black",children:"Are you sure?"}),e.jsx("p",{className:"font-medium text-center",children:"This step is permanent and cannot be undone."})]}),e.jsxs(r.DialogFooter,{className:"justify-center",children:[e.jsx(r.Button,{variant:"gradient",className:"mr-1",onClick:()=>{s(!1)},disabled:l,children:e.jsx("span",{children:"Cancel"})}),e.jsx(r.Button,{variant:"gradient",color:"red",onClick:m,loading:l,children:e.jsx("span",{children:"Confirm"})})]})]})})}function he({auth:d,entity:s}){var f,h,b;const{role:t}=d;function l(o,x){for(let a=0;a<o.length;a++)if(x in o[a])return o[a][x];return""}const[i,m]=N.useState(!1);return e.jsxs($,{user:d==null?void 0:d.user,children:[e.jsx(A,{title:s==null?void 0:s.title}),e.jsx("div",{className:"top-section p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"",children:[e.jsx(r.Typography,{variant:"h3",className:"tracking-tight",children:s==null?void 0:s.title}),e.jsxs("ul",{className:"flex gap-1 text-gray-600 text-sm",children:[e.jsx("li",{children:e.jsx(E,{href:route("dashboard"),children:"Dashboard"})}),e.jsx("li",{children:"/"}),e.jsx("li",{children:e.jsx(E,{href:route("view.table.item",s==null?void 0:s.slug),children:s==null?void 0:s.title})})]})]}),e.jsxs("div",{children:[e.jsxs(r.Menu,{children:[e.jsx(r.MenuHandler,{children:e.jsx(r.Button,{variant:"text",size:"sm",children:e.jsx(G,{size:18,color:"gray"})})}),e.jsx(r.MenuList,{className:"font-semibold text-gray-600 max-w-32",children:e.jsx(r.MenuItem,{onClick:()=>{m(!0)},className:"text-red-500 hover:!text-red-500",children:"Delete"})})]}),e.jsx(ne,{deleteTableDialog:i,setDeleteTableDialog:m,tableId:s==null?void 0:s.id})]})]})}),(s==null?void 0:s.attributes.length)===0&&e.jsxs("div",{className:"text-center border rounded py-6",children:[e.jsx(r.Typography,{variant:"h4",color:"blue-gray",className:"mb-3",children:"It seems you haven't created any columns yet."}),e.jsx(E,{href:route("table.wizard.column.index",s==null?void 0:s.id),children:e.jsx(r.Button,{variant:"gradient",size:"sm",className:"capitalize",children:"Create Column"})})]}),(s==null?void 0:s.attributes.length)>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"filter-wrapper md:px-4",children:e.jsxs("div",{className:"flex filter-details justify-end gap-2",children:[e.jsxs("div",{className:"search-wrapper w-1/6 flex relative",children:[e.jsx(M,{placeholder:"Search...",className:"w-full text-sm rounded-md rounded-r-none border-r-0 focus:ring-0 h-8"}),e.jsx("div",{className:"search-icon",children:e.jsx(r.IconButton,{size:"sm",className:"rounded-l-none",children:e.jsx(J,{color:"white",size:18})})})]}),t==="super-admin"&&e.jsxs(F.Fragment,{children:[e.jsx(Q,{columns:s==null?void 0:s.attributes}),e.jsx(le,{columns:s==null?void 0:s.attributes}),e.jsx(ae,{entity_id:s==null?void 0:s.id})]})]})}),e.jsx("div",{className:"content mt-6",children:e.jsx(r.Card,{className:"h-full w-full rounded-none",children:e.jsx("div",{className:"overflow-x-auto overflow-hidden",children:e.jsxs("table",{className:"w-full table-auto",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[(f=s==null?void 0:s.attributes)==null?void 0:f.map((o,x)=>e.jsx("th",{className:`border-y border-blue-gray-100 bg-blue-gray-50/50 p-2 border-l cursor-pointer ${o!=null&&o.hidden?"hidden":""}`,children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx(r.Typography,{variant:"small",className:"leading-none text-gray-800 font-medium text-sm",children:o!=null&&o.alternative_name?o==null?void 0:o.alternative_name:o.name}),(o==null?void 0:o.sortable)&&e.jsxs("div",{className:"relative mt-1",children:[e.jsx("span",{className:"absolute -top-2 right-0 hover:bg-blue-gray-100 rounded-sm",children:e.jsx(Y,{size:12,strokeWidth:2,onClick:()=>{sortData(o.slug,"asc")}})}),e.jsx("span",{className:"absolute -bottom-1 right-0 hover:bg-blue-gray-100 rounded-sm",children:e.jsx(q,{size:12,strokeWidth:2,onClick:()=>{sortData(o.slug,"desc")}})})]})]})},x)),e.jsx("th",{className:"border-y border-blue-gray-100 bg-blue-gray-50/50 p-2 border-l cursor-pointer"})]})}),e.jsx("tbody",{children:((h=s==null?void 0:s.values)==null?void 0:h.length)>0&&((b=s==null?void 0:s.values)==null?void 0:b.map((o,x)=>{var c;const a=JSON.parse(o==null?void 0:o.values);return e.jsxs("tr",{className:"even:bg-blue-gray-50/50",children:[(c=s==null?void 0:s.attributes)==null?void 0:c.map((n,v)=>e.jsx("td",{className:`border-l h-10 text-[12px] font-medium ps-2 ${n!=null&&n.hidden?"hidden":""}`,children:l(a,n.slug)},v)),e.jsx("td",{className:"border-l h-10 text-[12px] font-medium ps-2"})]},x)}))})]})})})})]})]})}export{he as default};
