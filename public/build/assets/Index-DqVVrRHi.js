import{W as Y,j as e,r as x,R as X,b as re,y as q,u as Z,c as le,i as te,k as D,l as ce,Y as ie,a as ee}from"./app-hAMxQ-Mf.js";import{r}from"./index-Dh3BsRSv.js";import{_ as G,A as ue}from"./AuthenticatedLayout-CE8-LQZf.js";import{T as se}from"./TextInput-Bd5Fx4_T.js";import{I as z}from"./InputLabel-BaHAriAx.js";import{I as B}from"./InputError-0oix6y5E.js";import{M as fe,T as ae,P as xe}from"./Pagination-BCejUtAE.js";import{A as oe,E as he}from"./ag-theme-quartz-CpHMyD7J.js";import{U as me}from"./UploadItem-Cd01xrtP.js";import"./transition-BcTd7teN.js";import"./ApplicationLogo-YPo9sQhw.js";import"./index-DgG258sn.js";function je({addColumnDialog:o,setAddColumnDialog:a}){const{data:s,setData:u,post:d,processing:h,errors:m,reset:f}=Y({type:"wntd",name:"",key:"",input_type:"",options:""}),F=g=>{g.preventDefault(),d(route("additional.columns.save.item"),{onSuccess:()=>{a(!1),f()}})};return e.jsxs(r.Dialog,{open:o,size:"xs",children:[e.jsx(r.DialogHeader,{children:"Add New Column"}),e.jsxs(r.DialogBody,{children:[e.jsxs("div",{className:"form-item mb-4",children:[e.jsx(z,{value:"Column Name",className:"mb-1"}),e.jsx(se,{className:"w-full text-sm font-medium text-gray-600",placeholder:"Column Name...",value:s.name,onChange:g=>u("name",g.target.value)}),e.jsx(B,{message:m.name,className:"text-sm font-medium"})]}),e.jsxs("div",{className:"form-item mb-4",children:[e.jsx(z,{value:"Column Key",className:"mb-1"}),e.jsx(se,{className:"w-full text-sm font-medium text-gray-600",placeholder:"Column key...",value:s.key,onChange:g=>u("key",g.target.value)}),e.jsx(B,{message:m.key,className:"text-sm font-medium"})]}),e.jsxs("div",{className:"form-item mb-4",children:[e.jsx(z,{value:"Column Input Type",className:"mb-1"}),e.jsxs("select",{className:"w-full rounded text-sm border-gray-300 shadow-sm font-medium text-gray-600 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600",value:s.input_type,onChange:g=>u("input_type",g.target.value),children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"text",children:"Text"}),e.jsx("option",{value:"date",children:"Date"}),e.jsx("option",{value:"dropdown",children:"DropDown"})]}),e.jsx(B,{message:m.input_type,className:"text-sm font-medium"})]}),(s==null?void 0:s.input_type)==="dropdown"&&e.jsxs("div",{className:"form-item mb-4",children:[e.jsx(z,{value:"Dropdown Options seprated by (|)",className:"mb-1"}),e.jsx("textarea",{className:"w-full rounded text-sm border-gray-300 shadow-sm font-normal focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600",placeholder:"Dropdown Options seprated by | ...",rows:4,value:s.options,onChange:g=>u("options",g.target.value)}),e.jsx(B,{message:m.options,className:"text-sm font-medium"})]})]}),e.jsxs(r.DialogFooter,{children:[e.jsx(r.Button,{variant:"text",color:"red",onClick:()=>a(!o),className:"mr-1 capitalize",children:e.jsx("span",{children:"Cancel"})}),e.jsx(r.Button,{variant:"gradient",color:"green",onClick:g=>F(g),className:"capitalize",loading:h,children:e.jsx("span",{children:"Submit"})})]})]})}function Ne({hideColumnDialog:o,setHideColumnDialog:a,columns:s,hidden_columns:u,deleted_columns:d}){const h=()=>a(!o),[m,f]=x.useState([]),{data:F,setData:g,post:j,processing:_,errors:p,reset:b}=Y({type:"wntd",key:"hide",items:(u==null?void 0:u.length)>0?u:[]});x.useEffect(()=>{o&&f(v=>[...s.filter(I=>!d.includes(I.key)).map(I=>({key:I.key,name:I.name}))])},[o]);const w=(v,E)=>{const I=v.target.checked;g(k=>I?{...k,items:[...k.items,E]}:{...k,items:k.items.filter(H=>H!==E)})},N=v=>{v.preventDefault(),j(route("hide.columns.item"),{onSuccess:()=>{a(!1),b()}})};return e.jsxs(r.Dialog,{open:o,size:"xs",children:[e.jsx(r.DialogHeader,{children:"Hide Column"}),e.jsx(r.DialogBody,{children:e.jsxs("div",{className:"form-item",children:[e.jsx("p",{className:"text-[#333] font-semibold",children:"Please select the column you want to hide"}),e.jsx("div",{className:"form-item grid grid-cols-2",children:(m==null?void 0:m.length)>0&&m.map((v,E)=>e.jsx(X.Fragment,{children:e.jsx(r.Checkbox,{containerProps:{className:"py-3"},className:"w-5 h-5 rounded-md",label:e.jsx(r.Typography,{color:"blue-gray",className:"font-medium text-sm",children:v==null?void 0:v.name}),onChange:I=>w(I,v==null?void 0:v.key),defaultChecked:u==null?void 0:u.includes(v==null?void 0:v.key)})},E))})]})}),e.jsxs(r.DialogFooter,{children:[e.jsx(r.Button,{variant:"text",color:"red",onClick:h,className:"mr-1 capitalize",children:e.jsx("span",{children:"Cancel"})}),e.jsx(r.Button,{variant:"gradient",color:"green",onClick:v=>{N(v)},className:"capitalize",loading:_,children:e.jsx("span",{children:"Confirm"})})]})]})}function ve({renameColumnDialog:o,setRenameColumnDialog:a,columns:s,deleted_columns:u}){var p;const{data:d,setData:h,post:m,processing:f,errors:F,reset:g}=Y({type:"wntd",key:"rename",items:[]});x.useEffect(()=>{o&&h(b=>{const w=[...s.filter(N=>!u.includes(N.key)).map(N=>({key:N.key,name:N.name}))];return{...b,items:w}})},[o]);const j=(b,w)=>{h(N=>({...N,items:N.items.map(v=>v.key===b?{...v,name:w}:v)}))},_=b=>{b.preventDefault(),m(route("rename.columns.item"),{onSuccess:()=>{a(!1),g()}})};return e.jsxs(r.Dialog,{open:o,size:"xs",children:[e.jsx(r.DialogHeader,{children:"Rename Columns"}),e.jsx(r.DialogBody,{className:"max-h-[42rem] overflow-scroll",children:e.jsx("div",{className:"grid grid-cols-2 gap-3",children:(d==null?void 0:d.items.length)>0&&((p=d==null?void 0:d.items)==null?void 0:p.map((b,w)=>e.jsx("div",{className:"form-item mb-2",children:e.jsx(se,{className:"w-full text-sm font-medium text-gray-600",value:b==null?void 0:b.name,onChange:N=>j(b==null?void 0:b.key,N.target.value)})},w)))})}),e.jsxs(r.DialogFooter,{children:[e.jsx(r.Button,{variant:"text",color:"red",className:"mr-1 capitalize",onClick:()=>a(!1),children:"Cancel"}),e.jsx(r.Button,{variant:"gradient",color:"green",className:"capitalize",onClick:b=>_(b),loading:f,children:"Submit"})]})]})}function ye({deleteColumnDialog:o,setDeleteColumnDialog:a,columns:s,deleted_columns:u}){const{data:d,setData:h,post:m,processing:f,errors:F,reset:g}=Y({type:"wntd",key:"delete",items:[]}),[j,_]=x.useState([]);x.useEffect(()=>{o&&_(w=>[...s.filter(v=>!u.includes(v.key)).map(v=>({key:v.key,name:v.name}))])},[o]);const p=(w,N)=>{const v=w.target.checked;h(E=>v?{...E,items:[...E.items,N]}:{...E,items:E.items.filter(I=>I!==N)})},b=w=>{w.preventDefault(),m(route("delete.columns.item"),{onSuccess:()=>{a(!1),g()}})};return e.jsxs(r.Dialog,{open:o,size:"xs",children:[e.jsx(r.DialogHeader,{children:"Delete Columns"}),e.jsx(r.DialogBody,{className:"max-h-[42rem] overflow-scroll",children:e.jsxs("div",{className:"form-item",children:[e.jsx("p",{className:"text-[#333] font-semibold",children:"Please select the column you want to delete."}),e.jsx("div",{className:"grid grid-cols-2",children:(j==null?void 0:j.length)>0&&j.map((w,N)=>e.jsx(X.Fragment,{children:e.jsx(r.Checkbox,{containerProps:{className:"py-3"},className:"w-5 h-5 rounded-md",label:e.jsx(r.Typography,{color:"blue-gray",className:"font-medium text-sm",children:w==null?void 0:w.name}),onChange:v=>{p(v,w==null?void 0:w.key)}})},N))})]})}),e.jsxs(r.DialogFooter,{children:[e.jsx(r.Button,{variant:"text",color:"red",className:"mr-1 capitalize",onClick:()=>a(!1),children:"Cancel"}),e.jsx(r.Button,{variant:"gradient",color:"green",className:"capitalize",onClick:w=>{b(w)},loading:f,children:"Submit"})]})]})}function ge({arrangeColumnDialog:o,setArrangeColumnDialog:a,columns:s,deleted_columns:u}){const[d,h]=x.useState([]),[m,f]=x.useState(null),{data:F,setData:g,post:j,processing:_,errors:p,reset:b}=Y({type:"wntd",key:"arrange",items:[]});x.useEffect(()=>{o&&h(k=>[...(R=>R.map(($,A)=>({...$,position:A+1})))(s.filter(R=>!u.includes(R.key)).map(R=>({key:R.key,name:R.name})))])},[o]);const w=(k,H)=>{f(H)},N=()=>{f(null)},v=k=>{k.preventDefault()},E=(k,H)=>{if(!m)return;const C=d.indexOf(m),R=d.indexOf(H);if(C!==-1&&R!==-1){const A=[...(O=>O.map((l,y)=>({...l,position:y+1})))(d)],[W]=A.splice(C,1);A.splice(R,0,W);const L=A.map((O,l)=>({...O,position:l+1}));h(L);const M=L.map(O=>({key:O.key,position:O.position}));g("items",M)}},I=k=>{k.preventDefault(),j(route("rearrange.columns.item"),{onSuccess:()=>{a(!1),b()}})};return e.jsxs(r.Dialog,{open:o,size:"xs",children:[e.jsx(r.DialogHeader,{children:"Re-arrange Columns"}),e.jsxs(r.DialogBody,{className:"max-h-[42rem] overflow-scroll",children:[e.jsx("p",{className:"text-[#333] font-semibold mb-3",children:"Please drag and drop the column you want to arrange."}),e.jsx("div",{className:"draggable-wrapper border rounded-md py-2",children:(d==null?void 0:d.length)>0&&(d==null?void 0:d.map((k,H)=>e.jsx("div",{className:"text-gray-600 font-medium py-1 px-2 text-sm  cursor-move",draggable:"true",onDragStart:C=>w(C,k),onDragEnd:N,onDragOver:v,onDrop:C=>E(C,k),children:e.jsxs("div",{className:"flex items-center gap-3 border py-2 px-2 rounded-md ",children:[e.jsx("div",{className:"icon-wrapper",children:e.jsx(fe,{strokeWidth:1.5,size:18})}),k.name]})},H)))})]}),e.jsxs(r.DialogFooter,{children:[e.jsx(r.Button,{variant:"text",color:"red",className:"mr-1 capitalize",onClick:()=>a(!1),children:"cancel"}),e.jsx(r.Button,{variant:"gradient",color:"green",className:"capitalize",onClick:k=>I(k),loading:_,children:"Submit"})]})]})}function we({columns:o,hidden_columns:a,deleted_columns:s}){const[u,d]=x.useState(!1),[h,m]=x.useState(!1),[f,F]=x.useState(!1),[g,j]=x.useState(!1),[_,p]=x.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(r.Button,{variant:"gradient",size:"sm",className:"capitalize rounded text-sm",onClick:()=>{d(!0)},children:"Add New Column"}),e.jsx(je,{addColumnDialog:u,setAddColumnDialog:d}),e.jsx(Ne,{hideColumnDialog:h,setHideColumnDialog:m,columns:o,hidden_columns:a,deleted_columns:s}),e.jsx(ve,{renameColumnDialog:f,setRenameColumnDialog:F,columns:o,deleted_columns:s}),e.jsx(ye,{deleteColumnDialog:g,setDeleteColumnDialog:j,columns:o,deleted_columns:s}),e.jsx(ge,{arrangeColumnDialog:_,setArrangeColumnDialog:p,columns:o,deleted_columns:s})]})}function be({mappingDialog:o,setMappingDialog:a,mappingData:s,setBatchId:u}){var E,I,k,H,C,R,$,A,W,L,M,O;const d=()=>a(!o),[h,m]=x.useState({file_path:s?s==null?void 0:s.filePath:"",loc_id:"",wntd:"",imsi:"",version:"",avc:"",bw_profile:"",lon:"",lat:"",site_name:"",home_cell:"",home_pci:"",traffic_profile:""}),[f,F]=x.useState({}),[g,j]=x.useState(!1),[_,p]=x.useState(""),[b,w]=x.useState(""),N=(l,y)=>{m(V=>({...V,[l]:y}))};x.useEffect(()=>{N("file_path",s!=null&&s.filePath?s==null?void 0:s.filePath:"")},[s]);const v=async l=>{var V,K,Q,U,t,c;l.preventDefault();let y={};if(["loc_id","wntd","imsi","version","avc","bw_profile","lon","lat","site_name","home_cell","home_pci","traffic_profile"].forEach(i=>{h[i]||(y[i]="This field is required.")}),F(y),Object.keys(y).length>0){console.log(y);return}try{j(!0);const i=await re.post(route("wireless.sites.map.save"),h);i!=null&&i.data&&(w((K=(V=i==null?void 0:i.data)==null?void 0:V.success)==null?void 0:K.message),u((Q=i==null?void 0:i.data)==null?void 0:Q.batch_id),setTimeout(()=>{a(!1),w(""),p("")},3e3),q.visit(route("wireless.sites.index")))}catch(i){console.log("error:",i),p(`${(c=(t=(U=i==null?void 0:i.response)==null?void 0:U.data)==null?void 0:t.error)==null?void 0:c.message}`)}finally{j(!1)}};return e.jsx(X.Fragment,{children:e.jsxs(r.Dialog,{open:o,size:"xs",children:[e.jsx(r.DialogHeader,{children:"CSV Mapping"}),_&&e.jsx("p",{className:"text-red-500 font-medium text-[12px] px-4",children:_}),b&&e.jsx("p",{className:"text-green-500 font-medium text-[12px] px-4",children:b}),e.jsxs(r.DialogBody,{className:"px-6 overflow-scroll",children:[e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{value:"LOCID",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:h.loc_id,onChange:l=>N("loc_id",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((E=s==null?void 0:s.header)==null?void 0:E.length)>0&&(s==null?void 0:s.header.map((l,y)=>e.jsx("option",{value:l,children:l},y)))]}),e.jsx(B,{message:f.loc_id,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{value:"WNTD",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:h.wntd,onChange:l=>N("wntd",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((I=s==null?void 0:s.header)==null?void 0:I.length)>0&&(s==null?void 0:s.header.map((l,y)=>e.jsx("option",{value:l,children:l},y)))]}),e.jsx(B,{message:f.wntd,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{value:"IMSI",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:h.imsi,onChange:l=>N("imsi",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((k=s==null?void 0:s.header)==null?void 0:k.length)>0&&(s==null?void 0:s.header.map((l,y)=>e.jsx("option",{value:l,children:l},y)))]}),e.jsx(B,{message:f.imsi,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{value:"VERSION",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:h.version,onChange:l=>N("version",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((H=s==null?void 0:s.header)==null?void 0:H.length)>0&&(s==null?void 0:s.header.map((l,y)=>e.jsx("option",{value:l,children:l},y)))]}),e.jsx(B,{message:f.version,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{value:"AVC",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:h.avc,onChange:l=>N("avc",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((C=s==null?void 0:s.header)==null?void 0:C.length)>0&&(s==null?void 0:s.header.map((l,y)=>e.jsx("option",{value:l,children:l},y)))]}),e.jsx(B,{message:f.avc,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{value:"BW Profile",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:h.bw_profile,onChange:l=>N("bw_profile",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((R=s==null?void 0:s.header)==null?void 0:R.length)>0&&(s==null?void 0:s.header.map((l,y)=>e.jsx("option",{value:l,children:l},y)))]}),e.jsx(B,{message:f.bw_profile,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{value:"Lon",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:h.lon,onChange:l=>N("lon",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),(($=s==null?void 0:s.header)==null?void 0:$.length)>0&&(s==null?void 0:s.header.map((l,y)=>e.jsx("option",{value:l,children:l},y)))]}),e.jsx(B,{message:f.lon,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{value:"Lat",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:h.lat,onChange:l=>N("lat",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((A=s==null?void 0:s.header)==null?void 0:A.length)>0&&(s==null?void 0:s.header.map((l,y)=>e.jsx("option",{value:l,children:l},y)))]}),e.jsx(B,{message:f.lat,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{value:"SiteName",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:h.site_name,onChange:l=>N("site_name",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((W=s==null?void 0:s.header)==null?void 0:W.length)>0&&(s==null?void 0:s.header.map((l,y)=>e.jsx("option",{value:l,children:l},y)))]}),e.jsx(B,{message:f.site_name,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{value:"HomeCell",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:h.home_cell,onChange:l=>N("home_cell",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((L=s==null?void 0:s.header)==null?void 0:L.length)>0&&(s==null?void 0:s.header.map((l,y)=>e.jsx("option",{value:l,children:l},y)))]}),e.jsx(B,{message:f.home_cell,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{value:"HomePCI",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:h.home_pci,onChange:l=>N("home_pci",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((M=s==null?void 0:s.header)==null?void 0:M.length)>0&&(s==null?void 0:s.header.map((l,y)=>e.jsx("option",{value:l,children:l},y)))]}),e.jsx(B,{message:f.home_pci,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{value:"Traffic_Profile",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:h.traffic_profile,onChange:l=>N("traffic_profile",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((O=s==null?void 0:s.header)==null?void 0:O.length)>0&&(s==null?void 0:s.header.map((l,y)=>e.jsx("option",{value:l,children:l},y)))]}),e.jsx(B,{message:f.traffic_profile,className:"!text-[12px] font-medium"})]})]})})]}),e.jsxs(r.DialogFooter,{children:[e.jsx(r.Button,{variant:"text",color:"red",onClick:d,className:"mr-1",disabled:g,children:e.jsx("span",{children:"Cancel"})}),e.jsx(r.Button,{variant:"gradient",color:"green",onClick:v,loading:g,children:e.jsx("span",{children:"Confirm"})})]})]})})}function Ce(o){const{changedData:a}=Z(u=>u.table),s=async()=>{var u,d,h;if(a.length>0){let m=a.filter(f=>f.site_id===o.data.id)[0];if(m){const f=await axios.post(route("wireless.sites.save.item"),{site_id:m==null?void 0:m.site_id,location_id:m==null?void 0:m.loc_id,items:m==null?void 0:m.items});(u=f==null?void 0:f.data)!=null&&u.success&&G.success((h=(d=f==null?void 0:f.data)==null?void 0:d.success)==null?void 0:h.message)}}};return e.jsx(r.Button,{size:"sm",className:"capitalize py-1 px-2 rounded font-semibold",onClick:()=>{s()},children:"Save"})}function pe(o){const{processing:a,delete:s}=Y(),[u,d]=x.useState(!1),h={onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1)},m=()=>{s(route("wireless.sites.destroy",o.data.id),{preserveScroll:!0,onSuccess:()=>{q.visit(route("wireless.sites.index"))}})};return e.jsx(X.Fragment,{children:e.jsxs(r.Popover,{placement:"top-end",open:u,handler:d,children:[e.jsx(r.PopoverHandler,{...h,children:e.jsx(r.Button,{variant:"gradient",color:"red",size:"sm",className:"capitalize py-1 px-2 rounded",onClick:()=>setOpen(!0),children:e.jsx(ae,{size:14})})}),e.jsxs(r.PopoverContent,{...h,className:"px-3",children:[e.jsx(r.Typography,{variant:"h6",className:"text-center",children:"Are you sure?"}),e.jsx(r.Typography,{variant:"small",className:"font-normal",children:"This cannot be reverted back."}),e.jsxs("div",{className:"mt-2 flex justify-between",children:[e.jsx(r.Button,{variant:"text",color:"red",size:"sm",className:"capitalize rounded",onClick:()=>d(!1),children:"Cancel"}),e.jsx(r.Button,{variant:"gradient",color:"red",size:"sm",className:"capitalize rounded",onClick:m,children:"Delete"})]})]})]})})}const Se=()=>{const o=le(),{addNewRowData:a}=Z(d=>d.table),s=d=>{if(d.preventDefault(),!a.loc_id)return G.error("LocId is required");q.post(route("wireless.sites.add.row"),{newItem:a},{onSuccess:()=>{o(D(!1)),G.success("Row Added successfully")}})},u=()=>{o(D(!1)),te({})};return e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsx(r.Button,{variant:"gradient",size:"sm",className:"capitalize py-1 px-2 rounded font-semibold",onClick:s,children:"Save"}),e.jsx(r.Button,{variant:"gradient",color:"red",size:"sm",className:"capitalize py-1 px-2 rounded",onClick:u,children:e.jsx(ae,{size:14})})]})};function _e({setAddNewRow:o}){const a=le(),{addNewRowData:s}=Z(j=>j.table),u=["device_upgrade","reparent","repan","opti_type_1","opti_type_5","opti_type_6","epo"],d=["in_progress","not_started","completed"],h=x.useMemo(()=>({editable:!0})),[m]=x.useState([{headerName:"LOCID",field:"loc_id"},{headerName:"WNTD",field:"wntd"},{headerName:"IMSI",field:"imsi"},{headerName:"VERSION",field:"version"},{headerName:"AVC",field:"avc"},{headerName:"BW Profile",field:"bw_profile"},{headerName:"Lon",field:"lon"},{headerName:"Lat",field:"lat"},{headerName:"SiteName",field:"site_name"},{headerName:"HomeCell",field:"home_cell"},{headerName:"HomePCI",field:"home_pci"},{headerName:"Traffic Profile",field:"traffic_profile"},{headerName:"Start Date",field:"start_date",input_type:"date",valueFormatter:j=>{if(!j.value)return"";const _=j.value.getMonth()+1,p=j.value.getDate();return`${j.value.getFullYear()}-${_<10?"0"+_:_}-${p<10?"0"+p:p}`},cellEditor:"agDateCellEditor"},{headerName:"End Date",field:"end_date",valueFormatter:j=>{if(!j.value)return"";const _=j.value.getMonth()+1,p=j.value.getDate();return`${j.value.getFullYear()}-${_<10?"0"+_:_}-${p<10?"0"+p:p}`},cellEditor:"agDateCellEditor"},{headerName:"Solution Type",field:"solution_type",cellEditor:"agSelectCellEditor",filterParams:{caseSensitive:!0,defaultOption:"startsWith"},cellEditorParams:{values:u}},{headerName:"Status",field:"status",cellEditor:"agSelectCellEditor",filterParams:{caseSensitive:!0,defaultOption:"startsWith"},cellEditorParams:{values:d}},{headerName:"Remarks",field:"remarks"},{headerName:"Artifacts",field:"artifacts",editable:!1},{headerName:"",field:"",editable:!1,cellRenderer:Se}]),[f,F]=x.useState([{loc_id:"",wntd:"",imsi:"",version:"",avc:"",bw_profile:"",lon:"",lat:"",site_name:"",home_cell:"",home_pci:"",traffic_profile:"",deleted_at:null,remarks:"",artifacts:"",solution_type:"",start_date:new Date,status:"",end_date:new Date}]),g=j=>{var p;const _={...s};a(te({..._,[(p=j==null?void 0:j.colDef)==null?void 0:p.field]:j==null?void 0:j.value}))};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"overflow-x-auto overflow-hidden",children:e.jsx("div",{className:"ag-theme-quartz",style:{height:100},children:e.jsx(oe,{rowData:f,columnDefs:m,defaultColDef:h,onCellValueChanged:g})})})})}const ke=o=>{var a,s;return e.jsx(ee,{href:route("wireless.show.location.index",(a=o==null?void 0:o.data)==null?void 0:a.id),className:"font-semibold underline",children:(s=o==null?void 0:o.data)==null?void 0:s.loc_id})},Ee=o=>e.jsxs("div",{className:"flex gap-5 my-2",children:[e.jsx(Ce,{...o}),e.jsx(pe,{...o})]});function Le({auth:o,sites:a,get_data:s,batch:u,additional_columns:d,hidden_columns:h,renamed_columns:m,deleted_columns:f,arrange_columns:F}){var U;const g=x.useRef(),p=[{headerName:"LOCID",field:"loc_id",editable:!1,cellRenderer:ke},{headerName:"WNTD",field:"wntd"},{headerName:"IMSI",field:"imsi"},{headerName:"VERSION",field:"version"},{headerName:"AVC",field:"avc"},{headerName:"BW Profile",field:"bw_profile"},{headerName:"Lon",field:"lon"},{headerName:"Lat",field:"lat"},{headerName:"SiteName",field:"site_name"},{headerName:"HomeCell",field:"home_cell"},{headerName:"HomePCI",field:"home_pci"},{headerName:"Traffic Profile",field:"traffic_profile"},{headerName:"Start Date",field:"start_date",input_type:"date",valueFormatter:t=>{if(!t.value)return"";const c=t.value.getMonth()+1,i=t.value.getDate();return`${t.value.getFullYear()}-${c<10?"0"+c:c}-${i<10?"0"+i:i}`},cellEditor:"agDateCellEditor",filter:!1},{headerName:"End Date",field:"end_date",valueFormatter:t=>{if(!t.value)return"";const c=t.value.getMonth()+1,i=t.value.getDate();return`${t.value.getFullYear()}-${c<10?"0"+c:c}-${i<10?"0"+i:i}`},cellEditor:"agDateCellEditor",filter:!1},{headerName:"Solution Type",field:"solution_type",cellEditor:"agSelectCellEditor",filterParams:{caseSensitive:!0,defaultOption:"startsWith"},cellEditorParams:{values:["device_upgrade","reparent","repan","opti_type_1","opti_type_5","opti_type_6","epo"]}},{headerName:"Status",field:"status",cellEditor:"agSelectCellEditor",filterParams:{caseSensitive:!0,defaultOption:"startsWith"},cellEditorParams:{values:["in_progress","not_started","completed"]}},{headerName:"Remarks",field:"remarks"},{headerName:"Artifacts",field:"artifacts",cellRenderer:me,editable:!1}],b=le(),w=x.useMemo(()=>({editable:!0,filter:!0})),{addNewRow:N}=Z(t=>t.table),{role:v}=o;x.useEffect(()=>{var t;((t=a==null?void 0:a.data)==null?void 0:t.length)>0&&(a==null||a.data.map(c=>{if(c.end_date||c.start_date){let i=c!=null&&c.end_date?new Date(c==null?void 0:c.end_date):new Date,n=c!=null&&c.start_date?new Date(c==null?void 0:c.start_date):new Date;c.start_date=n,c.end_date=i}return c}),R(a))},[a==null?void 0:a.data]);const[E,I]=x.useState(p);x.useRef(null),x.useState(s!=null&&s.search?s==null?void 0:s.search:"");const[k,H]=x.useState(s!=null&&s.per_page?s==null?void 0:s.per_page:10),[C,R]=x.useState([]),[$,A]=x.useState(!1),[W,L]=x.useState(""),[M,O]=x.useState(null),[l,y]=x.useState([]);x.useEffect(()=>{function t(c){const i=c==null?void 0:c.map(n=>{let S={};return(n==null?void 0:n.input_type)==="date"?S={headerName:n==null?void 0:n.name.toUpperCase(),field:n==null?void 0:n.name,valueFormatter:T=>{if(!T.value)return"";const P=T.value.getMonth()+1,J=T.value.getDate();return`${T.value.getFullYear()}-${P<10?"0"+P:P}-${J<10?"0"+J:J}`},cellEditor:"agDateCellEditor",filter:!1}:(n==null?void 0:n.input_type)==="text"?S={headerName:n==null?void 0:n.name.toUpperCase(),field:n==null?void 0:n.name}:(n==null?void 0:n.input_type)==="dropdown"&&(S={headerName:n==null?void 0:n.name.toUpperCase(),field:n==null?void 0:n.name,cellEditorParams:{values:JSON.parse(n==null?void 0:n.options)}}),S});I([...p,...i,{headerName:"",field:"",editable:!1,filter:!1,cellRenderer:Ee}])}(d==null?void 0:d.length)>0&&t(d)},[d]),x.useEffect(()=>{l.length>0&&b(ce(l))},[l]);const V=t=>{const c=l.findIndex(i=>{var n,S;return i.site_id===((n=t==null?void 0:t.data)==null?void 0:n.id)&&i.loc_id===((S=t==null?void 0:t.data)==null?void 0:S.loc_id)});y(c!==-1?i=>{var S;const n=[...i];return n[c]={...n[c],items:{...n[c].items,[(S=t==null?void 0:t.colDef)==null?void 0:S.field]:t==null?void 0:t.value}},n}:i=>{var n,S,T;return[...i,{site_id:(n=t==null?void 0:t.data)==null?void 0:n.id,loc_id:(S=t==null?void 0:t.data)==null?void 0:S.loc_id,items:{[(T=t==null?void 0:t.colDef)==null?void 0:T.field]:t==null?void 0:t.value}}]})},K=t=>{H(t),q.get(route("wireless.sites.index",{...s,per_page:t}))};x.useEffect(()=>{u!=null&&u.batch_site_id&&O(u==null?void 0:u.batch_site_id)},[]),x.useEffect(()=>{const t=async()=>{var i,n,S;try{let T=0;const P=await re.get(route("import.progress",{batchId:M}));if(P!=null&&P.data){let J=parseInt((i=P==null?void 0:P.data)==null?void 0:i.total_jobs),ne=parseInt((n=P==null?void 0:P.data)==null?void 0:n.pending_jobs),de=J-ne;parseInt((S=P==null?void 0:P.data)==null?void 0:S.failed_jobs)>0?clearInterval(c):(T=parseInt(de/J*100).toFixed(0),T<100?G.loading(`CSV Data Import Progress: ${T}%.
 Please wait....`,{id:"loading-toast",style:{backgroundColor:"#424242",color:"#ffffff",fontSize:14,borderRadius:4,fontWeight:"bold"}}):(G.dismiss("loading-toast"),clearInterval(c)))}}catch(T){console.log(T)}},c=setInterval(()=>{M&&t()},5e3);return()=>clearInterval(c)},[M]);const Q=()=>{var c;((c=g.current.props)==null?void 0:c.columnDefs).forEach(i=>{const n=i.field,S=g.current.api.getColumnFilterModel(n);console.log(S),S!=null&&S.filter&&q.get(route("wireless.sites.index",{search:S==null?void 0:S.filter}))})};return e.jsxs(ue,{user:o==null?void 0:o.user,children:[e.jsx(ie,{title:"WNTD"}),e.jsx("div",{className:"top-section p-4",children:e.jsxs("div",{className:"bg-white shadow rounded py-3 px-5 flex justify-between items-center",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"",children:[e.jsx(r.Typography,{variant:"h3",className:"tracking-tight",children:"WNTD"}),e.jsxs("ul",{className:"flex gap-1 text-gray-600 text-sm",children:[e.jsx("li",{children:e.jsx(ee,{href:route("dashboard"),children:"Dashboard"})}),e.jsx("li",{children:"/"}),e.jsx("li",{children:e.jsx(ee,{href:route("wireless.sites.index"),children:"WNTD"})})]})]})}),e.jsx("div",{className:"filter-wrapper md:px-4",children:e.jsxs("div",{className:"flex filter-details justify-end gap-2",children:[v==="super-admin"&&e.jsx(e.Fragment,{}),e.jsx(he,{route_name:"wireless.sites.export",file_name:"WNTD_Export"})]})})]})}),e.jsxs("div",{className:"content mt-6",children:[e.jsxs(r.Card,{className:"h-full w-full rounded-none",children:[e.jsxs("div",{className:"overflow-x-auto overflow-hidden",children:[(C==null?void 0:C.data)&&((U=C==null?void 0:C.data)==null?void 0:U.length)>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"ag-theme-quartz",style:{height:500},children:e.jsx(oe,{ref:g,rowData:C==null?void 0:C.data,columnDefs:E,defaultColDef:w,onCellValueChanged:V,onFilterChanged:Q})}),N&&e.jsx(_e,{tableHeader:E})]}),(C==null?void 0:C.length)===0&&e.jsx(r.Typography,{variant:"h6",color:"blue-gray",className:"text-center py-6",children:"No data found"})]}),e.jsxs("div",{className:"pagination flex justify-between items-center",children:[e.jsxs("div",{className:"px-4 flex gap-5",children:[e.jsx(r.Button,{variant:"gradient",size:"sm",className:"capitalize rounded text-sm",onClick:()=>{b(D(!0))},children:"Add New Row"}),e.jsx(we,{columns:E,hidden_columns:h,deleted_columns:f||[]})]}),e.jsxs("div",{className:"md:flex grid justify-start md:justify-end items-center pt-6 mb-8 gap-3 px-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-sm font-medium",children:"Rows per Page"}),e.jsxs("select",{className:"rounded-md text-sm font-medium border-gray-400 focus:ring-0 py-2",value:k,onChange:t=>{K(t.target.value)},children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"15",children:"15"}),e.jsx("option",{value:"20",children:"20"}),e.jsx("option",{value:"20",children:"25"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"all",children:"All"})]})]}),e.jsx("div",{className:"text-sm font-medium",children:`${a==null?void 0:a.from}-${a==null?void 0:a.to} of ${a==null?void 0:a.total} Records`}),e.jsx(xe,{links:C==null?void 0:C.links,perPage:k})]})]})]}),e.jsx(be,{mappingDialog:$,setMappingDialog:A,mappingData:W,setBatchId:O})]})]})}export{Le as default};
