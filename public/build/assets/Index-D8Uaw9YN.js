import{W as q,j as e,r as f,R as J,b as re,y as Y,Y as ce,a as le}from"./app-9Xx7uxZX.js";import{r as n}from"./index-_S3y8LLf.js";import{_ as G,A as ue,C as xe}from"./AuthenticatedLayout-rxxwe8ok.js";import{T as se}from"./TextInput-DmDTERgO.js";import{I as E}from"./InputLabel-dNx04VCm.js";import{I as H}from"./InputError-nGMjMN_x.js";import{M as me,S as he,C as fe}from"./search-KaaZxcix.js";import{T as te,D as oe,R as je,E as ve,P as pe}from"./RestoreTable-C85GjbOJ.js";import{U as ye}from"./UploadItem-Darj7kKT.js";import"./transition-DIoRP3Tk.js";import"./index-C9BP7un6.js";function be({addColumnDialog:t,setAddColumnDialog:a}){const{data:s,setData:d,post:i,processing:c,errors:u,reset:m}=q({type:"wntd",name:"",key:"",input_type:"",options:""}),g=h=>{h.preventDefault(),i(route("additional.columns.save.item"),{onSuccess:()=>{a(!1),m()}})};return e.jsxs(n.Dialog,{open:t,size:"xs",children:[e.jsx(n.DialogHeader,{children:"Add New Column"}),e.jsxs(n.DialogBody,{children:[e.jsxs("div",{className:"form-item mb-4",children:[e.jsx(E,{value:"Column Name",className:"mb-1"}),e.jsx(se,{className:"w-full text-sm font-medium text-gray-600",placeholder:"Column Name...",value:s.name,onChange:h=>d("name",h.target.value)}),e.jsx(H,{message:u.name,className:"text-sm font-medium"})]}),e.jsxs("div",{className:"form-item mb-4",children:[e.jsx(E,{value:"Column Key",className:"mb-1"}),e.jsx(se,{className:"w-full text-sm font-medium text-gray-600",placeholder:"Column key...",value:s.key,onChange:h=>d("key",h.target.value)}),e.jsx(H,{message:u.key,className:"text-sm font-medium"})]}),e.jsxs("div",{className:"form-item mb-4",children:[e.jsx(E,{value:"Column Input Type",className:"mb-1"}),e.jsxs("select",{className:"w-full rounded text-sm border-gray-300 shadow-sm font-medium text-gray-600 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600",value:s.input_type,onChange:h=>d("input_type",h.target.value),children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"text",children:"Text"}),e.jsx("option",{value:"date",children:"Date"}),e.jsx("option",{value:"dropdown",children:"DropDown"})]}),e.jsx(H,{message:u.input_type,className:"text-sm font-medium"})]}),(s==null?void 0:s.input_type)==="dropdown"&&e.jsxs("div",{className:"form-item mb-4",children:[e.jsx(E,{value:"Dropdown Options seprated by (|)",className:"mb-1"}),e.jsx("textarea",{className:"w-full rounded text-sm border-gray-300 shadow-sm font-normal focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600",placeholder:"Dropdown Options seprated by | ...",rows:4,value:s.options,onChange:h=>d("options",h.target.value)}),e.jsx(H,{message:u.options,className:"text-sm font-medium"})]})]}),e.jsxs(n.DialogFooter,{children:[e.jsx(n.Button,{variant:"text",color:"red",onClick:()=>a(!t),className:"mr-1 capitalize",children:e.jsx("span",{children:"Cancel"})}),e.jsx(n.Button,{variant:"gradient",color:"green",onClick:h=>g(h),className:"capitalize",loading:c,children:e.jsx("span",{children:"Submit"})})]})]})}function Ne({hideColumnDialog:t,setHideColumnDialog:a,columns:s,hidden_columns:d,deleted_columns:i}){const c=()=>a(!t),[u,m]=f.useState([]),{data:g,setData:h,post:b,processing:S,errors:k,reset:C}=q({type:"wntd",key:"hide",items:(d==null?void 0:d.length)>0?d:[]});f.useEffect(()=>{t&&m(v=>[...s.filter(P=>!i.includes(P.key)).map(P=>({key:P.key,name:P.name}))])},[t]);const w=(v,B)=>{const P=v.target.checked;h(I=>P?{...I,items:[...I.items,B]}:{...I,items:I.items.filter(_=>_!==B)})},j=v=>{v.preventDefault(),b(route("hide.columns.item"),{onSuccess:()=>{a(!1),C()}})};return e.jsxs(n.Dialog,{open:t,size:"xs",children:[e.jsx(n.DialogHeader,{children:"Hide Column"}),e.jsx(n.DialogBody,{children:e.jsxs("div",{className:"form-item",children:[e.jsx("p",{className:"text-[#333] font-semibold",children:"Please select the column you want to hide"}),e.jsx("div",{className:"form-item grid grid-cols-2",children:(u==null?void 0:u.length)>0&&u.map((v,B)=>e.jsx(J.Fragment,{children:e.jsx(n.Checkbox,{containerProps:{className:"py-3"},className:"w-5 h-5 rounded-md",label:e.jsx(n.Typography,{color:"blue-gray",className:"font-medium text-sm",children:v==null?void 0:v.name}),onChange:P=>w(P,v==null?void 0:v.key),defaultChecked:d==null?void 0:d.includes(v==null?void 0:v.key)})},B))})]})}),e.jsxs(n.DialogFooter,{children:[e.jsx(n.Button,{variant:"text",color:"red",onClick:c,className:"mr-1 capitalize",children:e.jsx("span",{children:"Cancel"})}),e.jsx(n.Button,{variant:"gradient",color:"green",onClick:v=>{j(v)},className:"capitalize",loading:S,children:e.jsx("span",{children:"Confirm"})})]})]})}function ge({renameColumnDialog:t,setRenameColumnDialog:a,columns:s,deleted_columns:d}){var k;const{data:i,setData:c,post:u,processing:m,errors:g,reset:h}=q({type:"wntd",key:"rename",items:[]});f.useEffect(()=>{t&&c(C=>{const w=[...s.filter(j=>!d.includes(j.key)).map(j=>({key:j.key,name:j.name}))];return{...C,items:w}})},[t]);const b=(C,w)=>{c(j=>({...j,items:j.items.map(v=>v.key===C?{...v,name:w}:v)}))},S=C=>{C.preventDefault(),u(route("rename.columns.item"),{onSuccess:()=>{a(!1),h()}})};return e.jsxs(n.Dialog,{open:t,size:"xs",children:[e.jsx(n.DialogHeader,{children:"Rename Columns"}),e.jsx(n.DialogBody,{className:"max-h-[42rem] overflow-scroll",children:e.jsx("div",{className:"grid grid-cols-2 gap-3",children:(i==null?void 0:i.items.length)>0&&((k=i==null?void 0:i.items)==null?void 0:k.map((C,w)=>e.jsx("div",{className:"form-item mb-2",children:e.jsx(se,{className:"w-full text-sm font-medium text-gray-600",value:C==null?void 0:C.name,onChange:j=>b(C==null?void 0:C.key,j.target.value)})},w)))})}),e.jsxs(n.DialogFooter,{children:[e.jsx(n.Button,{variant:"text",color:"red",className:"mr-1 capitalize",onClick:()=>a(!1),children:"Cancel"}),e.jsx(n.Button,{variant:"gradient",color:"green",className:"capitalize",onClick:C=>S(C),loading:m,children:"Submit"})]})]})}function we({deleteColumnDialog:t,setDeleteColumnDialog:a,columns:s,deleted_columns:d}){const{data:i,setData:c,post:u,processing:m,errors:g,reset:h}=q({type:"wntd",key:"delete",items:[]}),[b,S]=f.useState([]);f.useEffect(()=>{t&&S(w=>[...s.filter(v=>!d.includes(v.key)).map(v=>({key:v.key,name:v.name}))])},[t]);const k=(w,j)=>{const v=w.target.checked;c(B=>v?{...B,items:[...B.items,j]}:{...B,items:B.items.filter(P=>P!==j)})},C=w=>{w.preventDefault(),u(route("delete.columns.item"),{onSuccess:()=>{a(!1),h()}})};return e.jsxs(n.Dialog,{open:t,size:"xs",children:[e.jsx(n.DialogHeader,{children:"Delete Columns"}),e.jsx(n.DialogBody,{className:"max-h-[42rem] overflow-scroll",children:e.jsxs("div",{className:"form-item",children:[e.jsx("p",{className:"text-[#333] font-semibold",children:"Please select the column you want to delete."}),e.jsx("div",{className:"grid grid-cols-2",children:(b==null?void 0:b.length)>0&&b.map((w,j)=>e.jsx(J.Fragment,{children:e.jsx(n.Checkbox,{containerProps:{className:"py-3"},className:"w-5 h-5 rounded-md",label:e.jsx(n.Typography,{color:"blue-gray",className:"font-medium text-sm",children:w==null?void 0:w.name}),onChange:v=>{k(v,w==null?void 0:w.key)}})},j))})]})}),e.jsxs(n.DialogFooter,{children:[e.jsx(n.Button,{variant:"text",color:"red",className:"mr-1 capitalize",onClick:()=>a(!1),children:"Cancel"}),e.jsx(n.Button,{variant:"gradient",color:"green",className:"capitalize",onClick:w=>{C(w)},loading:m,children:"Submit"})]})]})}function Ce({arrangeColumnDialog:t,setArrangeColumnDialog:a,columns:s,deleted_columns:d}){const[i,c]=f.useState([]),[u,m]=f.useState(null),{data:g,setData:h,post:b,processing:S,errors:k,reset:C}=q({type:"wntd",key:"arrange",items:[]});f.useEffect(()=>{t&&c(I=>[...(R=>R.map((V,$)=>({...V,position:$+1})))(s.filter(R=>!d.includes(R.key)).map(R=>({key:R.key,name:R.name})))])},[t]);const w=(I,_)=>{m(_)},j=()=>{m(null)},v=I=>{I.preventDefault()},B=(I,_)=>{if(!u)return;const A=i.indexOf(u),R=i.indexOf(_);if(A!==-1&&R!==-1){const $=[...(O=>O.map((l,p)=>({...l,position:p+1})))(i)],[W]=$.splice(A,1);$.splice(R,0,W);const L=$.map((O,l)=>({...O,position:l+1}));c(L);const U=L.map(O=>({key:O.key,position:O.position}));h("items",U)}},P=I=>{I.preventDefault(),b(route("rearrange.columns.item"),{onSuccess:()=>{a(!1),C()}})};return e.jsxs(n.Dialog,{open:t,size:"xs",children:[e.jsx(n.DialogHeader,{children:"Re-arrange Columns"}),e.jsxs(n.DialogBody,{className:"max-h-[42rem] overflow-scroll",children:[e.jsx("p",{className:"text-[#333] font-semibold mb-3",children:"Please drag and drop the column you want to arrange."}),e.jsx("div",{className:"draggable-wrapper border rounded-md py-2",children:(i==null?void 0:i.length)>0&&(i==null?void 0:i.map((I,_)=>e.jsx("div",{className:"text-gray-600 font-medium py-1 px-2 text-sm  cursor-move",draggable:"true",onDragStart:A=>w(A,I),onDragEnd:j,onDragOver:v,onDrop:A=>B(A,I),children:e.jsxs("div",{className:"flex items-center gap-3 border py-2 px-2 rounded-md ",children:[e.jsx("div",{className:"icon-wrapper",children:e.jsx(me,{strokeWidth:1.5,size:18})}),I.name]})},_)))})]}),e.jsxs(n.DialogFooter,{children:[e.jsx(n.Button,{variant:"text",color:"red",className:"mr-1 capitalize",onClick:()=>a(!1),children:"cancel"}),e.jsx(n.Button,{variant:"gradient",color:"green",className:"capitalize",onClick:I=>P(I),loading:S,children:"Submit"})]})]})}function ke({columns:t,hidden_columns:a,deleted_columns:s}){const[d,i]=f.useState(!1),[c,u]=f.useState(!1),[m,g]=f.useState(!1),[h,b]=f.useState(!1),[S,k]=f.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(n.Menu,{children:[e.jsx(n.MenuHandler,{children:e.jsx(n.Button,{variant:"gradient",size:"sm",className:"capitalize",children:"Column Options"})}),e.jsxs(n.MenuList,{className:"font-semibold text-gray-600",children:[e.jsx(n.MenuItem,{onClick:()=>{i(!0)},children:"Add Column"}),e.jsx(n.MenuItem,{onClick:()=>{u(!0)},children:"Show/Hide Columns"}),e.jsx(n.MenuItem,{onClick:()=>{g(!0)},children:"Rename Columns"}),e.jsx(n.MenuItem,{onClick:()=>{k(!0)},children:"Rearrange Columns"}),e.jsx(n.MenuItem,{onClick:()=>{b(!0)},className:"text-red-500",children:"Delete Columns"})]})]}),e.jsx(be,{addColumnDialog:d,setAddColumnDialog:i}),e.jsx(Ne,{hideColumnDialog:c,setHideColumnDialog:u,columns:t,hidden_columns:a,deleted_columns:s}),e.jsx(ge,{renameColumnDialog:m,setRenameColumnDialog:g,columns:t,deleted_columns:s}),e.jsx(we,{deleteColumnDialog:h,setDeleteColumnDialog:b,columns:t,deleted_columns:s}),e.jsx(Ce,{arrangeColumnDialog:S,setArrangeColumnDialog:k,columns:t,deleted_columns:s})]})}function Se({mappingDialog:t,setMappingDialog:a,mappingData:s,setBatchId:d}){var B,P,I,_,A,R,V,$,W,L,U,O;const i=()=>a(!t),[c,u]=f.useState({file_path:s?s==null?void 0:s.filePath:"",loc_id:"",wntd:"",imsi:"",version:"",avc:"",bw_profile:"",lon:"",lat:"",site_name:"",home_cell:"",home_pci:"",traffic_profile:""}),[m,g]=f.useState({}),[h,b]=f.useState(!1),[S,k]=f.useState(""),[C,w]=f.useState(""),j=(l,p)=>{u(K=>({...K,[l]:p}))};f.useEffect(()=>{j("file_path",s!=null&&s.filePath?s==null?void 0:s.filePath:"")},[s]);const v=async l=>{var K,Z,D,Q,X,ee;l.preventDefault();let p={};if(["loc_id","wntd","imsi","version","avc","bw_profile","lon","lat","site_name","home_cell","home_pci","traffic_profile"].forEach(z=>{c[z]||(p[z]="This field is required.")}),g(p),Object.keys(p).length>0){console.log(p);return}try{b(!0);const z=await re.post(route("wireless.sites.map.save"),c);z!=null&&z.data&&(w((Z=(K=z==null?void 0:z.data)==null?void 0:K.success)==null?void 0:Z.message),d((D=z==null?void 0:z.data)==null?void 0:D.batch_id),setTimeout(()=>{a(!1),w(""),k("")},3e3),Y.visit(route("wireless.sites.index")))}catch(z){console.log("error:",z),k(`${(ee=(X=(Q=z==null?void 0:z.response)==null?void 0:Q.data)==null?void 0:X.error)==null?void 0:ee.message}`)}finally{b(!1)}};return e.jsx(J.Fragment,{children:e.jsxs(n.Dialog,{open:t,size:"xs",children:[e.jsx(n.DialogHeader,{children:"CSV Mapping"}),S&&e.jsx("p",{className:"text-red-500 font-medium text-[12px] px-4",children:S}),C&&e.jsx("p",{className:"text-green-500 font-medium text-[12px] px-4",children:C}),e.jsxs(n.DialogBody,{className:"px-6 overflow-scroll",children:[e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(E,{value:"LOCID",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:c.loc_id,onChange:l=>j("loc_id",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((B=s==null?void 0:s.header)==null?void 0:B.length)>0&&(s==null?void 0:s.header.map((l,p)=>e.jsx("option",{value:l,children:l},p)))]}),e.jsx(H,{message:m.loc_id,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(E,{value:"WNTD",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:c.wntd,onChange:l=>j("wntd",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((P=s==null?void 0:s.header)==null?void 0:P.length)>0&&(s==null?void 0:s.header.map((l,p)=>e.jsx("option",{value:l,children:l},p)))]}),e.jsx(H,{message:m.wntd,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(E,{value:"IMSI",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:c.imsi,onChange:l=>j("imsi",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((I=s==null?void 0:s.header)==null?void 0:I.length)>0&&(s==null?void 0:s.header.map((l,p)=>e.jsx("option",{value:l,children:l},p)))]}),e.jsx(H,{message:m.imsi,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(E,{value:"VERSION",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:c.version,onChange:l=>j("version",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((_=s==null?void 0:s.header)==null?void 0:_.length)>0&&(s==null?void 0:s.header.map((l,p)=>e.jsx("option",{value:l,children:l},p)))]}),e.jsx(H,{message:m.version,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(E,{value:"AVC",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:c.avc,onChange:l=>j("avc",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((A=s==null?void 0:s.header)==null?void 0:A.length)>0&&(s==null?void 0:s.header.map((l,p)=>e.jsx("option",{value:l,children:l},p)))]}),e.jsx(H,{message:m.avc,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(E,{value:"BW Profile",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:c.bw_profile,onChange:l=>j("bw_profile",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((R=s==null?void 0:s.header)==null?void 0:R.length)>0&&(s==null?void 0:s.header.map((l,p)=>e.jsx("option",{value:l,children:l},p)))]}),e.jsx(H,{message:m.bw_profile,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(E,{value:"Lon",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:c.lon,onChange:l=>j("lon",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((V=s==null?void 0:s.header)==null?void 0:V.length)>0&&(s==null?void 0:s.header.map((l,p)=>e.jsx("option",{value:l,children:l},p)))]}),e.jsx(H,{message:m.lon,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(E,{value:"Lat",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:c.lat,onChange:l=>j("lat",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),(($=s==null?void 0:s.header)==null?void 0:$.length)>0&&(s==null?void 0:s.header.map((l,p)=>e.jsx("option",{value:l,children:l},p)))]}),e.jsx(H,{message:m.lat,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(E,{value:"SiteName",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:c.site_name,onChange:l=>j("site_name",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((W=s==null?void 0:s.header)==null?void 0:W.length)>0&&(s==null?void 0:s.header.map((l,p)=>e.jsx("option",{value:l,children:l},p)))]}),e.jsx(H,{message:m.site_name,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(E,{value:"HomeCell",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:c.home_cell,onChange:l=>j("home_cell",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((L=s==null?void 0:s.header)==null?void 0:L.length)>0&&(s==null?void 0:s.header.map((l,p)=>e.jsx("option",{value:l,children:l},p)))]}),e.jsx(H,{message:m.home_cell,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(E,{value:"HomePCI",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:c.home_pci,onChange:l=>j("home_pci",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((U=s==null?void 0:s.header)==null?void 0:U.length)>0&&(s==null?void 0:s.header.map((l,p)=>e.jsx("option",{value:l,children:l},p)))]}),e.jsx(H,{message:m.home_pci,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(E,{value:"Traffic_Profile",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:c.traffic_profile,onChange:l=>j("traffic_profile",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((O=s==null?void 0:s.header)==null?void 0:O.length)>0&&(s==null?void 0:s.header.map((l,p)=>e.jsx("option",{value:l,children:l},p)))]}),e.jsx(H,{message:m.traffic_profile,className:"!text-[12px] font-medium"})]})]})})]}),e.jsxs(n.DialogFooter,{children:[e.jsx(n.Button,{variant:"text",color:"red",onClick:i,className:"mr-1",disabled:h,children:e.jsx("span",{children:"Cancel"})}),e.jsx(n.Button,{variant:"gradient",color:"green",onClick:v,loading:h,children:e.jsx("span",{children:"Confirm"})})]})]})})}function Ie({site_id:t,changedItems:a,setChangedItems:s}){const[d,i]=f.useState(!1),c=async u=>{var m,g,h;if(a.length>0){let b=a.filter(S=>S.site_id===u)[0];if(b){i(!0);const S=await axios.post(route("wireless.sites.save.item"),{site_id:b==null?void 0:b.site_id,location_id:b==null?void 0:b.loc_id,items:b==null?void 0:b.items});(m=S==null?void 0:S.data)!=null&&m.success&&(i(!1),G.success((h=(g=S==null?void 0:S.data)==null?void 0:g.success)==null?void 0:h.message),s(k=>k.filter(C=>C.site_id!==u)))}}};return e.jsx(n.Button,{size:"sm",className:"capitalize py-1 px-2 rounded font-semibold",disabled:!a.some(u=>u.site_id===t),onClick:()=>{c(t)},loading:d,children:"Save"})}function _e({site_id:t}){const{processing:a,delete:s}=q(),[d,i]=f.useState(!1),c={onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1)},u=()=>{s(route("wireless.sites.destroy",t),{preserveScroll:!0,onSuccess:()=>{Y.visit(route("wireless.sites.index"))}})};return e.jsx(J.Fragment,{children:e.jsxs(n.Popover,{placement:"top-end",open:d,handler:i,children:[e.jsx(n.PopoverHandler,{...c,children:e.jsx(n.Button,{variant:"gradient",color:"red",size:"sm",className:"capitalize py-1 px-2 rounded",onClick:()=>setOpen(!0),children:e.jsx(te,{size:14})})}),e.jsxs(n.PopoverContent,{...c,className:"px-3",children:[e.jsx(n.Typography,{variant:"h6",className:"text-center",children:"Are you sure?"}),e.jsx(n.Typography,{variant:"small",className:"font-normal",children:"This cannot be reverted back."}),e.jsxs("div",{className:"mt-2 flex justify-between",children:[e.jsx(n.Button,{variant:"text",color:"red",size:"sm",className:"capitalize rounded",onClick:()=>i(!1),children:"Cancel"}),e.jsx(n.Button,{variant:"gradient",color:"red",size:"sm",className:"capitalize rounded",onClick:u,children:"Delete"})]})]})]})})}function ze({name:t,handleItemOnChange:a}){const[s,d]=f.useState(""),i=c=>{d(c),a(t,c)};return e.jsx("div",{className:"w-full h-full",children:e.jsx("textarea",{className:"border-none focus:ring-0 bg-transparent !shadow-none text-[12px] font-medium w-full",rows:1,value:s,onChange:c=>{i(c.target.value)}})})}function Pe({name:t,handleItemOnChange:a}){const[s,d]=f.useState(""),i=c=>{d(c),a(t,c)};return e.jsx("div",{className:"w-full h-full",children:e.jsx(oe,{selected:s,onChange:c=>i(c),className:"border-none focus:ring-0 w-full bg-transparent !shadow-none text-[12px] font-medium",dateFormat:"dd/MM/yyyy"})})}function Be({name:t,handleItemOnChange:a,options:s}){const[d,i]=f.useState(""),c=u=>{i(u),a(t,u)};return e.jsx("div",{className:"w-full h-full min-w-32",children:e.jsxs("select",{value:d,onChange:u=>{c(u.target.value)},className:"border-none focus:ring-0 w-full bg-transparent !shadow-none text-[12px] font-medium px-1",children:[e.jsx("option",{value:"",children:"Select"}),(s==null?void 0:s.length)>0&&s.map((u,m)=>e.jsx("option",{value:u.value,children:u.label},m))]})})}function Te(){return e.jsx("div",{})}const Ee={text:ze,date:Pe,dropdown:Be,upload:Te};function He({item:t,handleItemOnChange:a}){const s=Ee[t.input_type?t.input_type:"text"],d={status:[{label:"In Progress",value:"in_progress"},{label:"Not Started",value:"not_started"},{label:"Completed",value:"completed"}],solution_type:[{label:"Device Upgrade",value:"device_upgrade"},{label:"Reparent",value:"reparent"},{label:"Repan",value:"repan"}]};return e.jsx(s,{name:t.key,options:d[t.key],handleItemOnChange:a})}function Re({tableHeader:t,setAddNewRow:a}){const{data:s,setData:d,post:i,processing:c,errors:u,reset:m}=q({newItem:{}});console.log(s);const g=(S,k)=>{const C={...s.newItem};d("newItem",{...C,[S]:k})},h=()=>{d("newItem",{}),a(!1)},b=()=>{if(!(s!=null&&s.newItem.loc_id))return G.error("LocId is required");i(route("wireless.sites.add.row"),{preserveScroll:!0,onSuccess:()=>{a(!1),G.success("Row Added successfully")}})};return e.jsxs("tr",{className:"border-b",children:[(t==null?void 0:t.length)>0&&t.map((S,k)=>e.jsx("td",{className:"border-l h-10 text-[12px] font-medium ps-2",children:e.jsx(He,{item:S,handleItemOnChange:g})},k)),e.jsx("td",{className:"border-l h-10 px-3",children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx(n.Button,{variant:"gradient",size:"sm",className:"capitalize py-1 px-2 rounded font-semibold",onClick:b,children:"Save"}),e.jsx(n.Button,{variant:"gradient",color:"red",size:"sm",className:"capitalize py-1 px-2 rounded",onClick:h,children:e.jsx(te,{size:14})})]})})]})}function Fe({siteId:t,locId:a,name:s,value:d,handleEditAbleItem:i}){const[c,u]=f.useState(d||""),m=g=>{u(g),i(t,a,s,g)};return e.jsx("div",{className:"w-full h-full",children:e.jsx("textarea",{className:"border-none focus:ring-0 bg-transparent !shadow-none text-[12px] font-medium w-full",value:c,rows:1,onChange:g=>{m(g.target.value)}})})}function Me({siteId:t,locId:a,name:s,value:d,handleEditAbleItem:i}){const[c,u]=f.useState(d||""),m=g=>{u(g),i(t,a,s,g)};return e.jsx("div",{className:"w-full h-full",children:e.jsx(oe,{selected:c,onChange:g=>m(g),className:"border-none focus:ring-0 w-full bg-transparent !shadow-none text-[12px] font-medium",dateFormat:"dd/MM/yyyy"})})}function Oe({siteId:t,locId:a,name:s,value:d,options:i,handleEditAbleItem:c}){const[u,m]=f.useState(d||""),g=h=>{m(h),c(t,a,s,h)};return e.jsx("div",{className:"w-full h-full min-w-32",children:e.jsxs("select",{value:u,onChange:h=>{g(h.target.value)},className:"border-none focus:ring-0 w-full bg-transparent !shadow-none text-[12px] font-medium px-1",children:[e.jsx("option",{value:"",children:"Select"}),(i==null?void 0:i.length)>0&&i.map((h,b)=>e.jsx("option",{value:h.value,children:h.label},b))]})})}const Ae={text:Fe,date:Me,dropdown:Oe,upload:ye};function $e({item:t,site:a,handleEditAbleItem:s}){const d=Ae[t.input_type],i={status:[{label:"In Progress",value:"in_progress"},{label:"Not Started",value:"not_started"},{label:"Completed",value:"completed"}],solution_type:[{label:"Device Upgrade",value:"device_upgrade"},{label:"Reparent",value:"reparent"},{label:"Repan",value:"repan"}]};return e.jsx(d,{siteId:a==null?void 0:a.id,locId:a==null?void 0:a.loc_id,name:t.key,value:t.value,handleEditAbleItem:s,options:i[t.key]})}function De({auth:t,sites:a,get_data:s,batch:d,additional_columns:i,hidden_columns:c,renamed_columns:u,deleted_columns:m,arrange_columns:g}){var ne;const{role:h}=t,b=[{name:"LOCID",sortable:!0,key:"loc_id",position:1,editable:!1},{name:"WNTD",sortable:!0,key:"wntd",position:2,editable:!1},{name:"IMSI",sortable:!0,key:"imsi",position:3,editable:!1},{name:"VERSION",sortable:!0,key:"version",position:4,editable:!1},{name:"AVC",sortable:!0,key:"avc",position:5,editable:!1},{name:"BW Profile",sortable:!0,key:"bw_profile",position:6,editable:!1},{name:"Lon",sortable:!0,key:"lon",position:7,editable:!1},{name:"Lat",sortable:!0,key:"lat",position:8,editable:!1},{name:"SiteName",sortable:!0,key:"site_name",position:9,editable:!1},{name:"HomeCell",sortable:!0,key:"home_cell",position:10,editable:!1},{name:"HomePCI",sortable:!0,key:"home_pci",position:11,editable:!1},{name:"Traffic Profile",sortable:!0,key:"traffic_profile",position:12},{name:"Start Date",sortable:!1,key:"start_date",position:13,editable:!0,input_type:"date"},{name:"End Date",sortable:!1,key:"end_date",position:14,editable:!0,input_type:"date"},{name:"Solution Type",sortable:!1,key:"solution_type",position:15,editable:!0,input_type:"dropdown"},{name:"Status",sortable:!1,key:"status",position:16,editable:!0,input_type:"dropdown"},{name:"Remarks",sortable:!1,key:"remarks",position:17,editable:!0,input_type:"text"},{name:"Artifacts",sortable:!1,key:"artifacts",position:18,editable:!0,input_type:"upload"}];function S(o,N){return o==null?N:N==null?o:[...new Set([...o,...N])]}const k=S(c,m);function C(){const o=[...b],N=i==null?void 0:i.map(x=>({...x,editable:!0})),r=(x,y)=>x.position!==void 0&&y.position!==void 0?x.position-y.position:x.position!==void 0?-1:y.position!==void 0?1:0;return u&&(o.forEach(x=>{const y=u.find(M=>M.key===x.key);y&&(x.name=y.name)}),N.forEach(x=>{const y=u.find(M=>M.key===x.key);y&&(x.name=y.name)})),k&&(o.forEach(x=>{k.find(M=>M===x.key)&&(x.hidden=!0)}),N.forEach(x=>{k.find(M=>M===x.key)&&(x.hidden=!0)})),g&&(o.forEach(x=>{const y=g.find(M=>M.key===x.key);y&&(x.position=y.position)}),N.forEach(x=>{const y=g.find(M=>M.key===x.key);y&&(x.position=y.position)})),[...o,...N].sort(r)}const w=C(),j=f.useRef(null),[v,B]=f.useState(s!=null&&s.search?s==null?void 0:s.search:""),[P,I]=f.useState(s!=null&&s.per_page?s==null?void 0:s.per_page:10),[_]=f.useState(a),[A,R]=f.useState(!1),[V,$]=f.useState(""),[W,L]=f.useState(null),[U,O]=f.useState([]),[l,p]=f.useState(!1),K=o=>{j.current.click()},Z=async o=>{var r,T,F;const N=new FormData;N.append("import_file",o.target.files[0]);try{const x=await re.post(route("wireless.sites.import"),N);x!=null&&x.data&&($(x==null?void 0:x.data),R(!0))}catch(x){G.error(`${(F=(T=(r=x==null?void 0:x.response)==null?void 0:r.data)==null?void 0:T.error)==null?void 0:F.message}`)}},D=async()=>{Y.get(route("wireless.sites.index",{search:v}))},Q=async(o,N)=>{Y.get(route("wireless.sites.index",{order_by:o,order:N}))},X=async(o,N)=>{Y.get(route("wireless.sites.index",{filter_by:o,value:N}))},ee=o=>{I(o),Y.get(route("wireless.sites.index",{...s,per_page:o}))};f.useEffect(()=>{d!=null&&d.batch_site_id&&L(d==null?void 0:d.batch_site_id)},[]),f.useEffect(()=>{const o=async()=>{var r,T,F;try{let x=0;const y=await re.get(route("import.progress",{batchId:W}));if(y!=null&&y.data){let M=parseInt((r=y==null?void 0:y.data)==null?void 0:r.total_jobs),ie=parseInt((T=y==null?void 0:y.data)==null?void 0:T.pending_jobs),de=M-ie;parseInt((F=y==null?void 0:y.data)==null?void 0:F.failed_jobs)>0?clearInterval(N):(x=parseInt(de/M*100).toFixed(0),x<100?G.loading(`CSV Data Import Progress: ${x}%.
 Please wait....`,{id:"loading-toast",style:{backgroundColor:"#424242",color:"#ffffff",fontSize:14,borderRadius:4,fontWeight:"bold"}}):(G.dismiss("loading-toast"),clearInterval(N)))}}catch(x){console.log(x)}},N=setInterval(()=>{W&&o()},5e3);return()=>clearInterval(N)},[W]);const z=(o,N,r,T)=>{const F=U.findIndex(x=>x.site_id===o&&x.loc_id===N);O(F!==-1?x=>{const y=[...x];return y[F]={...y[F],items:{...y[F].items,[r]:T}},y}:x=>[...x,{site_id:o,loc_id:N,items:{[r]:T}}])},ae=o=>{let N=[];return w.forEach(r=>{const T=r.key,F=o[T];F!==void 0?r!=null&&r.position?N[r.position-1]={key:T,value:F,editable:r==null?void 0:r.editable,input_type:r!=null&&r.input_type?r==null?void 0:r.input_type:""}:N.push({key:T,value:F,editable:r==null?void 0:r.editable,input_type:r!=null&&r.input_type?r==null?void 0:r.input_type:""}):N.push({key:T,value:"",editable:r==null?void 0:r.editable,input_type:r!=null&&r.input_type?r==null?void 0:r.input_type:""})}),N};return e.jsxs(ue,{user:t==null?void 0:t.user,children:[e.jsx(ce,{title:"WNTD"}),e.jsx("div",{className:"top-section p-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"",children:[e.jsx(n.Typography,{variant:"h3",className:"tracking-tight",children:"WNTD"}),e.jsxs("ul",{className:"flex gap-1 text-gray-600 text-sm",children:[e.jsx("li",{children:e.jsx(le,{href:route("dashboard"),children:"Dashboard"})}),e.jsx("li",{children:"/"}),e.jsx("li",{children:e.jsx(le,{href:route("wireless.sites.index"),children:"WNTD"})})]})]})})}),e.jsx("div",{className:"filter-wrapper md:px-4",children:e.jsxs("div",{className:"flex filter-details justify-end gap-2",children:[e.jsxs("div",{className:"search-wrapper w-1/5 flex relative",children:[e.jsx(se,{placeholder:"Search...",className:"w-full text-sm rounded-md rounded-r-none border-r-0 focus:ring-0 h-8",value:v,onChange:o=>B(o.target.value)}),e.jsx("div",{className:"search-icon",children:e.jsx(n.IconButton,{size:"sm",className:"rounded-l-none",onClick:D,children:e.jsx(he,{color:"white",size:18})})})]}),e.jsx("div",{className:"status-filter",children:e.jsxs("select",{className:"w-52 text-sm rounded-md focus:ring-0 h-8 border-gray-300 py-1 text-gray-600 font-medium",onChange:o=>X("status",o.target.value),value:(s==null?void 0:s.filter_by)==="status"?s==null?void 0:s.value:"",children:[e.jsx("option",{value:"",children:"Filter by Status"}),e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"not_started",children:"Not Started"}),e.jsx("option",{value:"completed",children:"Completed"})]})}),e.jsx("div",{className:"filter-solution-type",children:e.jsxs("select",{className:"w-52 text-sm rounded-md focus:ring-0 h-8 border-gray-300 py-1 text-gray-600 font-medium",onChange:o=>X("solution_type",o.target.value),value:(s==null?void 0:s.filter_by)==="solution_type"?s==null?void 0:s.value:"",children:[e.jsx("option",{value:"",children:"Filter by Solution Type"}),e.jsx("option",{value:"device_upgrade",children:"Device Upgrade"}),e.jsx("option",{value:"reparent",children:"Reparent"}),e.jsx("option",{value:"repan",children:"Repan"})]})}),h==="super-admin"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"import-type-field",children:[e.jsx(n.Button,{variant:"gradient",className:"capitalize",size:"sm",onClick:K,children:"Import from CSV"}),e.jsx("input",{type:"file",onChange:Z,ref:j,style:{display:"none"}})]}),e.jsx(ke,{columns:w,hidden_columns:c,deleted_columns:m||[]}),e.jsx(je,{type:"wntd"})]}),e.jsx(ve,{route_name:"wireless.sites.export",file_name:"WNTD_Export"})]})}),e.jsxs("div",{className:"content mt-6",children:[e.jsx(n.Card,{className:"h-full w-full rounded-none",children:e.jsxs("div",{className:"overflow-x-auto overflow-hidden",children:[e.jsxs("table",{className:"w-full table-auto",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[w.map(o=>e.jsx("th",{className:`border-y border-blue-gray-100 bg-blue-gray-50/50 p-2 border-l cursor-pointer ${k!=null&&k.includes(o==null?void 0:o.key)?"hidden":""}`,children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx(n.Typography,{variant:"small",className:"leading-none text-gray-800 font-medium text-sm",children:o.name}),(o==null?void 0:o.sortable)&&e.jsxs("div",{className:"relative mt-1",children:[e.jsx("span",{className:"absolute -top-2 right-0 hover:bg-blue-gray-100 rounded-sm",children:e.jsx(fe,{size:12,strokeWidth:2,onClick:()=>{Q(o.key,"asc")}})}),e.jsx("span",{className:"absolute -bottom-1 right-0 hover:bg-blue-gray-100 rounded-sm",children:e.jsx(xe,{size:12,strokeWidth:2,onClick:()=>{Q(o.key,"desc")}})})]})]})},o.name)),e.jsx("th",{className:"border-y border-blue-gray-100 bg-blue-gray-50/50 p-2 border-l cursor-pointer"})]})}),e.jsxs("tbody",{children:[_==null?void 0:_.data.map(o=>{const N=ae(o);return e.jsxs("tr",{className:"even:bg-blue-gray-50/50",children:[N==null?void 0:N.map((r,T)=>e.jsx(J.Fragment,{children:e.jsx("td",{className:`border-l h-10 text-[12px] font-medium ps-1 ${k!=null&&k.includes(r==null?void 0:r.key)?"hidden":""}`,children:(r==null?void 0:r.key)==="loc_id"?e.jsx(le,{href:route("wireless.show.location.index",o==null?void 0:o.id),className:"font-semibold underline",children:r==null?void 0:r.value}):e.jsx(J.Fragment,{children:r!=null&&r.editable?e.jsx($e,{item:r,site:o,handleEditAbleItem:z}):e.jsx(J.Fragment,{children:(r==null?void 0:r.key)==="imsi"?parseFloat(r==null?void 0:r.value):r==null?void 0:r.value})})})},T)),e.jsx("td",{className:"border-l h-10 px-3",children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx(Ie,{site_id:o==null?void 0:o.id,changedItems:U,setChangedItems:O}),e.jsx(_e,{site_id:o==null?void 0:o.id})]})})]},o==null?void 0:o.id)}),l&&e.jsx(Re,{tableHeader:w,setAddNewRow:p})]})]}),((ne=_==null?void 0:_.data)==null?void 0:ne.length)===0&&e.jsx(n.Typography,{variant:"h6",color:"blue-gray",className:"text-center py-6",children:"No data found"}),e.jsxs("div",{className:"pagination flex justify-between items-center",children:[e.jsx("div",{className:"px-4",children:e.jsx(n.Button,{variant:"gradient",size:"sm",className:"capitalize rounded",onClick:()=>{p(!0)},children:"Add New Row"})}),e.jsxs("div",{className:"md:flex grid justify-start md:justify-end items-center pt-6 mb-8 gap-3 px-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-sm font-medium",children:"Rows per Page"}),e.jsxs("select",{className:"rounded-md text-sm font-medium border-gray-400 focus:ring-0 py-2",value:P,onChange:o=>{ee(o.target.value)},children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"15",children:"15"}),e.jsx("option",{value:"20",children:"20"}),e.jsx("option",{value:"20",children:"25"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"all",children:"All"})]})]}),e.jsx("div",{className:"text-sm font-medium",children:`${a==null?void 0:a.from}-${a==null?void 0:a.to} of ${a==null?void 0:a.total} Records`}),e.jsx(pe,{links:_==null?void 0:_.links,perPage:P})]})]})]})}),e.jsx(Se,{mappingDialog:A,setMappingDialog:R,mappingData:V,setBatchId:L})]})]})}export{De as default};
