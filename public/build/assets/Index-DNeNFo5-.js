import{W as q,j as e,r as f,R as J,b as te,y as Y,Y as ce,a as le}from"./app-DzalHcVU.js";import{r}from"./index-D4XrngbZ.js";import{_ as G,A as ue,C as xe}from"./AuthenticatedLayout-DdSPs-UH.js";import{T as se}from"./TextInput-CxoPIxQU.js";import{I as B}from"./InputLabel-wtpN6Dbq.js";import{I as E}from"./InputError-CQQuqtUr.js";import{M as he,T as ne,D as oe,S as me,C as fe,P as je}from"./react-datepicker-gxwmPFVC.js";import{R as pe,E as ve}from"./RestoreTable-EjPBsHQI.js";import{U as ye}from"./UploadItem-DlIhJg59.js";import"./transition-C5FwFN3G.js";import"./index-DDCp2-z9.js";function be({addColumnDialog:n,setAddColumnDialog:a}){const{data:s,setData:c,post:i,processing:d,errors:u,reset:h}=q({type:"wntd",name:"",key:"",input_type:"",options:""}),g=m=>{m.preventDefault(),i(route("additional.columns.save.item"),{onSuccess:()=>{a(!1),h()}})};return e.jsxs(r.Dialog,{open:n,size:"xs",children:[e.jsx(r.DialogHeader,{children:"Add New Column"}),e.jsxs(r.DialogBody,{children:[e.jsxs("div",{className:"form-item mb-4",children:[e.jsx(B,{value:"Column Name",className:"mb-1"}),e.jsx(se,{className:"w-full text-sm font-medium text-gray-600",placeholder:"Column Name...",value:s.name,onChange:m=>c("name",m.target.value)}),e.jsx(E,{message:u.name,className:"text-sm font-medium"})]}),e.jsxs("div",{className:"form-item mb-4",children:[e.jsx(B,{value:"Column Key",className:"mb-1"}),e.jsx(se,{className:"w-full text-sm font-medium text-gray-600",placeholder:"Column key...",value:s.key,onChange:m=>c("key",m.target.value)}),e.jsx(E,{message:u.key,className:"text-sm font-medium"})]}),e.jsxs("div",{className:"form-item mb-4",children:[e.jsx(B,{value:"Column Input Type",className:"mb-1"}),e.jsxs("select",{className:"w-full rounded text-sm border-gray-300 shadow-sm font-medium text-gray-600 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600",value:s.input_type,onChange:m=>c("input_type",m.target.value),children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"text",children:"Text"}),e.jsx("option",{value:"date",children:"Date"}),e.jsx("option",{value:"dropdown",children:"DropDown"})]}),e.jsx(E,{message:u.input_type,className:"text-sm font-medium"})]}),(s==null?void 0:s.input_type)==="dropdown"&&e.jsxs("div",{className:"form-item mb-4",children:[e.jsx(B,{value:"Dropdown Options seprated by (|)",className:"mb-1"}),e.jsx("textarea",{className:"w-full rounded text-sm border-gray-300 shadow-sm font-normal focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600",placeholder:"Dropdown Options seprated by | ...",rows:4,value:s.options,onChange:m=>c("options",m.target.value)}),e.jsx(E,{message:u.options,className:"text-sm font-medium"})]})]}),e.jsxs(r.DialogFooter,{children:[e.jsx(r.Button,{variant:"text",color:"red",onClick:()=>a(!n),className:"mr-1 capitalize",children:e.jsx("span",{children:"Cancel"})}),e.jsx(r.Button,{variant:"gradient",color:"green",onClick:m=>g(m),className:"capitalize",loading:d,children:e.jsx("span",{children:"Submit"})})]})]})}function Ne({hideColumnDialog:n,setHideColumnDialog:a,columns:s,hidden_columns:c,deleted_columns:i}){const d=()=>a(!n),[u,h]=f.useState([]),{data:g,setData:m,post:b,processing:S,errors:k,reset:C}=q({type:"wntd",key:"hide",items:(c==null?void 0:c.length)>0?c:[]});f.useEffect(()=>{n&&h(p=>[...s.filter(P=>!i.includes(P.key)).map(P=>({key:P.key,name:P.name}))])},[n]);const w=(p,z)=>{const P=p.target.checked;m(_=>P?{..._,items:[..._.items,z]}:{..._,items:_.items.filter(I=>I!==z)})},j=p=>{p.preventDefault(),b(route("hide.columns.item"),{onSuccess:()=>{a(!1),C()}})};return e.jsxs(r.Dialog,{open:n,size:"xs",children:[e.jsx(r.DialogHeader,{children:"Hide Column"}),e.jsx(r.DialogBody,{children:e.jsxs("div",{className:"form-item",children:[e.jsx("p",{className:"text-[#333] font-semibold",children:"Please select the column you want to hide"}),e.jsx("div",{className:"form-item grid grid-cols-2",children:(u==null?void 0:u.length)>0&&u.map((p,z)=>e.jsx(J.Fragment,{children:e.jsx(r.Checkbox,{containerProps:{className:"py-3"},className:"w-5 h-5 rounded-md",label:e.jsx(r.Typography,{color:"blue-gray",className:"font-medium text-sm",children:p==null?void 0:p.name}),onChange:P=>w(P,p==null?void 0:p.key),defaultChecked:c==null?void 0:c.includes(p==null?void 0:p.key)})},z))})]})}),e.jsxs(r.DialogFooter,{children:[e.jsx(r.Button,{variant:"text",color:"red",onClick:d,className:"mr-1 capitalize",children:e.jsx("span",{children:"Cancel"})}),e.jsx(r.Button,{variant:"gradient",color:"green",onClick:p=>{j(p)},className:"capitalize",loading:S,children:e.jsx("span",{children:"Confirm"})})]})]})}function ge({renameColumnDialog:n,setRenameColumnDialog:a,columns:s,deleted_columns:c}){var k;const{data:i,setData:d,post:u,processing:h,errors:g,reset:m}=q({type:"wntd",key:"rename",items:[]});f.useEffect(()=>{n&&d(C=>{const w=[...s.filter(j=>!c.includes(j.key)).map(j=>({key:j.key,name:j.name}))];return{...C,items:w}})},[n]);const b=(C,w)=>{d(j=>({...j,items:j.items.map(p=>p.key===C?{...p,name:w}:p)}))},S=C=>{C.preventDefault(),u(route("rename.columns.item"),{onSuccess:()=>{a(!1),m()}})};return e.jsxs(r.Dialog,{open:n,size:"xs",children:[e.jsx(r.DialogHeader,{children:"Rename Columns"}),e.jsx(r.DialogBody,{className:"max-h-[42rem] overflow-scroll",children:e.jsx("div",{className:"grid grid-cols-2 gap-3",children:(i==null?void 0:i.items.length)>0&&((k=i==null?void 0:i.items)==null?void 0:k.map((C,w)=>e.jsx("div",{className:"form-item mb-2",children:e.jsx(se,{className:"w-full text-sm font-medium text-gray-600",value:C==null?void 0:C.name,onChange:j=>b(C==null?void 0:C.key,j.target.value)})},w)))})}),e.jsxs(r.DialogFooter,{children:[e.jsx(r.Button,{variant:"text",color:"red",className:"mr-1 capitalize",onClick:()=>a(!1),children:"Cancel"}),e.jsx(r.Button,{variant:"gradient",color:"green",className:"capitalize",onClick:C=>S(C),loading:h,children:"Submit"})]})]})}function we({deleteColumnDialog:n,setDeleteColumnDialog:a,columns:s,deleted_columns:c}){const{data:i,setData:d,post:u,processing:h,errors:g,reset:m}=q({type:"wntd",key:"delete",items:[]}),[b,S]=f.useState([]);f.useEffect(()=>{n&&S(w=>[...s.filter(p=>!c.includes(p.key)).map(p=>({key:p.key,name:p.name}))])},[n]);const k=(w,j)=>{const p=w.target.checked;d(z=>p?{...z,items:[...z.items,j]}:{...z,items:z.items.filter(P=>P!==j)})},C=w=>{w.preventDefault(),u(route("delete.columns.item"),{onSuccess:()=>{a(!1),m()}})};return e.jsxs(r.Dialog,{open:n,size:"xs",children:[e.jsx(r.DialogHeader,{children:"Delete Columns"}),e.jsx(r.DialogBody,{className:"max-h-[42rem] overflow-scroll",children:e.jsxs("div",{className:"form-item",children:[e.jsx("p",{className:"text-[#333] font-semibold",children:"Please select the column you want to delete."}),e.jsx("div",{className:"grid grid-cols-2",children:(b==null?void 0:b.length)>0&&b.map((w,j)=>e.jsx(J.Fragment,{children:e.jsx(r.Checkbox,{containerProps:{className:"py-3"},className:"w-5 h-5 rounded-md",label:e.jsx(r.Typography,{color:"blue-gray",className:"font-medium text-sm",children:w==null?void 0:w.name}),onChange:p=>{k(p,w==null?void 0:w.key)}})},j))})]})}),e.jsxs(r.DialogFooter,{children:[e.jsx(r.Button,{variant:"text",color:"red",className:"mr-1 capitalize",onClick:()=>a(!1),children:"Cancel"}),e.jsx(r.Button,{variant:"gradient",color:"green",className:"capitalize",onClick:w=>{C(w)},loading:h,children:"Submit"})]})]})}function Ce({arrangeColumnDialog:n,setArrangeColumnDialog:a,columns:s,deleted_columns:c}){const[i,d]=f.useState([]),[u,h]=f.useState(null),{data:g,setData:m,post:b,processing:S,errors:k,reset:C}=q({type:"wntd",key:"arrange",items:[]});f.useEffect(()=>{n&&d(_=>[...(H=>H.map((V,$)=>({...V,position:$+1})))(s.filter(H=>!c.includes(H.key)).map(H=>({key:H.key,name:H.name})))])},[n]);const w=(_,I)=>{h(I)},j=()=>{h(null)},p=_=>{_.preventDefault()},z=(_,I)=>{if(!u)return;const A=i.indexOf(u),H=i.indexOf(I);if(A!==-1&&H!==-1){const $=[...(M=>M.map((l,v)=>({...l,position:v+1})))(i)],[W]=$.splice(A,1);$.splice(H,0,W);const L=$.map((M,l)=>({...M,position:l+1}));d(L);const U=L.map(M=>({key:M.key,position:M.position}));m("items",U)}},P=_=>{_.preventDefault(),b(route("rearrange.columns.item"),{onSuccess:()=>{a(!1),C()}})};return e.jsxs(r.Dialog,{open:n,size:"xs",children:[e.jsx(r.DialogHeader,{children:"Re-arrange Columns"}),e.jsxs(r.DialogBody,{className:"max-h-[42rem] overflow-scroll",children:[e.jsx("p",{className:"text-[#333] font-semibold mb-3",children:"Please drag and drop the column you want to arrange."}),e.jsx("div",{className:"draggable-wrapper border rounded-md py-2",children:(i==null?void 0:i.length)>0&&(i==null?void 0:i.map((_,I)=>e.jsx("div",{className:"text-gray-600 font-medium py-1 px-2 text-sm  cursor-move",draggable:"true",onDragStart:A=>w(A,_),onDragEnd:j,onDragOver:p,onDrop:A=>z(A,_),children:e.jsxs("div",{className:"flex items-center gap-3 border py-2 px-2 rounded-md ",children:[e.jsx("div",{className:"icon-wrapper",children:e.jsx(he,{strokeWidth:1.5,size:18})}),_.name]})},I)))})]}),e.jsxs(r.DialogFooter,{children:[e.jsx(r.Button,{variant:"text",color:"red",className:"mr-1 capitalize",onClick:()=>a(!1),children:"cancel"}),e.jsx(r.Button,{variant:"gradient",color:"green",className:"capitalize",onClick:_=>P(_),loading:S,children:"Submit"})]})]})}function ke({columns:n,hidden_columns:a,deleted_columns:s}){const[c,i]=f.useState(!1),[d,u]=f.useState(!1),[h,g]=f.useState(!1),[m,b]=f.useState(!1),[S,k]=f.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(r.Menu,{children:[e.jsx(r.MenuHandler,{children:e.jsx(r.Button,{variant:"gradient",size:"sm",className:"capitalize",children:"Column Options"})}),e.jsxs(r.MenuList,{className:"font-semibold text-gray-600",children:[e.jsx(r.MenuItem,{onClick:()=>{i(!0)},children:"Add Column"}),e.jsx(r.MenuItem,{onClick:()=>{u(!0)},children:"Show/Hide Columns"}),e.jsx(r.MenuItem,{onClick:()=>{g(!0)},children:"Rename Columns"}),e.jsx(r.MenuItem,{onClick:()=>{k(!0)},children:"Rearrange Columns"}),e.jsx(r.MenuItem,{onClick:()=>{b(!0)},className:"text-red-500",children:"Delete Columns"})]})]}),e.jsx(be,{addColumnDialog:c,setAddColumnDialog:i}),e.jsx(Ne,{hideColumnDialog:d,setHideColumnDialog:u,columns:n,hidden_columns:a,deleted_columns:s}),e.jsx(ge,{renameColumnDialog:h,setRenameColumnDialog:g,columns:n,deleted_columns:s}),e.jsx(we,{deleteColumnDialog:m,setDeleteColumnDialog:b,columns:n,deleted_columns:s}),e.jsx(Ce,{arrangeColumnDialog:S,setArrangeColumnDialog:k,columns:n,deleted_columns:s})]})}function Se({mappingDialog:n,setMappingDialog:a,mappingData:s,setBatchId:c}){var z,P,_,I,A,H,V,$,W,L,U,M;const i=()=>a(!n),[d,u]=f.useState({file_path:s?s==null?void 0:s.filePath:"",loc_id:"",wntd:"",imsi:"",version:"",avc:"",bw_profile:"",lon:"",lat:"",site_name:"",home_cell:"",home_pci:"",traffic_profile:""}),[h,g]=f.useState({}),[m,b]=f.useState(!1),[S,k]=f.useState(""),[C,w]=f.useState(""),j=(l,v)=>{u(K=>({...K,[l]:v}))};f.useEffect(()=>{j("file_path",s!=null&&s.filePath?s==null?void 0:s.filePath:"")},[s]);const p=async l=>{var K,Z,D,Q,X,ee;l.preventDefault();let v={};if(["loc_id","wntd","imsi","version","avc","bw_profile","lon","lat","site_name","home_cell","home_pci","traffic_profile"].forEach(T=>{d[T]||(v[T]="This field is required.")}),g(v),Object.keys(v).length>0){console.log(v);return}try{b(!0);const T=await te.post(route("wireless.sites.map.save"),d);T!=null&&T.data&&(w((Z=(K=T==null?void 0:T.data)==null?void 0:K.success)==null?void 0:Z.message),c((D=T==null?void 0:T.data)==null?void 0:D.batch_id),setTimeout(()=>{a(!1),w(""),k("")},3e3),Y.visit(route("wireless.sites.index")))}catch(T){console.log("error:",T),k(`${(ee=(X=(Q=T==null?void 0:T.response)==null?void 0:Q.data)==null?void 0:X.error)==null?void 0:ee.message}`)}finally{b(!1)}};return e.jsx(J.Fragment,{children:e.jsxs(r.Dialog,{open:n,size:"xs",children:[e.jsx(r.DialogHeader,{children:"CSV Mapping"}),S&&e.jsx("p",{className:"text-red-500 font-medium text-[12px] px-4",children:S}),C&&e.jsx("p",{className:"text-green-500 font-medium text-[12px] px-4",children:C}),e.jsxs(r.DialogBody,{className:"px-6 overflow-scroll",children:[e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{value:"LOCID",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:d.loc_id,onChange:l=>j("loc_id",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((z=s==null?void 0:s.header)==null?void 0:z.length)>0&&(s==null?void 0:s.header.map((l,v)=>e.jsx("option",{value:l,children:l},v)))]}),e.jsx(E,{message:h.loc_id,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{value:"WNTD",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:d.wntd,onChange:l=>j("wntd",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((P=s==null?void 0:s.header)==null?void 0:P.length)>0&&(s==null?void 0:s.header.map((l,v)=>e.jsx("option",{value:l,children:l},v)))]}),e.jsx(E,{message:h.wntd,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{value:"IMSI",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:d.imsi,onChange:l=>j("imsi",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((_=s==null?void 0:s.header)==null?void 0:_.length)>0&&(s==null?void 0:s.header.map((l,v)=>e.jsx("option",{value:l,children:l},v)))]}),e.jsx(E,{message:h.imsi,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{value:"VERSION",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:d.version,onChange:l=>j("version",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((I=s==null?void 0:s.header)==null?void 0:I.length)>0&&(s==null?void 0:s.header.map((l,v)=>e.jsx("option",{value:l,children:l},v)))]}),e.jsx(E,{message:h.version,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{value:"AVC",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:d.avc,onChange:l=>j("avc",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((A=s==null?void 0:s.header)==null?void 0:A.length)>0&&(s==null?void 0:s.header.map((l,v)=>e.jsx("option",{value:l,children:l},v)))]}),e.jsx(E,{message:h.avc,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{value:"BW Profile",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:d.bw_profile,onChange:l=>j("bw_profile",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((H=s==null?void 0:s.header)==null?void 0:H.length)>0&&(s==null?void 0:s.header.map((l,v)=>e.jsx("option",{value:l,children:l},v)))]}),e.jsx(E,{message:h.bw_profile,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{value:"Lon",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:d.lon,onChange:l=>j("lon",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((V=s==null?void 0:s.header)==null?void 0:V.length)>0&&(s==null?void 0:s.header.map((l,v)=>e.jsx("option",{value:l,children:l},v)))]}),e.jsx(E,{message:h.lon,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{value:"Lat",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:d.lat,onChange:l=>j("lat",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),(($=s==null?void 0:s.header)==null?void 0:$.length)>0&&(s==null?void 0:s.header.map((l,v)=>e.jsx("option",{value:l,children:l},v)))]}),e.jsx(E,{message:h.lat,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{value:"SiteName",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:d.site_name,onChange:l=>j("site_name",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((W=s==null?void 0:s.header)==null?void 0:W.length)>0&&(s==null?void 0:s.header.map((l,v)=>e.jsx("option",{value:l,children:l},v)))]}),e.jsx(E,{message:h.site_name,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{value:"HomeCell",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:d.home_cell,onChange:l=>j("home_cell",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((L=s==null?void 0:s.header)==null?void 0:L.length)>0&&(s==null?void 0:s.header.map((l,v)=>e.jsx("option",{value:l,children:l},v)))]}),e.jsx(E,{message:h.home_cell,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{value:"HomePCI",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:d.home_pci,onChange:l=>j("home_pci",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((U=s==null?void 0:s.header)==null?void 0:U.length)>0&&(s==null?void 0:s.header.map((l,v)=>e.jsx("option",{value:l,children:l},v)))]}),e.jsx(E,{message:h.home_pci,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{value:"Traffic_Profile",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:d.traffic_profile,onChange:l=>j("traffic_profile",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((M=s==null?void 0:s.header)==null?void 0:M.length)>0&&(s==null?void 0:s.header.map((l,v)=>e.jsx("option",{value:l,children:l},v)))]}),e.jsx(E,{message:h.traffic_profile,className:"!text-[12px] font-medium"})]})]})})]}),e.jsxs(r.DialogFooter,{children:[e.jsx(r.Button,{variant:"text",color:"red",onClick:i,className:"mr-1",disabled:m,children:e.jsx("span",{children:"Cancel"})}),e.jsx(r.Button,{variant:"gradient",color:"green",onClick:p,loading:m,children:e.jsx("span",{children:"Confirm"})})]})]})})}function _e({site_id:n,changedItems:a,setChangedItems:s}){const[c,i]=f.useState(!1),d=async u=>{var h,g,m;if(a.length>0){let b=a.filter(S=>S.site_id===u)[0];if(b){i(!0);const S=await axios.post(route("wireless.sites.save.item"),{site_id:b==null?void 0:b.site_id,location_id:b==null?void 0:b.loc_id,items:b==null?void 0:b.items});(h=S==null?void 0:S.data)!=null&&h.success&&(i(!1),G.success((m=(g=S==null?void 0:S.data)==null?void 0:g.success)==null?void 0:m.message),s(k=>k.filter(C=>C.site_id!==u)))}}};return e.jsx(r.Button,{size:"sm",className:"capitalize py-1 px-2 rounded font-semibold",disabled:!a.some(u=>u.site_id===n),onClick:()=>{d(n)},loading:c,children:"Save"})}function Ie({site_id:n}){const{processing:a,delete:s}=q(),[c,i]=f.useState(!1),d={onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1)},u=()=>{s(route("wireless.sites.destroy",n),{preserveScroll:!0,onSuccess:()=>{Y.visit(route("wireless.sites.index"))}})};return e.jsx(J.Fragment,{children:e.jsxs(r.Popover,{placement:"top-end",open:c,handler:i,children:[e.jsx(r.PopoverHandler,{...d,children:e.jsx(r.Button,{variant:"gradient",color:"red",size:"sm",className:"capitalize py-1 px-2 rounded",onClick:()=>setOpen(!0),children:e.jsx(ne,{size:14})})}),e.jsxs(r.PopoverContent,{...d,className:"px-3",children:[e.jsx(r.Typography,{variant:"h6",className:"text-center",children:"Are you sure?"}),e.jsx(r.Typography,{variant:"small",className:"font-normal",children:"This cannot be reverted back."}),e.jsxs("div",{className:"mt-2 flex justify-between",children:[e.jsx(r.Button,{variant:"text",color:"red",size:"sm",className:"capitalize rounded",onClick:()=>i(!1),children:"Cancel"}),e.jsx(r.Button,{variant:"gradient",color:"red",size:"sm",className:"capitalize rounded",onClick:u,children:"Delete"})]})]})]})})}function Te({name:n,handleItemOnChange:a}){const[s,c]=f.useState(""),i=d=>{c(d),a(n,d)};return e.jsx("div",{className:"w-full h-full",children:e.jsx("textarea",{className:"border-none focus:ring-0 bg-transparent !shadow-none text-[12px] font-medium w-full",rows:1,value:s,onChange:d=>{i(d.target.value)}})})}function Pe({name:n,handleItemOnChange:a}){const[s,c]=f.useState(""),i=d=>{c(d),a(n,d)};return e.jsx("div",{className:"w-full h-full",children:e.jsx(oe,{selected:s,onChange:d=>i(d),className:"border-none focus:ring-0 w-full bg-transparent !shadow-none text-[12px] font-medium",dateFormat:"dd/MM/yyyy"})})}function ze({name:n,handleItemOnChange:a,options:s}){const[c,i]=f.useState(""),d=u=>{i(u),a(n,u)};return e.jsx("div",{className:"w-full h-full min-w-32",children:e.jsxs("select",{value:c,onChange:u=>{d(u.target.value)},className:"border-none focus:ring-0 w-full bg-transparent !shadow-none text-[12px] font-medium px-1",children:[e.jsx("option",{value:"",children:"Select"}),(s==null?void 0:s.length)>0&&s.map((u,h)=>e.jsx("option",{value:u.value,children:u.label},h))]})})}function Oe(){return e.jsx("div",{})}const Be={text:Te,date:Pe,dropdown:ze,upload:Oe};function Ee({item:n,handleItemOnChange:a}){const s=Be[n.input_type?n.input_type:"text"],c={status:[{label:"In Progress",value:"in_progress"},{label:"Not Started",value:"not_started"},{label:"Completed",value:"completed"}],solution_type:[{label:"Device Upgrade",value:"device_upgrade"},{label:"Reparent",value:"reparent"},{label:"Repan",value:"repan"},{label:"Opti Type 1",value:"opti_type_1"},{label:"Opti Type 5",value:"opti_type_5"},{label:"Opti Type 6",value:"opti_type_6"},{label:"EPO",value:"epo"}]};return e.jsx(s,{name:n.key,options:c[n.key],handleItemOnChange:a})}function He({tableHeader:n,setAddNewRow:a}){const{data:s,setData:c,post:i,processing:d,errors:u,reset:h}=q({newItem:{}});console.log(s);const g=(S,k)=>{const C={...s.newItem};c("newItem",{...C,[S]:k})},m=()=>{c("newItem",{}),a(!1)},b=()=>{if(!(s!=null&&s.newItem.loc_id))return G.error("LocId is required");i(route("wireless.sites.add.row"),{preserveScroll:!0,onSuccess:()=>{a(!1),G.success("Row Added successfully")}})};return e.jsxs("tr",{className:"border-b",children:[(n==null?void 0:n.length)>0&&n.map((S,k)=>e.jsx("td",{className:"border-l h-10 text-[12px] font-medium ps-2",children:e.jsx(Ee,{item:S,handleItemOnChange:g})},k)),e.jsx("td",{className:"border-l h-10 px-3",children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx(r.Button,{variant:"gradient",size:"sm",className:"capitalize py-1 px-2 rounded font-semibold",onClick:b,children:"Save"}),e.jsx(r.Button,{variant:"gradient",color:"red",size:"sm",className:"capitalize py-1 px-2 rounded",onClick:m,children:e.jsx(ne,{size:14})})]})})]})}function Re({siteId:n,locId:a,name:s,value:c,handleEditAbleItem:i}){const[d,u]=f.useState(c||""),h=g=>{u(g),i(n,a,s,g)};return e.jsx("div",{className:"w-full h-full",children:e.jsx("textarea",{className:"border-none focus:ring-0 bg-transparent !shadow-none text-[12px] font-medium w-full",value:s==="imsi"?parseFloat(d):d,rows:1,onChange:g=>{h(g.target.value)}})})}function Fe({siteId:n,locId:a,name:s,value:c,handleEditAbleItem:i}){const[d,u]=f.useState(c||""),h=g=>{u(g),i(n,a,s,g)};return e.jsx("div",{className:"w-full h-full",children:e.jsx(oe,{selected:d,onChange:g=>h(g),className:"border-none focus:ring-0 w-full bg-transparent !shadow-none text-[12px] font-medium",dateFormat:"dd/MM/yyyy"})})}function Me({siteId:n,locId:a,name:s,value:c,options:i,handleEditAbleItem:d}){const[u,h]=f.useState(c||""),g=m=>{h(m),d(n,a,s,m)};return e.jsx("div",{className:"w-full h-full min-w-32",children:e.jsxs("select",{value:u,onChange:m=>{g(m.target.value)},className:"border-none focus:ring-0 w-full bg-transparent !shadow-none text-[12px] font-medium px-1",children:[e.jsx("option",{value:"",children:"Select"}),(i==null?void 0:i.length)>0&&i.map((m,b)=>e.jsx("option",{value:m.value,children:m.label},b))]})})}const Ae={text:Re,date:Fe,dropdown:Me,upload:ye};function $e({item:n,site:a,handleEditAbleItem:s}){const c=Ae[n.input_type],i={status:[{label:"In Progress",value:"in_progress"},{label:"Not Started",value:"not_started"},{label:"Completed",value:"completed"}],solution_type:[{label:"Device Upgrade",value:"device_upgrade"},{label:"Reparent",value:"reparent"},{label:"Repan",value:"repan"},{label:"Opti Type 1",value:"opti_type_1"},{label:"Opti Type 5",value:"opti_type_5"},{label:"Opti Type 6",value:"opti_type_6"},{label:"EPO",value:"epo"}]};return e.jsx(c,{siteId:a==null?void 0:a.id,locId:a==null?void 0:a.loc_id,name:n.key,value:n.value,handleEditAbleItem:s,options:i[n.key]})}function De({auth:n,sites:a,get_data:s,batch:c,additional_columns:i,hidden_columns:d,renamed_columns:u,deleted_columns:h,arrange_columns:g}){var re;const{role:m}=n,b=[{name:"LOCID",sortable:!0,key:"loc_id",position:1,editable:!1},{name:"WNTD",sortable:!0,key:"wntd",position:2,editable:!0,input_type:"text"},{name:"IMSI",sortable:!0,key:"imsi",position:3,editable:!0,input_type:"text"},{name:"VERSION",sortable:!0,key:"version",position:4,editable:!0,input_type:"text"},{name:"AVC",sortable:!0,key:"avc",position:5,editable:!0,input_type:"text"},{name:"BW Profile",sortable:!0,key:"bw_profile",position:6,editable:!0,input_type:"text"},{name:"Lon",sortable:!0,key:"lon",position:7,editable:!0,input_type:"text"},{name:"Lat",sortable:!0,key:"lat",position:8,editable:!0,input_type:"text"},{name:"SiteName",sortable:!0,key:"site_name",position:9,editable:!0,input_type:"text"},{name:"HomeCell",sortable:!0,key:"home_cell",position:10,editable:!0,input_type:"text"},{name:"HomePCI",sortable:!0,key:"home_pci",position:11,editable:!0,input_type:"text"},{name:"Traffic Profile",sortable:!0,key:"traffic_profile",position:12,editable:!0,input_type:"text"},{name:"Start Date",sortable:!1,key:"start_date",position:13,editable:!0,input_type:"date"},{name:"End Date",sortable:!1,key:"end_date",position:14,editable:!0,input_type:"date"},{name:"Solution Type",sortable:!1,key:"solution_type",position:15,editable:!0,input_type:"dropdown"},{name:"Status",sortable:!1,key:"status",position:16,editable:!0,input_type:"dropdown"},{name:"Remarks",sortable:!1,key:"remarks",position:17,editable:!0,input_type:"text"},{name:"Artifacts",sortable:!1,key:"artifacts",position:18,editable:!0,input_type:"upload"}];function S(o,N){return o==null?N:N==null?o:[...new Set([...o,...N])]}const k=S(d,h);function C(){const o=[...b],N=i==null?void 0:i.map(x=>({...x,editable:!0})),t=(x,y)=>x.position!==void 0&&y.position!==void 0?x.position-y.position:x.position!==void 0?-1:y.position!==void 0?1:0;return u&&(o.forEach(x=>{const y=u.find(F=>F.key===x.key);y&&(x.name=y.name)}),N.forEach(x=>{const y=u.find(F=>F.key===x.key);y&&(x.name=y.name)})),k&&(o.forEach(x=>{k.find(F=>F===x.key)&&(x.hidden=!0)}),N.forEach(x=>{k.find(F=>F===x.key)&&(x.hidden=!0)})),g&&(o.forEach(x=>{const y=g.find(F=>F.key===x.key);y&&(x.position=y.position)}),N.forEach(x=>{const y=g.find(F=>F.key===x.key);y&&(x.position=y.position)})),[...o,...N].sort(t)}const w=C(),j=f.useRef(null),[p,z]=f.useState(s!=null&&s.search?s==null?void 0:s.search:""),[P,_]=f.useState(s!=null&&s.per_page?s==null?void 0:s.per_page:10),[I]=f.useState(a),[A,H]=f.useState(!1),[V,$]=f.useState(""),[W,L]=f.useState(null),[U,M]=f.useState([]),[l,v]=f.useState(!1),K=o=>{j.current.click()},Z=async o=>{var t,O,R;const N=new FormData;N.append("import_file",o.target.files[0]);try{const x=await te.post(route("wireless.sites.import"),N);x!=null&&x.data&&($(x==null?void 0:x.data),H(!0))}catch(x){G.error(`${(R=(O=(t=x==null?void 0:x.response)==null?void 0:t.data)==null?void 0:O.error)==null?void 0:R.message}`)}},D=async()=>{Y.get(route("wireless.sites.index",{search:p}))},Q=async(o,N)=>{Y.get(route("wireless.sites.index",{order_by:o,order:N}))},X=async(o,N)=>{Y.get(route("wireless.sites.index",{filter_by:o,value:N}))},ee=o=>{_(o),Y.get(route("wireless.sites.index",{...s,per_page:o}))};f.useEffect(()=>{c!=null&&c.batch_site_id&&L(c==null?void 0:c.batch_site_id)},[]),f.useEffect(()=>{const o=async()=>{var t,O,R;try{let x=0;const y=await te.get(route("import.progress",{batchId:W}));if(y!=null&&y.data){let F=parseInt((t=y==null?void 0:y.data)==null?void 0:t.total_jobs),ie=parseInt((O=y==null?void 0:y.data)==null?void 0:O.pending_jobs),de=F-ie;parseInt((R=y==null?void 0:y.data)==null?void 0:R.failed_jobs)>0?clearInterval(N):(x=parseInt(de/F*100).toFixed(0),x<100?G.loading(`CSV Data Import Progress: ${x}%.
 Please wait....`,{id:"loading-toast",style:{backgroundColor:"#424242",color:"#ffffff",fontSize:14,borderRadius:4,fontWeight:"bold"}}):(G.dismiss("loading-toast"),clearInterval(N)))}}catch(x){console.log(x)}},N=setInterval(()=>{W&&o()},5e3);return()=>clearInterval(N)},[W]);const T=(o,N,t,O)=>{const R=U.findIndex(x=>x.site_id===o&&x.loc_id===N);M(R!==-1?x=>{const y=[...x];return y[R]={...y[R],items:{...y[R].items,[t]:O}},y}:x=>[...x,{site_id:o,loc_id:N,items:{[t]:O}}])},ae=o=>{let N=[];return w.forEach(t=>{const O=t.key,R=o[O];R!==void 0?t!=null&&t.position?N[t.position-1]={key:O,value:R,editable:t==null?void 0:t.editable,input_type:t!=null&&t.input_type?t==null?void 0:t.input_type:""}:N.push({key:O,value:R,editable:t==null?void 0:t.editable,input_type:t!=null&&t.input_type?t==null?void 0:t.input_type:""}):N.push({key:O,value:"",editable:t==null?void 0:t.editable,input_type:t!=null&&t.input_type?t==null?void 0:t.input_type:""})}),N};return e.jsxs(ue,{user:n==null?void 0:n.user,children:[e.jsx(ce,{title:"WNTD"}),e.jsx("div",{className:"top-section p-4",children:e.jsxs("div",{className:"bg-white shadow rounded py-3 px-5 flex justify-between items-center",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"",children:[e.jsx(r.Typography,{variant:"h3",className:"tracking-tight",children:"WNTD"}),e.jsxs("ul",{className:"flex gap-1 text-gray-600 text-sm",children:[e.jsx("li",{children:e.jsx(le,{href:route("dashboard"),children:"Dashboard"})}),e.jsx("li",{children:"/"}),e.jsx("li",{children:e.jsx(le,{href:route("wireless.sites.index"),children:"WNTD"})})]})]})}),e.jsx("div",{className:"filter-wrapper md:px-4",children:e.jsxs("div",{className:"flex filter-details justify-end gap-2",children:[e.jsxs("div",{className:"search-wrapper w-1/5 flex relative",children:[e.jsx(se,{placeholder:"Search...",className:"w-full text-sm rounded-md rounded-r-none border-r-0 focus:ring-0 h-8",value:p,onChange:o=>z(o.target.value)}),e.jsx("div",{className:"search-icon",children:e.jsx(r.IconButton,{size:"sm",className:"rounded-l-none",onClick:D,children:e.jsx(me,{color:"white",size:18})})})]}),e.jsx("div",{className:"status-filter",children:e.jsxs("select",{className:"w-52 text-sm rounded-md focus:ring-0 h-8 border-gray-300 py-1 text-gray-600 font-medium",onChange:o=>X("status",o.target.value),value:(s==null?void 0:s.filter_by)==="status"?s==null?void 0:s.value:"",children:[e.jsx("option",{value:"",children:"Filter by Status"}),e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"not_started",children:"Not Started"}),e.jsx("option",{value:"completed",children:"Completed"})]})}),e.jsx("div",{className:"filter-solution-type",children:e.jsxs("select",{className:"w-52 text-sm rounded-md focus:ring-0 h-8 border-gray-300 py-1 text-gray-600 font-medium",onChange:o=>X("solution_type",o.target.value),value:(s==null?void 0:s.filter_by)==="solution_type"?s==null?void 0:s.value:"",children:[e.jsx("option",{value:"",children:"Filter by Solution Type"}),e.jsx("option",{value:"device_upgrade",children:"Device Upgrade"}),e.jsx("option",{value:"reparent",children:"Reparent"}),e.jsx("option",{value:"repan",children:"Repan"}),e.jsx("option",{value:"opti_type_1",children:"Opti Type 1"}),e.jsx("option",{value:"opti_type_5",children:"Opti Type 5"}),e.jsx("option",{value:"opti_type_6",children:"Opti Type 6"}),e.jsx("option",{value:"epo",children:"EPO"})]})}),m==="super-admin"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"import-type-field",children:[e.jsx(r.Button,{variant:"gradient",className:"capitalize",size:"sm",onClick:K,children:"Import from CSV"}),e.jsx("input",{type:"file",onChange:Z,ref:j,style:{display:"none"}})]}),e.jsx(ke,{columns:w,hidden_columns:d,deleted_columns:h||[]}),e.jsx(pe,{type:"wntd"})]}),e.jsx(ve,{route_name:"wireless.sites.export",file_name:"WNTD_Export"})]})})]})}),e.jsxs("div",{className:"content mt-6",children:[e.jsxs(r.Card,{className:"h-full w-full rounded-none",children:[e.jsxs("div",{className:"overflow-x-auto overflow-hidden",children:[e.jsxs("table",{className:"w-full table-auto",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[w.map(o=>e.jsx("th",{className:`border-y border-blue-gray-100 bg-blue-gray-50/50 p-2 border-l cursor-pointer ${k!=null&&k.includes(o==null?void 0:o.key)?"hidden":""}`,children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx(r.Typography,{variant:"small",className:"leading-none text-gray-800 font-medium text-sm",children:o.name}),(o==null?void 0:o.sortable)&&e.jsxs("div",{className:"relative mt-1",children:[e.jsx("span",{className:"absolute -top-2 right-0 hover:bg-blue-gray-100 rounded-sm",children:e.jsx(fe,{size:12,strokeWidth:2,onClick:()=>{Q(o.key,"asc")}})}),e.jsx("span",{className:"absolute -bottom-1 right-0 hover:bg-blue-gray-100 rounded-sm",children:e.jsx(xe,{size:12,strokeWidth:2,onClick:()=>{Q(o.key,"desc")}})})]})]})},o.name)),e.jsx("th",{className:"border-y border-blue-gray-100 bg-blue-gray-50/50 p-2 border-l cursor-pointer"})]})}),e.jsxs("tbody",{children:[I==null?void 0:I.data.map(o=>{const N=ae(o);return e.jsxs("tr",{className:"even:bg-blue-gray-50/50",children:[N==null?void 0:N.map((t,O)=>e.jsx(J.Fragment,{children:e.jsx("td",{className:`border-l h-10 text-[12px] font-medium ps-1 ${k!=null&&k.includes(t==null?void 0:t.key)?"hidden":""}`,children:(t==null?void 0:t.key)==="loc_id"?e.jsx(le,{href:route("wireless.show.location.index",o==null?void 0:o.id),className:"font-semibold underline",children:t==null?void 0:t.value}):e.jsx(J.Fragment,{children:t!=null&&t.editable?e.jsx($e,{item:t,site:o,handleEditAbleItem:T}):e.jsx(J.Fragment,{children:(t==null?void 0:t.key)==="imsi"?parseFloat(t==null?void 0:t.value):t==null?void 0:t.value})})})},O)),e.jsx("td",{className:"border-l h-10 px-3",children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx(_e,{site_id:o==null?void 0:o.id,changedItems:U,setChangedItems:M}),e.jsx(Ie,{site_id:o==null?void 0:o.id})]})})]},o==null?void 0:o.id)}),l&&e.jsx(He,{tableHeader:w,setAddNewRow:v})]})]}),((re=I==null?void 0:I.data)==null?void 0:re.length)===0&&e.jsx(r.Typography,{variant:"h6",color:"blue-gray",className:"text-center py-6",children:"No data found"})]}),e.jsxs("div",{className:"pagination flex justify-between items-center",children:[e.jsx("div",{className:"px-4",children:e.jsx(r.Button,{variant:"gradient",size:"sm",className:"capitalize rounded text-sm",onClick:()=>{v(!0)},children:"Add New Row"})}),e.jsxs("div",{className:"md:flex grid justify-start md:justify-end items-center pt-6 mb-8 gap-3 px-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-sm font-medium",children:"Rows per Page"}),e.jsxs("select",{className:"rounded-md text-sm font-medium border-gray-400 focus:ring-0 py-2",value:P,onChange:o=>{ee(o.target.value)},children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"15",children:"15"}),e.jsx("option",{value:"20",children:"20"}),e.jsx("option",{value:"20",children:"25"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"all",children:"All"})]})]}),e.jsx("div",{className:"text-sm font-medium",children:`${a==null?void 0:a.from}-${a==null?void 0:a.to} of ${a==null?void 0:a.total} Records`}),e.jsx(je,{links:I==null?void 0:I.links,perPage:P})]})]})]}),e.jsx(Se,{mappingDialog:A,setMappingDialog:H,mappingData:V,setBatchId:L})]})]})}export{De as default};
