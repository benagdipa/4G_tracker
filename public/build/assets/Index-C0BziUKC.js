import{W as G,j as e,r as x,R as re,b as ce,y as D,u as te,c as de,i as ue,k as oe,l as me,Y as je,a as ae}from"./app-ZJVYOzKk.js";import{r}from"./index-BO9AAvUu.js";import{_ as ee,A as Ne}from"./AuthenticatedLayout-GSa4eCUk.js";import{T as ne}from"./TextInput-DFfTxzug.js";import{I as H}from"./InputLabel-B7_h9EBA.js";import{I as T}from"./InputError-B8r5CHVD.js";import{M as ve,T as fe,P as ge}from"./Pagination-CClk5t2G.js";import{E as we,P as ye}from"./ExportButton-BbxaXnkV.js";import{A as he}from"./index.esm-iTnSNEIC.js";import{U as Ce}from"./UploadItem-C3J0ZV3g.js";import"./transition-BEG0F1zu.js";import"./ApplicationLogo-bjSOslKc.js";import"./index-CTsDG5iv.js";import"./download-tJrqdE6T.js";function be({addColumnDialog:a,setAddColumnDialog:o}){const{data:s,setData:u,post:d,processing:f,errors:m,reset:j}=G({type:"wntd",name:"",key:"",input_type:"",options:""}),A=g=>{g.preventDefault(),d(route("additional.columns.save.item"),{onSuccess:()=>{o(!1),j()}})};return e.jsxs(r.Dialog,{open:a,size:"xs",children:[e.jsx(r.DialogHeader,{children:"Add New Column"}),e.jsxs(r.DialogBody,{children:[e.jsxs("div",{className:"form-item mb-4",children:[e.jsx(H,{value:"Column Name",className:"mb-1"}),e.jsx(ne,{className:"w-full text-sm font-medium text-gray-600",placeholder:"Column Name...",value:s.name,onChange:g=>u("name",g.target.value)}),e.jsx(T,{message:m.name,className:"text-sm font-medium"})]}),e.jsxs("div",{className:"form-item mb-4",children:[e.jsx(H,{value:"Column Key",className:"mb-1"}),e.jsx(ne,{className:"w-full text-sm font-medium text-gray-600",placeholder:"Column key...",value:s.key,onChange:g=>u("key",g.target.value)}),e.jsx(T,{message:m.key,className:"text-sm font-medium"})]}),e.jsxs("div",{className:"form-item mb-4",children:[e.jsx(H,{value:"Column Input Type",className:"mb-1"}),e.jsxs("select",{className:"w-full rounded text-sm border-gray-300 shadow-sm font-medium text-gray-600 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600",value:s.input_type,onChange:g=>u("input_type",g.target.value),children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"text",children:"Text"}),e.jsx("option",{value:"date",children:"Date"}),e.jsx("option",{value:"dropdown",children:"DropDown"})]}),e.jsx(T,{message:m.input_type,className:"text-sm font-medium"})]}),(s==null?void 0:s.input_type)==="dropdown"&&e.jsxs("div",{className:"form-item mb-4",children:[e.jsx(H,{value:"Dropdown Options seprated by (|)",className:"mb-1"}),e.jsx("textarea",{className:"w-full rounded text-sm border-gray-300 shadow-sm font-normal focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600",placeholder:"Dropdown Options seprated by | ...",rows:4,value:s.options,onChange:g=>u("options",g.target.value)}),e.jsx(T,{message:m.options,className:"text-sm font-medium"})]})]}),e.jsxs(r.DialogFooter,{children:[e.jsx(r.Button,{variant:"text",color:"red",onClick:()=>o(!a),className:"mr-1 capitalize",children:e.jsx("span",{children:"Cancel"})}),e.jsx(r.Button,{variant:"gradient",color:"green",onClick:g=>A(g),className:"capitalize",loading:f,children:e.jsx("span",{children:"Submit"})})]})]})}function pe({hideColumnDialog:a,setHideColumnDialog:o,columns:s,hidden_columns:u,deleted_columns:d}){const f=()=>o(!a),[m,j]=x.useState([]),{data:A,setData:g,post:N,processing:C,errors:y,reset:p}=G({type:"wntd",key:"hide",items:(u==null?void 0:u.length)>0?u:[],names:[]});x.useEffect(()=>{a&&j(c=>[...s])},[a]);const w=(c,I,F)=>{const P=c.target.checked;g(k=>{var O,z;return P?{...k,items:[...k.items,I],names:[...k.names,F]}:{...k,items:(O=k==null?void 0:k.items)==null?void 0:O.filter(M=>M!==I),names:(z=k==null?void 0:k.names)==null?void 0:z.filter(M=>M!==F)}})},h=c=>{c.preventDefault(),N(route("hide.columns.item"),{onSuccess:()=>{o(!1),p()}})};return console.log(m),e.jsxs(r.Dialog,{open:a,size:"xs",children:[e.jsx(r.DialogHeader,{children:"Hide Column"}),e.jsx(r.DialogBody,{children:e.jsxs("div",{className:"form-item",children:[e.jsx("p",{className:"text-[#333] font-semibold",children:"Please select the column you want to hide"}),e.jsx("div",{className:"form-item grid grid-cols-2",children:(m==null?void 0:m.length)>0&&m.map((c,I)=>e.jsx(re.Fragment,{children:c!=null&&c.headerName?e.jsx(r.Checkbox,{containerProps:{className:"py-3"},className:"w-5 h-5 rounded-md",label:e.jsx(r.Typography,{color:"blue-gray",className:"font-medium text-sm",children:c==null?void 0:c.headerName}),onChange:F=>w(F,c==null?void 0:c.field,c==null?void 0:c.headerName),defaultChecked:u==null?void 0:u.includes(c==null?void 0:c.field)}):null},I))})]})}),e.jsxs(r.DialogFooter,{children:[e.jsx(r.Button,{variant:"text",color:"red",onClick:f,className:"mr-1 capitalize",children:e.jsx("span",{children:"Cancel"})}),e.jsx(r.Button,{variant:"gradient",color:"green",onClick:c=>{h(c)},className:"capitalize",loading:C,children:e.jsx("span",{children:"Confirm"})})]})]})}function Se({renameColumnDialog:a,setRenameColumnDialog:o,columns:s,deleted_columns:u}){var y;const{data:d,setData:f,post:m,processing:j,errors:A,reset:g}=G({type:"wntd",key:"rename",items:[]});x.useEffect(()=>{a&&f(p=>{const w=[...s.filter(h=>!u.includes(h.key)).map(h=>({key:h.key,name:h.name}))];return{...p,items:w}})},[a]);const N=(p,w)=>{f(h=>({...h,items:h.items.map(c=>c.key===p?{...c,name:w}:c)}))},C=p=>{p.preventDefault(),m(route("rename.columns.item"),{onSuccess:()=>{o(!1),g()}})};return e.jsxs(r.Dialog,{open:a,size:"xs",children:[e.jsx(r.DialogHeader,{children:"Rename Columns"}),e.jsx(r.DialogBody,{className:"max-h-[42rem] overflow-scroll",children:e.jsx("div",{className:"grid grid-cols-2 gap-3",children:(d==null?void 0:d.items.length)>0&&((y=d==null?void 0:d.items)==null?void 0:y.map((p,w)=>e.jsx("div",{className:"form-item mb-2",children:e.jsx(ne,{className:"w-full text-sm font-medium text-gray-600",value:p==null?void 0:p.name,onChange:h=>N(p==null?void 0:p.key,h.target.value)})},w)))})}),e.jsxs(r.DialogFooter,{children:[e.jsx(r.Button,{variant:"text",color:"red",className:"mr-1 capitalize",onClick:()=>o(!1),children:"Cancel"}),e.jsx(r.Button,{variant:"gradient",color:"green",className:"capitalize",onClick:p=>C(p),loading:j,children:"Submit"})]})]})}function _e({deleteColumnDialog:a,setDeleteColumnDialog:o,columns:s,deleted_columns:u}){const{data:d,setData:f,post:m,processing:j,errors:A,reset:g}=G({type:"wntd",key:"delete",items:[]}),[N,C]=x.useState([]);x.useEffect(()=>{a&&C(w=>[...s.filter(c=>!u.includes(c.key)).map(c=>({key:c.key,name:c.name}))])},[a]);const y=(w,h)=>{const c=w.target.checked;f(I=>c?{...I,items:[...I.items,h]}:{...I,items:I.items.filter(F=>F!==h)})},p=w=>{w.preventDefault(),m(route("delete.columns.item"),{onSuccess:()=>{o(!1),g()}})};return e.jsxs(r.Dialog,{open:a,size:"xs",children:[e.jsx(r.DialogHeader,{children:"Delete Columns"}),e.jsx(r.DialogBody,{className:"max-h-[42rem] overflow-scroll",children:e.jsxs("div",{className:"form-item",children:[e.jsx("p",{className:"text-[#333] font-semibold",children:"Please select the column you want to delete."}),e.jsx("div",{className:"grid grid-cols-2",children:(N==null?void 0:N.length)>0&&N.map((w,h)=>e.jsx(re.Fragment,{children:e.jsx(r.Checkbox,{containerProps:{className:"py-3"},className:"w-5 h-5 rounded-md",label:e.jsx(r.Typography,{color:"blue-gray",className:"font-medium text-sm",children:w==null?void 0:w.name}),onChange:c=>{y(c,w==null?void 0:w.key)}})},h))})]})}),e.jsxs(r.DialogFooter,{children:[e.jsx(r.Button,{variant:"text",color:"red",className:"mr-1 capitalize",onClick:()=>o(!1),children:"Cancel"}),e.jsx(r.Button,{variant:"gradient",color:"green",className:"capitalize",onClick:w=>{p(w)},loading:j,children:"Submit"})]})]})}function ke({arrangeColumnDialog:a,setArrangeColumnDialog:o,columns:s,deleted_columns:u}){const[d,f]=x.useState([]),[m,j]=x.useState(null),{data:A,setData:g,post:N,processing:C,errors:y,reset:p}=G({type:"wntd",key:"arrange",items:[]});x.useEffect(()=>{a&&f(P=>[...(z=>z.map((M,$)=>({...M,position:$+1})))(s.filter(z=>!u.includes(z.key)).map(z=>({key:z.key,name:z.name})))])},[a]);const w=(P,k)=>{j(k)},h=()=>{j(null)},c=P=>{P.preventDefault()},I=(P,k)=>{if(!m)return;const O=d.indexOf(m),z=d.indexOf(k);if(O!==-1&&z!==-1){const $=[...(W=>W.map((l,v)=>({...l,position:v+1})))(d)],[J]=$.splice(O,1);$.splice(z,0,J);const S=$.map((W,l)=>({...W,position:l+1}));f(S);const Y=S.map(W=>({key:W.key,position:W.position}));g("items",Y)}},F=P=>{P.preventDefault(),N(route("rearrange.columns.item"),{onSuccess:()=>{o(!1),p()}})};return e.jsxs(r.Dialog,{open:a,size:"xs",children:[e.jsx(r.DialogHeader,{children:"Re-arrange Columns"}),e.jsxs(r.DialogBody,{className:"max-h-[42rem] overflow-scroll",children:[e.jsx("p",{className:"text-[#333] font-semibold mb-3",children:"Please drag and drop the column you want to arrange."}),e.jsx("div",{className:"draggable-wrapper border rounded-md py-2",children:(d==null?void 0:d.length)>0&&(d==null?void 0:d.map((P,k)=>e.jsx("div",{className:"text-gray-600 font-medium py-1 px-2 text-sm  cursor-move",draggable:"true",onDragStart:O=>w(O,P),onDragEnd:h,onDragOver:c,onDrop:O=>I(O,P),children:e.jsxs("div",{className:"flex items-center gap-3 border py-2 px-2 rounded-md ",children:[e.jsx("div",{className:"icon-wrapper",children:e.jsx(ve,{strokeWidth:1.5,size:18})}),P.name]})},k)))})]}),e.jsxs(r.DialogFooter,{children:[e.jsx(r.Button,{variant:"text",color:"red",className:"mr-1 capitalize",onClick:()=>o(!1),children:"cancel"}),e.jsx(r.Button,{variant:"gradient",color:"green",className:"capitalize",onClick:P=>F(P),loading:C,children:"Submit"})]})]})}function Ee({columns:a,hidden_columns:o,deleted_columns:s,hideColumnDialog:u,setHideColumnDialog:d}){const[f,m]=x.useState(!1),[j,A]=x.useState(!1),[g,N]=x.useState(!1),[C,y]=x.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(r.Button,{variant:"gradient",size:"sm",className:"capitalize rounded text-sm",onClick:()=>{m(!0)},children:"Add New Column"}),e.jsx(be,{addColumnDialog:f,setAddColumnDialog:m}),e.jsx(pe,{hideColumnDialog:u,setHideColumnDialog:d,columns:a,hidden_columns:o,deleted_columns:s}),e.jsx(Se,{renameColumnDialog:j,setRenameColumnDialog:A,columns:a,deleted_columns:s}),e.jsx(_e,{deleteColumnDialog:g,setDeleteColumnDialog:N,columns:a,deleted_columns:s}),e.jsx(ke,{arrangeColumnDialog:C,setArrangeColumnDialog:y,columns:a,deleted_columns:s})]})}function Ie({mappingDialog:a,setMappingDialog:o,mappingData:s,setBatchId:u}){var I,F,P,k,O,z,M,$,J,S,Y,W;const d=()=>o(!a),[f,m]=x.useState({file_path:s?s==null?void 0:s.filePath:"",loc_id:"",wntd:"",imsi:"",version:"",avc:"",bw_profile:"",lon:"",lat:"",site_name:"",home_cell:"",home_pci:"",traffic_profile:""}),[j,A]=x.useState({}),[g,N]=x.useState(!1),[C,y]=x.useState(""),[p,w]=x.useState(""),h=(l,v)=>{m(K=>({...K,[l]:v}))};x.useEffect(()=>{h("file_path",s!=null&&s.filePath?s==null?void 0:s.filePath:"")},[s]);const c=async l=>{var K,U,Q,V,X,se;l.preventDefault();let v={};if(["loc_id","wntd","imsi","version","avc","bw_profile","lon","lat","site_name","home_cell","home_pci","traffic_profile"].forEach(R=>{f[R]||(v[R]="This field is required.")}),A(v),Object.keys(v).length>0){console.log(v);return}try{N(!0);const R=await ce.post(route("wireless.sites.map.save"),f);R!=null&&R.data&&(w((U=(K=R==null?void 0:R.data)==null?void 0:K.success)==null?void 0:U.message),u((Q=R==null?void 0:R.data)==null?void 0:Q.batch_id),setTimeout(()=>{o(!1),w(""),y("")},3e3),D.visit(route("wireless.sites.index")))}catch(R){console.log("error:",R),y(`${(se=(X=(V=R==null?void 0:R.response)==null?void 0:V.data)==null?void 0:X.error)==null?void 0:se.message}`)}finally{N(!1)}};return e.jsx(re.Fragment,{children:e.jsxs(r.Dialog,{open:a,size:"xs",children:[e.jsx(r.DialogHeader,{children:"CSV Mapping"}),C&&e.jsx("p",{className:"text-red-500 font-medium text-[12px] px-4",children:C}),p&&e.jsx("p",{className:"text-green-500 font-medium text-[12px] px-4",children:p}),e.jsxs(r.DialogBody,{className:"px-6 overflow-scroll",children:[e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{value:"LOCID",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:f.loc_id,onChange:l=>h("loc_id",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((I=s==null?void 0:s.header)==null?void 0:I.length)>0&&(s==null?void 0:s.header.map((l,v)=>e.jsx("option",{value:l,children:l},v)))]}),e.jsx(T,{message:j.loc_id,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{value:"WNTD",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:f.wntd,onChange:l=>h("wntd",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((F=s==null?void 0:s.header)==null?void 0:F.length)>0&&(s==null?void 0:s.header.map((l,v)=>e.jsx("option",{value:l,children:l},v)))]}),e.jsx(T,{message:j.wntd,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{value:"IMSI",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:f.imsi,onChange:l=>h("imsi",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((P=s==null?void 0:s.header)==null?void 0:P.length)>0&&(s==null?void 0:s.header.map((l,v)=>e.jsx("option",{value:l,children:l},v)))]}),e.jsx(T,{message:j.imsi,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{value:"VERSION",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:f.version,onChange:l=>h("version",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((k=s==null?void 0:s.header)==null?void 0:k.length)>0&&(s==null?void 0:s.header.map((l,v)=>e.jsx("option",{value:l,children:l},v)))]}),e.jsx(T,{message:j.version,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{value:"AVC",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:f.avc,onChange:l=>h("avc",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((O=s==null?void 0:s.header)==null?void 0:O.length)>0&&(s==null?void 0:s.header.map((l,v)=>e.jsx("option",{value:l,children:l},v)))]}),e.jsx(T,{message:j.avc,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{value:"BW Profile",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:f.bw_profile,onChange:l=>h("bw_profile",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((z=s==null?void 0:s.header)==null?void 0:z.length)>0&&(s==null?void 0:s.header.map((l,v)=>e.jsx("option",{value:l,children:l},v)))]}),e.jsx(T,{message:j.bw_profile,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{value:"Lon",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:f.lon,onChange:l=>h("lon",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((M=s==null?void 0:s.header)==null?void 0:M.length)>0&&(s==null?void 0:s.header.map((l,v)=>e.jsx("option",{value:l,children:l},v)))]}),e.jsx(T,{message:j.lon,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{value:"Lat",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:f.lat,onChange:l=>h("lat",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),(($=s==null?void 0:s.header)==null?void 0:$.length)>0&&(s==null?void 0:s.header.map((l,v)=>e.jsx("option",{value:l,children:l},v)))]}),e.jsx(T,{message:j.lat,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{value:"SiteName",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:f.site_name,onChange:l=>h("site_name",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((J=s==null?void 0:s.header)==null?void 0:J.length)>0&&(s==null?void 0:s.header.map((l,v)=>e.jsx("option",{value:l,children:l},v)))]}),e.jsx(T,{message:j.site_name,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{value:"HomeCell",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:f.home_cell,onChange:l=>h("home_cell",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((S=s==null?void 0:s.header)==null?void 0:S.length)>0&&(s==null?void 0:s.header.map((l,v)=>e.jsx("option",{value:l,children:l},v)))]}),e.jsx(T,{message:j.home_cell,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{value:"HomePCI",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:f.home_pci,onChange:l=>h("home_pci",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((Y=s==null?void 0:s.header)==null?void 0:Y.length)>0&&(s==null?void 0:s.header.map((l,v)=>e.jsx("option",{value:l,children:l},v)))]}),e.jsx(T,{message:j.home_pci,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{value:"Traffic_Profile",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:f.traffic_profile,onChange:l=>h("traffic_profile",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((W=s==null?void 0:s.header)==null?void 0:W.length)>0&&(s==null?void 0:s.header.map((l,v)=>e.jsx("option",{value:l,children:l},v)))]}),e.jsx(T,{message:j.traffic_profile,className:"!text-[12px] font-medium"})]})]})})]}),e.jsxs(r.DialogFooter,{children:[e.jsx(r.Button,{variant:"text",color:"red",onClick:d,className:"mr-1",disabled:g,children:e.jsx("span",{children:"Cancel"})}),e.jsx(r.Button,{variant:"gradient",color:"green",onClick:c,loading:g,children:e.jsx("span",{children:"Confirm"})})]})]})})}function Pe(a){const{changedData:o}=te(u=>u.table),s=async()=>{var u,d,f;if(o.length>0){let m=o.filter(j=>j.site_id===a.data.id)[0];if(m){const j=await axios.post(route("wireless.sites.save.item"),{site_id:m==null?void 0:m.site_id,location_id:m==null?void 0:m.loc_id,items:m==null?void 0:m.items});(u=j==null?void 0:j.data)!=null&&u.success&&ee.success((f=(d=j==null?void 0:j.data)==null?void 0:d.success)==null?void 0:f.message)}}};return e.jsx(r.Button,{size:"sm",className:"capitalize py-1 px-2 rounded font-semibold",onClick:()=>{s()},children:"Save"})}function ze(a){const{processing:o,delete:s}=G(),[u,d]=x.useState(!1),f={onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1)},m=()=>{s(route("wireless.sites.destroy",a.data.id),{preserveScroll:!0,onSuccess:()=>{D.visit(route("wireless.sites.index"))}})};return e.jsx(re.Fragment,{children:e.jsxs(r.Popover,{placement:"top-end",open:u,handler:d,children:[e.jsx(r.PopoverHandler,{...f,children:e.jsx(r.Button,{variant:"gradient",color:"red",size:"sm",className:"capitalize py-1 px-2 rounded",onClick:()=>setOpen(!0),children:e.jsx(fe,{size:14})})}),e.jsxs(r.PopoverContent,{...f,className:"px-3",children:[e.jsx(r.Typography,{variant:"h6",className:"text-center",children:"Are you sure?"}),e.jsx(r.Typography,{variant:"small",className:"font-normal",children:"This cannot be reverted back."}),e.jsxs("div",{className:"mt-2 flex justify-between",children:[e.jsx(r.Button,{variant:"text",color:"red",size:"sm",className:"capitalize rounded",onClick:()=>d(!1),children:"Cancel"}),e.jsx(r.Button,{variant:"gradient",color:"red",size:"sm",className:"capitalize rounded",onClick:m,children:"Delete"})]})]})]})})}const Re=()=>{const a=de(),{addNewRowData:o}=te(d=>d.table),s=d=>{if(d.preventDefault(),!o.loc_id)return ee.error("LocId is required");D.post(route("wireless.sites.add.row"),{newItem:o},{onSuccess:()=>{a(oe(!1)),ee.success("Row Added successfully")}})},u=()=>{a(oe(!1)),ue({})};return e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsx(r.Button,{variant:"gradient",size:"sm",className:"capitalize py-1 px-2 rounded font-semibold",onClick:s,children:"Save"}),e.jsx(r.Button,{variant:"gradient",color:"red",size:"sm",className:"capitalize py-1 px-2 rounded",onClick:u,children:e.jsx(fe,{size:14})})]})};function Be({setAddNewRow:a}){const o=de(),{addNewRowData:s}=te(N=>N.table),u=["device_upgrade","reparent","repan","opti_type_1","opti_type_5","opti_type_6","epo"],d=["in_progress","not_started","completed"],f=x.useMemo(()=>({editable:!0})),[m]=x.useState([{headerName:"LOCID",field:"loc_id"},{headerName:"WNTD",field:"wntd"},{headerName:"IMSI",field:"imsi"},{headerName:"VERSION",field:"version"},{headerName:"AVC",field:"avc"},{headerName:"BW Profile",field:"bw_profile"},{headerName:"Lon",field:"lon"},{headerName:"Lat",field:"lat"},{headerName:"SiteName",field:"site_name"},{headerName:"HomeCell",field:"home_cell"},{headerName:"HomePCI",field:"home_pci"},{headerName:"Traffic Profile",field:"traffic_profile"},{headerName:"Start Date",field:"start_date",input_type:"date",valueFormatter:N=>{if(!N.value)return"";const C=N.value.getMonth()+1,y=N.value.getDate();return`${N.value.getFullYear()}-${C<10?"0"+C:C}-${y<10?"0"+y:y}`},cellEditor:"agDateCellEditor"},{headerName:"End Date",field:"end_date",valueFormatter:N=>{if(!N.value)return"";const C=N.value.getMonth()+1,y=N.value.getDate();return`${N.value.getFullYear()}-${C<10?"0"+C:C}-${y<10?"0"+y:y}`},cellEditor:"agDateCellEditor"},{headerName:"Solution Type",field:"solution_type",cellEditor:"agSelectCellEditor",filterParams:{caseSensitive:!0,defaultOption:"startsWith"},cellEditorParams:{values:u}},{headerName:"Status",field:"status",cellEditor:"agSelectCellEditor",filterParams:{caseSensitive:!0,defaultOption:"startsWith"},cellEditorParams:{values:d}},{headerName:"Remarks",field:"remarks"},{headerName:"Artifacts",field:"artifacts",editable:!1},{headerName:"",field:"",editable:!1,cellRenderer:Re}]),[j,A]=x.useState([{loc_id:"",wntd:"",imsi:"",version:"",avc:"",bw_profile:"",lon:"",lat:"",site_name:"",home_cell:"",home_pci:"",traffic_profile:"",deleted_at:null,remarks:"",artifacts:"",solution_type:"",start_date:new Date,status:"",end_date:new Date}]),g=N=>{var y;const C={...s};o(ue({...C,[(y=N==null?void 0:N.colDef)==null?void 0:y.field]:N==null?void 0:N.value}))};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"overflow-x-auto overflow-hidden",children:e.jsx("div",{className:"ag-theme-quartz",style:{height:110},children:e.jsx(he,{rowData:j,columnDefs:m,defaultColDef:f,onCellValueChanged:g})})})})}const He=a=>{var o,s;return e.jsx(ae,{href:route("wireless.show.location.index",(o=a==null?void 0:a.data)==null?void 0:o.id),className:"font-semibold underline",children:(s=a==null?void 0:a.data)==null?void 0:s.loc_id})},Te=a=>e.jsxs("div",{className:"flex gap-5 my-2",children:[e.jsx(Pe,{...a}),e.jsx(ze,{...a})]});function Qe({auth:a,sites:o,get_data:s,batch:u,additional_columns:d,hidden_columns:f,hidden_columns_names:m,renamed_columns:j,deleted_columns:A,arrange_columns:g}){var ie;const[N,C]=x.useState(!1),y=x.useRef(),h=[{headerName:"LOCID",field:"loc_id",editable:!1,cellRenderer:He,position:1},{headerName:"WNTD",field:"wntd",position:2},{headerName:"IMSI",field:"imsi",position:3},{headerName:"VERSION",field:"version",position:4},{headerName:"AVC",field:"avc",position:5},{headerName:"BW Profile",field:"bw_profile",position:6},{headerName:"Lon",field:"lon",position:7},{headerName:"Lat",field:"lat",position:8},{headerName:"SiteName",field:"site_name",position:9},{headerName:"HomeCell",field:"home_cell",position:10},{headerName:"HomePCI",field:"home_pci",position:11},{headerName:"Traffic Profile",field:"traffic_profile",position:12},{headerName:"Start Date",field:"start_date",input_type:"date",valueFormatter:t=>{if(!t.value)return"";const i=t.value.getMonth()+1,b=t.value.getDate();return`${t.value.getFullYear()}-${i<10?"0"+i:i}-${b<10?"0"+b:b}`},cellEditor:"agDateCellEditor",filter:!1,position:13},{headerName:"End Date",field:"end_date",valueFormatter:t=>{if(!t.value)return"";const i=t.value.getMonth()+1,b=t.value.getDate();return`${t.value.getFullYear()}-${i<10?"0"+i:i}-${b<10?"0"+b:b}`},cellEditor:"agDateCellEditor",filter:!1,position:14},{headerName:"Solution Type",field:"solution_type",cellEditor:"agSelectCellEditor",filterParams:{caseSensitive:!0,defaultOption:"startsWith"},cellEditorParams:{values:["device_upgrade","reparent","repan","opti_type_1","opti_type_5","opti_type_6","epo"]},position:15},{headerName:"Status",field:"status",cellEditor:"agSelectCellEditor",filterParams:{caseSensitive:!0,defaultOption:"startsWith"},cellEditorParams:{values:["in_progress","not_started","completed"]},position:16},{headerName:"Remarks",field:"remarks",position:17},{headerName:"Artifacts",field:"artifacts",cellRenderer:Ce,editable:!1,position:18}];function c(t){if(t==null)return[];let i=[];return t.forEach(_=>{_&&i.push(_)}),[...new Set([...i])]}const I=c(f),F=de(),P=x.useMemo(()=>({editable:!0,filter:!0})),{addNewRow:k}=te(t=>t.table),{role:O}=a;x.useEffect(()=>{var t;((t=o==null?void 0:o.data)==null?void 0:t.length)>0&&(o==null||o.data.map(i=>{if(i.end_date||i.start_date){let b=i!=null&&i.end_date?new Date(i==null?void 0:i.end_date):new Date,_=i!=null&&i.start_date?new Date(i==null?void 0:i.start_date):new Date;i.start_date=_,i.end_date=b}return i}),Y(o))},[o==null?void 0:o.data]);const[z,M]=x.useState(h);x.useRef(null),x.useState(s!=null&&s.search?s==null?void 0:s.search:"");const[$,J]=x.useState(s!=null&&s.per_page?s==null?void 0:s.per_page:10),[S,Y]=x.useState([]),[W,l]=x.useState(!1),[v,K]=x.useState(""),[U,Q]=x.useState(null),[V,X]=x.useState([]);x.useEffect(()=>{function t(i){const b=[...h],_=i==null?void 0:i.map((n,B)=>{let L={};return(n==null?void 0:n.input_type)==="date"?L={headerName:n==null?void 0:n.name.toUpperCase(),field:n==null?void 0:n.key,position:h.length+B+1,valueFormatter:q=>{if(!q.value)return"";const Z=q.value.getMonth()+1,le=q.value.getDate();return`${q.value.getFullYear()}-${Z<10?"0"+Z:Z}-${le<10?"0"+le:le}`},cellEditor:"agDateCellEditor",filter:!1}:(n==null?void 0:n.input_type)==="text"?L={headerName:n==null?void 0:n.name.toUpperCase(),field:n==null?void 0:n.key,position:h.length+B+1}:(n==null?void 0:n.input_type)==="dropdown"&&(L={headerName:n==null?void 0:n.name.toUpperCase(),field:n==null?void 0:n.key,position:h.length+B+1,cellEditorParams:{values:JSON.parse(n==null?void 0:n.options)}}),L});I&&(b.forEach(n=>{I.find(L=>n.field===L)?n.hide=!0:n.hide=!1}),_.forEach(n=>{I.find(L=>L===n.field)?n.hide=!0:n.hide=!1}));const E=[...b,..._,{headerName:"",field:"",editable:!1,filter:!1,cellRenderer:Te}];M(E)}(d==null?void 0:d.length)>0&&t(d)},[d]),x.useEffect(()=>{V.length>0&&F(me(V))},[V]);const se=t=>{const i=V.findIndex(b=>{var _,E;return b.site_id===((_=t==null?void 0:t.data)==null?void 0:_.id)&&b.loc_id===((E=t==null?void 0:t.data)==null?void 0:E.loc_id)});X(i!==-1?b=>{var E;const _=[...b];return _[i]={..._[i],items:{..._[i].items,[(E=t==null?void 0:t.colDef)==null?void 0:E.field]:t==null?void 0:t.value}},_}:b=>{var _,E,n;return[...b,{site_id:(_=t==null?void 0:t.data)==null?void 0:_.id,loc_id:(E=t==null?void 0:t.data)==null?void 0:E.loc_id,items:{[(n=t==null?void 0:t.colDef)==null?void 0:n.field]:t==null?void 0:t.value}}]})},R=t=>{J(t),D.get(route("wireless.sites.index",{...s,per_page:t}))};x.useEffect(()=>{u!=null&&u.batch_site_id&&Q(u==null?void 0:u.batch_site_id)},[]),x.useEffect(()=>{const t=async()=>{var b,_,E;try{let n=0;const B=await ce.get(route("import.progress",{batchId:U}));if(B!=null&&B.data){let L=parseInt((b=B==null?void 0:B.data)==null?void 0:b.total_jobs),q=parseInt((_=B==null?void 0:B.data)==null?void 0:_.pending_jobs),Z=L-q;parseInt((E=B==null?void 0:B.data)==null?void 0:E.failed_jobs)>0?clearInterval(i):(n=parseInt(Z/L*100).toFixed(0),n<100?ee.loading(`CSV Data Import Progress: ${n}%.
 Please wait....`,{id:"loading-toast",style:{backgroundColor:"#424242",color:"#ffffff",fontSize:14,borderRadius:4,fontWeight:"bold"}}):(ee.dismiss("loading-toast"),clearInterval(i)))}}catch(n){console.log(n)}},i=setInterval(()=>{U&&t()},5e3);return()=>clearInterval(i)},[U]);const xe=()=>{var i;((i=y.current.props)==null?void 0:i.columnDefs).forEach(b=>{const _=b.field,E=y.current.api.getColumnFilterModel(_);E!=null&&E.filter&&D.get(route("wireless.sites.index",{search:E==null?void 0:E.filter}))})};return console.log(S==null?void 0:S.data),e.jsxs(Ne,{user:a==null?void 0:a.user,children:[e.jsx(je,{title:"WNTD"}),e.jsx("div",{className:"top-section p-4",children:e.jsxs("div",{className:"bg-white shadow rounded py-3 px-5 flex justify-between items-center",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"",children:[e.jsx(r.Typography,{variant:"h3",className:"tracking-tight",children:"WNTD"}),e.jsxs("ul",{className:"flex gap-1 text-gray-600 text-sm",children:[e.jsx("li",{children:e.jsx(ae,{href:route("dashboard"),children:"Dashboard"})}),e.jsx("li",{children:"/"}),e.jsx("li",{children:e.jsx(ae,{href:route("wireless.sites.index"),children:"WNTD"})})]})]})}),e.jsx("div",{className:"filter-wrapper md:px-4",children:e.jsxs("div",{className:"flex filter-details justify-end gap-2",children:[O==="super-admin"&&e.jsx(e.Fragment,{}),e.jsx(we,{route_name:"wireless.sites.export",file_name:"WNTD_Export"})]})})]})}),e.jsxs("div",{className:"content mt-6",children:[e.jsxs(r.Card,{className:"h-full w-full rounded-none",children:[e.jsxs("div",{className:"overflow-x-auto overflow-hidden",children:[(S==null?void 0:S.data)&&((ie=S==null?void 0:S.data)==null?void 0:ie.length)>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"ag-theme-quartz w-full",style:{height:500},children:e.jsx(he,{ref:y,rowData:S==null?void 0:S.data,columnDefs:z,defaultColDef:P,onCellValueChanged:se,onFilterChanged:xe})}),e.jsx("div",{className:"w-[40px]",children:e.jsx("div",{className:"border flex justify-center rounded cursor-pointer",onClick:()=>C(!0),children:e.jsxs("p",{className:"column-hide-show py-10 flex gap-2",children:[e.jsx(ye,{size:22})," Columns"]})})})]}),k&&e.jsx(Be,{tableHeader:z})]}),(S==null?void 0:S.length)===0&&e.jsx(r.Typography,{variant:"h6",color:"blue-gray",className:"text-center py-6",children:"No data found"})]}),e.jsxs("div",{className:"pagination flex justify-between items-center",children:[e.jsxs("div",{className:"px-4 flex gap-5",children:[e.jsx(r.Button,{variant:"gradient",size:"sm",className:"capitalize rounded text-sm",onClick:()=>{F(oe(!0))},children:"Add New Row"}),e.jsx(Ee,{columns:z,hidden_columns:f,deleted_columns:A||[],hideColumnDialog:N,setHideColumnDialog:C})]}),e.jsxs("div",{className:"md:flex grid justify-start md:justify-end items-center pt-6 mb-8 gap-3 px-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-sm font-medium",children:"Rows per Page"}),e.jsxs("select",{className:"rounded-md text-sm font-medium border-gray-400 focus:ring-0 py-2",value:$,onChange:t=>{R(t.target.value)},children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"15",children:"15"}),e.jsx("option",{value:"20",children:"20"}),e.jsx("option",{value:"20",children:"25"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"all",children:"All"})]})]}),e.jsx("div",{className:"text-sm font-medium",children:`${o==null?void 0:o.from}-${o==null?void 0:o.to} of ${o==null?void 0:o.total} Records`}),e.jsx(ge,{links:S==null?void 0:S.links,perPage:$})]})]})]}),e.jsx(Ie,{mappingDialog:W,setMappingDialog:l,mappingData:v,setBatchId:Q})]})]})}export{Qe as default};
