import{j as e,r as n,Y as P,a as u,b as C}from"./app-MeaRoDMw.js";import{I as T}from"./InputError-j6QVA4vx.js";import{I as Q}from"./InputLabel-diQMrqXX.js";import{c as h,A as _,C as K}from"./AuthenticatedLayout-DNt-0JDC.js";import{r as d}from"./index-Ck9CppQy.js";import{A as V}from"./index.esm-BpZsoeZe.js";import"./transition-CjT5Grax.js";import"./ApplicationLogo-CipjvWNk.js";/**
 * @license lucide-react v0.376.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=h("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.376.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=h("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.376.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=h("Table2",[["path",{d:"M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18",key:"gugj83"}]]),W=({columnsByTable:i})=>{const m=l=>l==="character varying"?"varchar(255)":l;return e.jsx("div",{className:"my-2",children:i.map(l=>e.jsxs("p",{className:"ml-10 mt-1 text-xs font-medium",children:[l==null?void 0:l.column_name," - ",e.jsx("span",{className:"text-gray-700",children:m(l==null?void 0:l.data_type)})]}))})},Y=W;function ae({auth:i,tablesNames:m,columnsByTable:l}){const[p,f]=n.useState(""),[j,g]=n.useState(!1),[x,y]=n.useState({}),[k,N]=n.useState(""),[o,b]=n.useState([]),[M,v]=n.useState(!1),[D,S]=n.useState(!1),[q,z]=n.useState(""),[w,R]=n.useState(""),I=async s=>{var a,t,r;s&&s.preventDefault();try{v(!0);const c=await C.post(route("sql.run"),{sql_query:p});b((a=c==null?void 0:c.data)==null?void 0:a.data),N("")}catch(c){N((r=(t=c==null?void 0:c.response)==null?void 0:t.data)==null?void 0:r.error.message),b([])}finally{v(!1),g(!1)}};n.useEffect(()=>{j&&I()},[j]);const E=async()=>{var s,a,t;if((o==null?void 0:o.length)>0)try{S(!0);const r=await C.post(route("sql.store"),{data:o});R((s=r==null?void 0:r.data)==null?void 0:s.success.message)}catch(r){z((t=(a=r==null?void 0:r.response)==null?void 0:a.data)==null?void 0:t.error.message)}finally{S(!1)}},L=n.useMemo(()=>({filter:!0})),A=(s,a)=>{s.stopPropagation();let t={};t[a]=!0,y(t),f(`select * from ${a}`),g(!0)},B=(s,a)=>{s.stopPropagation();const t={...x};t[a]?t[a]=!t[a]:t[a]=!0,y(t)},H=({data:s})=>{if((s==null?void 0:s.length)>0){const t=Array.from(new Set(s.flatMap(r=>Object.keys(r)))).map((r,c)=>({field:r,headerName:r}));return e.jsxs("div",{className:"mt-8",children:[e.jsx("div",{className:"ag-theme-quartz w-full",style:{height:(s==null?void 0:s.length)>5?500:200},children:e.jsx(V,{rowData:s,columnDefs:t,defaultColDef:L})}),e.jsxs("div",{className:"flex justify-between mt-6 mb-8",children:[e.jsxs("div",{className:"",children:[e.jsx(T,{message:q,className:"mt-0 font-medium text-red-500"}),w&&e.jsxs(d.Typography,{className:"font-medium text-green-500",children:[w,e.jsx(u,{href:route("wireless.sites.index"),className:"ps-1 underline",children:"Click here to check"})]})]}),e.jsx(d.Button,{variant:"gradient",size:"sm",className:"capitalize",onClick:E,disabled:D,children:"Import Data"})]})]})}};return e.jsxs(_,{user:i==null?void 0:i.user,children:[e.jsx(P,{title:"Wireless Sites"}),e.jsx("div",{className:"top-section p-4",children:e.jsx("div",{className:"bg-white shadow rounded py-3 px-5 flex justify-between items-center",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"",children:[e.jsx(d.Typography,{variant:"h3",className:"tracking-tight",children:"SQL Import"}),e.jsxs("ul",{className:"flex gap-1 text-gray-600 text-sm",children:[e.jsx("li",{children:e.jsx(u,{href:route("dashboard"),children:"Dashboard"})}),e.jsx("li",{children:"/"}),e.jsx("li",{children:e.jsx(u,{href:route("sql.import"),children:"SQL Import"})})]})]})})})}),e.jsxs("div",{className:"flex w-full mt-6 ",children:[e.jsx("div",{className:" ml-2",children:e.jsxs("div",{className:" bg-white shadow rounded py-3 px-5",children:[e.jsx("h1",{className:"mb-2 text-xl font-bold",children:"Tables"}),e.jsx("div",{className:"",children:e.jsx("ul",{children:m.map((s,a)=>e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"font-medium text-sm flex justify-between items-center mb-1 cursor-pointer text-gray-700 dark:text-gray-300 gap-2",onClick:t=>B(t,s),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[x[s]?e.jsx(K,{size:"16"}):e.jsx($,{size:"16"}),e.jsx(O,{size:"16"}),s]}),e.jsx("div",{title:"play",children:e.jsx(G,{size:12,fill:"#000",onClick:t=>A(t,s)})})]}),x[s]&&e.jsx(Y,{columnsByTable:l[s]})]},s))})})]})}),e.jsxs("div",{className:"w-[90%] filter-wrapper px-4",children:[e.jsxs(d.Card,{className:"w-full px-6 py-4",children:[e.jsx(Q,{value:"SQl Code",className:"mb-2"}),e.jsx("textarea",{className:"border rounded-md border-gray-300 text-base font-medium focus:ring-0",rows:3,value:p,onChange:s=>f(s.target.value)}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:e.jsx(T,{message:k,className:"mt-0 font-medium text-red-500"})}),e.jsx(d.Button,{className:"mt-4 block capitalize",onClick:I,disabled:M,children:"Run"})]})]}),e.jsx(H,{data:o})]})]})]})}export{ae as default};
