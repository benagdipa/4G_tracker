import{r as x,j as e,R as D,b as se,y as K,u as ee,W as J,c as te,s as ne,d as le,e as ue,Y as me,a as ae}from"./app-CIRcvYGN.js";import{r as t}from"./index-6jRPV5pi.js";import{_ as V,A as xe}from"./AuthenticatedLayout-BtjXaohP.js";import{M as he,T as oe,S as fe,P as je}from"./Pagination-CjISjZn-.js";import{T as Z}from"./TextInput-_gAuWY6g.js";import{I as z}from"./InputLabel-CwVRJKMl.js";import{I}from"./InputError-CXbk0JLM.js";import{A as de,R as Ne,E as ve}from"./ag-theme-quartz-BsbbgXLY.js";/* empty css                         */import{U as ye}from"./UploadItem-DwxJk60t.js";import"./transition-prLGfJeh.js";import"./index-C6kzJobj.js";function ge({mappingDialog:o,setMappingDialog:r,mappingData:s,setBatchId:i}){var b,k,w,T,g,E,q,A,$,L,W,H,M;const d=()=>r(!o),[u,f]=x.useState({file_path:s?s==null?void 0:s.filePath:"",site_name:"",cell_name:"",lon:"",lat:"",bb_type:"",rru_type:"",antenna_type:"",frequency:"",pci:"",azimuth:"",height:"",last_epo:"",next_epo:""}),[c,F]=x.useState({}),[N,v]=x.useState(!1),[P,_]=x.useState(""),[p,y]=x.useState(""),m=(l,j)=>{f(U=>({...U,[l]:j}))};x.useEffect(()=>{m("file_path",s!=null&&s.filePath?s==null?void 0:s.filePath:"")},[s]);const h=async l=>{var U,Y,Q,X,G,n;l.preventDefault();let j={};if(["site_name","cell_name","lon","lat","bb_type","rru_type","antenna_type","frequency","pci","azimuth","height","last_epo","next_epo"].forEach(a=>{u[a]||(j[a]="This field is required.")}),F(j),Object.keys(j).length>0){console.log(j);return}try{v(!0);const a=await se.post(route("site.field.map.save"),u);a!=null&&a.data&&(y((Y=(U=a==null?void 0:a.data)==null?void 0:U.success)==null?void 0:Y.message),i((Q=a==null?void 0:a.data)==null?void 0:Q.batch_id),setTimeout(()=>{r(!1),y(""),_("")},3e3),K.visit(route("site.field.name.index")))}catch(a){console.log("error:",a),_(`${(n=(G=(X=a==null?void 0:a.response)==null?void 0:X.data)==null?void 0:G.error)==null?void 0:n.message}`)}finally{v(!1)}};return e.jsx(D.Fragment,{children:e.jsxs(t.Dialog,{open:o,size:"xs",children:[e.jsx(t.DialogHeader,{children:"CSV Mapping"}),P&&e.jsx("p",{className:"text-red-500 font-medium text-[12px] px-4",children:P}),p&&e.jsx("p",{className:"text-green-500 font-medium text-[12px] px-4",children:p}),e.jsxs(t.DialogBody,{className:"px-6 overflow-scroll",children:[e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{value:"Site Name",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:u.site_name,onChange:l=>m("site_name",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((b=s==null?void 0:s.header)==null?void 0:b.length)>0&&(s==null?void 0:s.header.map((l,j)=>e.jsx("option",{value:l,children:l},j)))]}),e.jsx(I,{message:c.site_name,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{value:"Cell Name",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:u.cell_name,onChange:l=>m("cell_name",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((k=s==null?void 0:s.header)==null?void 0:k.length)>0&&(s==null?void 0:s.header.map((l,j)=>e.jsx("option",{value:l,children:l},j)))]}),e.jsx(I,{message:c.cell_name,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{value:"Lon",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:u.lon,onChange:l=>m("lon",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((w=s==null?void 0:s.header)==null?void 0:w.length)>0&&(s==null?void 0:s.header.map((l,j)=>e.jsx("option",{value:l,children:l},j)))]}),e.jsx(I,{message:c.lon,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{value:"Lat",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:u.lat,onChange:l=>m("lat",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((T=s==null?void 0:s.header)==null?void 0:T.length)>0&&(s==null?void 0:s.header.map((l,j)=>e.jsx("option",{value:l,children:l},j)))]}),e.jsx(I,{message:c.lat,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{value:"BB Type",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:u.bb_type,onChange:l=>m("bb_type",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((g=s==null?void 0:s.header)==null?void 0:g.length)>0&&(s==null?void 0:s.header.map((l,j)=>e.jsx("option",{value:l,children:l},j)))]}),e.jsx(I,{message:c.bb_type,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{value:"RRU Type",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:u.rru_type,onChange:l=>m("rru_type",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((E=s==null?void 0:s.header)==null?void 0:E.length)>0&&(s==null?void 0:s.header.map((l,j)=>e.jsx("option",{value:l,children:l},j)))]}),e.jsx(I,{message:c.rru_type,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{value:"Antenna Type",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:u.antenna_type,onChange:l=>m("antenna_type",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((q=s==null?void 0:s.header)==null?void 0:q.length)>0&&(s==null?void 0:s.header.map((l,j)=>e.jsx("option",{value:l,children:l},j)))]}),e.jsx(I,{message:c.antenna_type,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{value:"Frequency",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:u.frequency,onChange:l=>m("frequency",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((A=s==null?void 0:s.header)==null?void 0:A.length)>0&&(s==null?void 0:s.header.map((l,j)=>e.jsx("option",{value:l,children:l},j)))]}),e.jsx(I,{message:c.frequency,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{value:"PCI",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:u.pci,onChange:l=>m("pci",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),(($=s==null?void 0:s.header)==null?void 0:$.length)>0&&(s==null?void 0:s.header.map((l,j)=>e.jsx("option",{value:l,children:l},j)))]}),e.jsx(I,{message:c.pci,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{value:"Azimuth",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:u.azimuth,onChange:l=>m("azimuth",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((L=s==null?void 0:s.header)==null?void 0:L.length)>0&&(s==null?void 0:s.header.map((l,j)=>e.jsx("option",{value:l,children:l},j)))]}),e.jsx(I,{message:c.azimuth,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{value:"Height",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:u.height,onChange:l=>m("height",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((W=s==null?void 0:s.header)==null?void 0:W.length)>0&&(s==null?void 0:s.header.map((l,j)=>e.jsx("option",{value:l,children:l},j)))]}),e.jsx(I,{message:c.height,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{value:"Last EPO",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:u.last_epo,onChange:l=>m("last_epo",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((H=s==null?void 0:s.header)==null?void 0:H.length)>0&&(s==null?void 0:s.header.map((l,j)=>e.jsx("option",{value:l,children:l},j)))]}),e.jsx(I,{message:c.last_epo,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{value:"Next EPO",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:u.next_epo,onChange:l=>m("next_epo",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((M=s==null?void 0:s.header)==null?void 0:M.length)>0&&(s==null?void 0:s.header.map((l,j)=>e.jsx("option",{value:l,children:l},j)))]}),e.jsx(I,{message:c.next_epo,className:"!text-[12px] font-medium"})]})]})})]}),e.jsxs(t.DialogFooter,{children:[e.jsx(t.Button,{variant:"text",color:"red",onClick:d,className:"mr-1",disabled:N,children:e.jsx("span",{children:"Cancel"})}),e.jsx(t.Button,{variant:"gradient",color:"green",onClick:h,loading:N,children:e.jsx("span",{children:"Confirm"})})]})]})})}function pe(o){const{changedDataFW:r}=ee(i=>i.table),s=async()=>{var i,d,u;if(r.length>0){let f=r.filter(c=>c.site_id===o.data.id)[0];if(f){const c=await axios.post(route("site.field.name.save.item"),{site_id:f==null?void 0:f.site_id,items:f==null?void 0:f.items});(i=c==null?void 0:c.data)!=null&&i.success&&V.success((u=(d=c==null?void 0:c.data)==null?void 0:d.success)==null?void 0:u.message)}}};return e.jsx(t.Button,{size:"sm",className:"capitalize py-1 px-2 rounded font-semibold",onClick:()=>{s()},children:"Save"})}function we({addColumnDialog:o,setAddColumnDialog:r}){const{data:s,setData:i,post:d,processing:u,errors:f,reset:c}=J({type:"fw_site",name:"",key:"",input_type:"",options:""}),F=N=>{N.preventDefault(),d(route("additional.columns.save.item"),{onSuccess:()=>{r(!1),c()}})};return e.jsxs(t.Dialog,{open:o,size:"xs",children:[e.jsx(t.DialogHeader,{children:"Add New Column"}),e.jsxs(t.DialogBody,{children:[e.jsxs("div",{className:"form-item mb-4",children:[e.jsx(z,{value:"Column Name",className:"mb-1"}),e.jsx(Z,{className:"w-full text-sm font-medium text-gray-600",placeholder:"Column Name...",value:s.name,onChange:N=>i("name",N.target.value)}),e.jsx(I,{message:f.name,className:"text-sm font-medium"})]}),e.jsxs("div",{className:"form-item mb-4",children:[e.jsx(z,{value:"Column Key",className:"mb-1"}),e.jsx(Z,{className:"w-full text-sm font-medium text-gray-600",placeholder:"Column key...",value:s.key,onChange:N=>i("key",N.target.value)}),e.jsx(I,{message:f.key,className:"text-sm font-medium"})]}),e.jsxs("div",{className:"form-item mb-4",children:[e.jsx(z,{value:"Column Input Type",className:"mb-1"}),e.jsxs("select",{className:"w-full rounded text-sm border-gray-300 shadow-sm font-medium text-gray-600 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600",value:s.input_type,onChange:N=>i("input_type",N.target.value),children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"text",children:"Text"}),e.jsx("option",{value:"date",children:"Date"}),e.jsx("option",{value:"dropdown",children:"DropDown"})]}),e.jsx(I,{message:f.input_type,className:"text-sm font-medium"})]}),(s==null?void 0:s.input_type)==="dropdown"&&e.jsxs("div",{className:"form-item mb-4",children:[e.jsx(z,{value:"Dropdown Options seprated by (|)",className:"mb-1"}),e.jsx("textarea",{className:"w-full rounded text-sm border-gray-300 shadow-sm font-normal focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600",placeholder:"Dropdown Options seprated by | ...",rows:4,value:s.options,onChange:N=>i("options",N.target.value)}),e.jsx(I,{message:f.options,className:"text-sm font-medium"})]})]}),e.jsxs(t.DialogFooter,{children:[e.jsx(t.Button,{variant:"text",color:"red",onClick:()=>r(!o),className:"mr-1 capitalize",children:e.jsx("span",{children:"Cancel"})}),e.jsx(t.Button,{variant:"gradient",color:"green",onClick:N=>F(N),className:"capitalize",loading:u,children:e.jsx("span",{children:"Submit"})})]})]})}function be({hideColumnDialog:o,setHideColumnDialog:r,columns:s,hidden_columns:i,deleted_columns:d}){const u=()=>r(!o),[f,c]=x.useState([]),{data:F,setData:N,post:v,processing:P,errors:_,reset:p}=J({type:"fw_site",key:"hide",items:(i==null?void 0:i.length)>0?i:[]});x.useEffect(()=>{o&&c(h=>[...s.filter(k=>!d.includes(k.key)).map(k=>({key:k.key,name:k.name}))])},[o]);const y=(h,b)=>{const k=h.target.checked;N(w=>k?{...w,items:[...w.items,b]}:{...w,items:w.items.filter(T=>T!==b)})},m=h=>{h.preventDefault(),v(route("hide.columns.item"),{onSuccess:()=>{r(!1),p()}})};return e.jsxs(t.Dialog,{open:o,size:"xs",children:[e.jsx(t.DialogHeader,{children:"Hide Column"}),e.jsx(t.DialogBody,{children:e.jsxs("div",{className:"form-item",children:[e.jsx("p",{className:"text-[#333] font-semibold",children:"Please select the column you want to hide"}),e.jsx("div",{className:"form-item grid grid-cols-2",children:(f==null?void 0:f.length)>0&&f.map((h,b)=>e.jsx(D.Fragment,{children:e.jsx(t.Checkbox,{containerProps:{className:"py-3"},className:"w-5 h-5 rounded-md",label:e.jsx(t.Typography,{color:"blue-gray",className:"font-medium text-sm",children:h==null?void 0:h.name}),onChange:k=>y(k,h==null?void 0:h.key),defaultChecked:i==null?void 0:i.includes(h==null?void 0:h.key)})},b))})]})}),e.jsxs(t.DialogFooter,{children:[e.jsx(t.Button,{variant:"text",color:"red",onClick:u,className:"mr-1 capitalize",children:e.jsx("span",{children:"Cancel"})}),e.jsx(t.Button,{variant:"gradient",color:"green",onClick:h=>{m(h)},className:"capitalize",children:e.jsx("span",{children:"Confirm"})})]})]})}function Ce({renameColumnDialog:o,setRenameColumnDialog:r,columns:s,deleted_columns:i}){var _;const{data:d,setData:u,post:f,processing:c,errors:F,reset:N}=J({type:"fw_site",key:"rename",items:[]});x.useEffect(()=>{o&&u(p=>{const y=[...s.filter(m=>!i.includes(m.key)).map(m=>({key:m.key,name:m.name}))];return{...p,items:y}})},[o]);const v=(p,y)=>{u(m=>({...m,items:m.items.map(h=>h.key===p?{...h,name:y}:h)}))},P=p=>{p.preventDefault(),f(route("rename.columns.item"),{onSuccess:()=>{r(!1),N()}})};return e.jsxs(t.Dialog,{open:o,size:"xs",children:[e.jsx(t.DialogHeader,{children:"Rename Columns"}),e.jsx(t.DialogBody,{className:"max-h-[42rem] overflow-scroll",children:e.jsx("div",{className:"grid grid-cols-2 gap-3",children:(d==null?void 0:d.items.length)>0&&((_=d==null?void 0:d.items)==null?void 0:_.map((p,y)=>e.jsx("div",{className:"form-item mb-2",children:e.jsx(Z,{className:"w-full text-sm font-medium text-gray-600",value:p==null?void 0:p.name,onChange:m=>v(p==null?void 0:p.key,m.target.value)})},y)))})}),e.jsxs(t.DialogFooter,{children:[e.jsx(t.Button,{variant:"text",color:"red",className:"mr-1 capitalize",onClick:()=>r(!1),children:"Cancel"}),e.jsx(t.Button,{variant:"gradient",color:"green",className:"capitalize",onClick:p=>P(p),loading:c,children:"Submit"})]})]})}function Se({deleteColumnDialog:o,setDeleteColumnDialog:r,columns:s,deleted_columns:i}){const{data:d,setData:u,post:f,processing:c,errors:F,reset:N}=J({type:"fw_site",key:"delete",items:[]}),[v,P]=x.useState([]);x.useEffect(()=>{o&&P(y=>[...s.filter(h=>!i.includes(h.key)).map(h=>({key:h.key,name:h.name}))])},[o]);const _=(y,m)=>{const h=y.target.checked;u(b=>h?{...b,items:[...b.items,m]}:{...b,items:b.items.filter(k=>k!==m)})},p=y=>{y.preventDefault(),f(route("delete.columns.item"),{onSuccess:()=>{r(!1),N()}})};return e.jsxs(t.Dialog,{open:o,size:"xs",children:[e.jsx(t.DialogHeader,{children:"Delete Columns"}),e.jsx(t.DialogBody,{className:"max-h-[42rem] overflow-scroll",children:e.jsxs("div",{className:"form-item",children:[e.jsx("p",{className:"text-[#333] font-semibold",children:"Please select the column you want to delete."}),e.jsx("div",{className:"grid grid-cols-2",children:(v==null?void 0:v.length)>0&&v.map((y,m)=>e.jsx(D.Fragment,{children:e.jsx(t.Checkbox,{containerProps:{className:"py-3"},className:"w-5 h-5 rounded-md",label:e.jsx(t.Typography,{color:"blue-gray",className:"font-medium text-sm",children:y==null?void 0:y.name}),onChange:h=>{_(h,y==null?void 0:y.key)}})},m))})]})}),e.jsxs(t.DialogFooter,{children:[e.jsx(t.Button,{variant:"text",color:"red",className:"mr-1 capitalize",onClick:()=>r(!1),children:"Cancel"}),e.jsx(t.Button,{variant:"gradient",color:"green",className:"capitalize",onClick:y=>{p(y)},loading:c,children:"Submit"})]})]})}function _e({arrangeColumnDialog:o,setArrangeColumnDialog:r,columns:s,deleted_columns:i}){const[d,u]=x.useState([]),[f,c]=x.useState(null),{data:F,setData:N,post:v,processing:P,errors:_,reset:p}=J({type:"fw_site",key:"arrange",items:[]});x.useEffect(()=>{o&&u(w=>[...(E=>E.map((q,A)=>({...q,position:A+1})))(s.filter(E=>!i.includes(E.key)).map(E=>({key:E.key,name:E.name})))])},[o]);const y=(w,T)=>{c(T)},m=()=>{c(null)},h=w=>{w.preventDefault()},b=(w,T)=>{if(!f)return;const g=d.indexOf(f),E=d.indexOf(T);if(g!==-1&&E!==-1){const A=[...(H=>H.map((M,l)=>({...M,position:l+1})))(d)],[$]=A.splice(g,1);A.splice(E,0,$);const L=A.map((H,M)=>({...H,position:M+1}));u(L);const W=L.map(H=>({key:H.key,position:H.position}));N("items",W)}},k=w=>{w.preventDefault(),v(route("rearrange.columns.item"),{onSuccess:()=>{r(!1),p()}})};return e.jsxs(t.Dialog,{open:o,size:"xs",children:[e.jsx(t.DialogHeader,{children:"Re-arrange Columns"}),e.jsxs(t.DialogBody,{className:"max-h-[42rem] overflow-scroll",children:[e.jsx("p",{className:"text-[#333] font-semibold mb-3",children:"Please drag and drop the column you want to arrange."}),e.jsx("div",{className:"draggable-wrapper border rounded-md py-2",children:(d==null?void 0:d.length)>0&&(d==null?void 0:d.map((w,T)=>e.jsx("div",{className:"text-gray-600 font-medium py-1 px-2 text-sm  cursor-move",draggable:"true",onDragStart:g=>y(g,w),onDragEnd:m,onDragOver:h,onDrop:g=>b(g,w),children:e.jsxs("div",{className:"flex items-center gap-3 border py-2 px-2 rounded-md ",children:[e.jsx("div",{className:"icon-wrapper",children:e.jsx(he,{strokeWidth:1.5,size:18})}),w.name]})},T)))})]}),e.jsxs(t.DialogFooter,{children:[e.jsx(t.Button,{variant:"text",color:"red",className:"mr-1 capitalize",onClick:()=>r(!1),children:"cancel"}),e.jsx(t.Button,{variant:"gradient",color:"green",className:"capitalize",onClick:w=>k(w),loading:P,children:"Submit"})]})]})}function ke({columns:o,hidden_columns:r,deleted_columns:s}){const[i,d]=x.useState(!1),[u,f]=x.useState(!1),[c,F]=x.useState(!1),[N,v]=x.useState(!1),[P,_]=x.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(t.Menu,{children:[e.jsx(t.MenuHandler,{children:e.jsx(t.Button,{variant:"gradient",size:"sm",className:"capitalize",children:"Column Options"})}),e.jsxs(t.MenuList,{className:"font-semibold text-gray-600",children:[e.jsx(t.MenuItem,{onClick:()=>{d(!0)},children:"Add Column"}),e.jsx(t.MenuItem,{onClick:()=>{f(!0)},children:"Show/Hide Columns"}),e.jsx(t.MenuItem,{onClick:()=>{F(!0)},children:"Rename Columns"}),e.jsx(t.MenuItem,{onClick:()=>{_(!0)},children:"Rearrange Columns"}),e.jsx(t.MenuItem,{onClick:()=>{v(!0)},className:"text-red-500",children:"Delete Columns"})]})]}),e.jsx(we,{addColumnDialog:i,setAddColumnDialog:d}),e.jsx(be,{hideColumnDialog:u,setHideColumnDialog:f,columns:o,hidden_columns:r,deleted_columns:s}),e.jsx(Ce,{renameColumnDialog:c,setRenameColumnDialog:F,columns:o,deleted_columns:s}),e.jsx(Se,{deleteColumnDialog:N,setDeleteColumnDialog:v,columns:o,deleted_columns:s}),e.jsx(_e,{arrangeColumnDialog:P,setArrangeColumnDialog:_,columns:o,deleted_columns:s})]})}function ze({site_id:o}){const{processing:r,delete:s}=J(),[i,d]=x.useState(!1),u={onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1)},f=()=>{s(route("site.field.name.destroy",o),{preserveScroll:!0,onSuccess:()=>{K.visit(route("site.field.name.index"))}})};return e.jsx(D.Fragment,{children:e.jsxs(t.Popover,{placement:"top-end",open:i,handler:d,children:[e.jsx(t.PopoverHandler,{...u,children:e.jsx(t.Button,{variant:"gradient",color:"red",size:"sm",className:"capitalize py-1 px-2 rounded",onClick:()=>setOpen(!0),children:e.jsx(oe,{size:14})})}),e.jsxs(t.PopoverContent,{...u,className:"px-3",children:[e.jsx(t.Typography,{variant:"h6",className:"text-center",children:"Are you sure?"}),e.jsx(t.Typography,{variant:"small",className:"font-normal",children:"This cannot be reverted back."}),e.jsxs("div",{className:"mt-2 flex justify-between",children:[e.jsx(t.Button,{variant:"text",color:"red",size:"sm",className:"capitalize rounded",onClick:()=>d(!1),children:"Cancel"}),e.jsx(t.Button,{variant:"gradient",color:"red",size:"sm",className:"capitalize rounded",onClick:f,children:"Delete"})]})]})]})})}const Ie=()=>{const o=te(),{addNewRowDataFW:r}=ee(d=>d.table),s=d=>{if(d.preventDefault(),!r.site_name)return V.error("Site name is required");K.post(route("site.field.name.add.row"),r,{onSuccess:()=>{o(le(!1)),V.success("Row Added successfully")}})},i=()=>{o(le(!1)),ne({})};return e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsx(t.Button,{variant:"gradient",size:"sm",className:"capitalize py-1 px-2 rounded font-semibold",onClick:s,children:"Save"}),e.jsx(t.Button,{variant:"gradient",color:"red",size:"sm",className:"capitalize py-1 px-2 rounded",onClick:i,children:e.jsx(oe,{size:14})})]})};function Pe({setAddNewRow:o}){const r=te(),{addNewRowData:s}=ee(v=>v.table),i=["opti_type_1","opti_type_5","opti_type_6"],d=["in_progress","not_started","completed"],u=x.useMemo(()=>({editable:!0})),[f]=x.useState([{headerName:"Site Name",field:"site_name"},{headerName:"Cell Name",field:"cell_name"},{headerName:"Lon",field:"lon"},{headerName:"Lat",field:"lat"},{headerName:"BB Type",field:"bb_type"},{headerName:"RRU Type",field:"rru_type"},{headerName:"Antenna Type",field:"antenna_type"},{headerName:"Frequency",field:"frequency"},{headerName:"PCI",field:"pci"},{headerName:"Azimuth",field:"azimuth"},{headerName:"Height",field:"height"},{headerName:"Last EPO",field:"last_epo"},{headerName:"Next EPO",field:"next_epo"},{headerName:"Start Date",field:"start_date"},{headerName:"End Date",field:"end_date"},{headerName:"Solution Type",field:"solution_type",cellEditor:"agSelectCellEditor",filterParams:{caseSensitive:!0,defaultOption:"startsWith"},cellEditorParams:{values:i}},{headerName:"Status",field:"status",cellEditor:"agSelectCellEditor",filterParams:{caseSensitive:!0,defaultOption:"startsWith"},cellEditorParams:{values:d}},{headerName:"Remarks",field:"remarks"},{headerName:"Artifacts",field:"artifacts",editable:!1},{headerName:"",field:"",editable:!1,filter:!1,cellRenderer:Ie}]),[c,F]=x.useState([{loc_id:"",wntd:"",imsi:"",version:"",avc:"",bw_profile:"",lon:"",lat:"",site_name:"",home_cell:"",home_pci:"",traffic_profile:"",deleted_at:null,remarks:"",artifacts:"",solution_type:"",start_date:new Date,status:"",end_date:new Date}]),N=v=>{var _;const P={...s};r(ne({...P,[(_=v==null?void 0:v.colDef)==null?void 0:_.field]:v==null?void 0:v.value}))};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"overflow-x-auto overflow-hidden",children:e.jsx("div",{className:"ag-theme-quartz",style:{height:100},children:e.jsx(de,{rowData:c,columnDefs:f,defaultColDef:u,onCellValueChanged:N})})})})}const Ee=o=>e.jsxs("div",{className:"flex gap-5 my-2",children:[e.jsx(pe,{...o}),e.jsx(ze,{...o})]});function Ve({auth:o,sites:r,get_data:s,batch:i,additional_columns:d,hidden_columns:u,renamed_columns:f,deleted_columns:c,arrange_columns:F}){var G;const{role:N}=o,v=te(),{addNewRowFW:P}=ee(n=>n.table),_=x.useMemo(()=>({editable:!0,filter:!0})),p=["opti_type_1","opti_type_5","opti_type_6"],y=["in_progress","not_started","completed"];x.useEffect(()=>{var n;((n=r==null?void 0:r.data)==null?void 0:n.length)>0&&(r==null||r.data.map(a=>{if(a.end_date||a.start_date){let B=a!=null&&a.end_date?new Date(a==null?void 0:a.end_date):new Date,S=a!=null&&a.start_date?new Date(a==null?void 0:a.start_date):new Date;a.start_date=S,a.end_date=B}return a}),E(r))},[r==null?void 0:r.data]);const[m]=x.useState([{headerName:"Site Name",field:"site_name"},{headerName:"Cell Name",field:"cell_name"},{headerName:"Lon",field:"lon"},{headerName:"Lat",field:"lat"},{headerName:"BB Type",field:"bb_type"},{headerName:"RRU Type",field:"rru_type"},{headerName:"Antenna Type",field:"antenna_type"},{headerName:"Frequency",field:"frequency"},{headerName:"PCI",field:"pci"},{headerName:"Azimuth",field:"azimuth"},{headerName:"Height",field:"height"},{headerName:"Last EPO",field:"last_epo"},{headerName:"Next EPO",field:"next_epo"},{headerName:"Start Date",field:"start_date"},{headerName:"End Date",field:"end_date"},{headerName:"Solution Type",field:"solution_type",cellEditor:"agSelectCellEditor",filterParams:{caseSensitive:!0,defaultOption:"startsWith"},cellEditorParams:{values:p}},{headerName:"Status",field:"status",cellEditor:"agSelectCellEditor",filterParams:{caseSensitive:!0,defaultOption:"startsWith"},cellEditorParams:{values:y}},{headerName:"Remarks",field:"remarks"},{headerName:"Artifacts",field:"artifacts",cellRenderer:ye,editable:!1},{headerName:"",field:"",editable:!1,filter:!1,cellRenderer:Ee}]),h=x.useRef(null),[b,k]=x.useState(s!=null&&s.search?s==null?void 0:s.search:""),[w,T]=x.useState(s!=null&&s.per_page?s==null?void 0:s.per_page:10),[g,E]=x.useState([]),[q,A]=x.useState(!1),[$,L]=x.useState(""),[W,H]=x.useState(null),[M,l]=x.useState([]);x.useEffect(()=>{M.length>0&&v(ue(M))},[M]);const j=n=>{const a=M.findIndex(B=>{var S,R;return B.site_id===((S=n==null?void 0:n.data)==null?void 0:S.id)&&B.loc_id===((R=n==null?void 0:n.data)==null?void 0:R.loc_id)});l(a!==-1?B=>{var R;const S=[...B];return S[a]={...S[a],items:{...S[a].items,[(R=n==null?void 0:n.colDef)==null?void 0:R.field]:n==null?void 0:n.value}},S}:B=>{var S,R,C;return[...B,{site_id:(S=n==null?void 0:n.data)==null?void 0:S.id,loc_id:(R=n==null?void 0:n.data)==null?void 0:R.loc_id,items:{[(C=n==null?void 0:n.colDef)==null?void 0:C.field]:n==null?void 0:n.value}}]})},U=n=>{h.current.click()},Y=async n=>{var B,S,R;const a=new FormData;a.append("import_file",n.target.files[0]);try{const C=await se.post(route("site.field.name.import"),a);C!=null&&C.data&&(L(C==null?void 0:C.data),A(!0))}catch(C){V.error(`${(R=(S=(B=C==null?void 0:C.response)==null?void 0:B.data)==null?void 0:S.error)==null?void 0:R.message}`)}},Q=async()=>{b&&K.get(route("site.field.name.index",{search:b}))},X=n=>{T(n),K.get(route("site.field.name.index",{...s,per_page:n}))};return x.useEffect(()=>{i!=null&&i.batch_field_id&&H(i==null?void 0:i.batch_field_id)},[]),x.useEffect(()=>{const n=async()=>{var B,S,R;try{let C=0;const O=await se.get(route("import.progress",{batchId:W}));if(O!=null&&O.data){let re=parseInt((B=O==null?void 0:O.data)==null?void 0:B.total_jobs),ie=parseInt((S=O==null?void 0:O.data)==null?void 0:S.pending_jobs),ce=re-ie;parseInt((R=O==null?void 0:O.data)==null?void 0:R.failed_jobs)>0?clearInterval(a):(C=parseInt(ce/re*100).toFixed(0),C<100?V.loading(`CSV Data Import Progress: ${C}%.
 Please wait....`,{id:"loading-toast",style:{backgroundColor:"#424242",color:"#ffffff",fontSize:14,borderRadius:4,fontWeight:"bold"}}):(V.dismiss("loading-toast"),clearInterval(a)))}}catch(C){console.log(C)}},a=setInterval(()=>{W&&n()},5e3);return()=>clearInterval(a)},[W]),e.jsxs(xe,{user:o==null?void 0:o.user,children:[e.jsx(me,{title:"FW Sites"}),e.jsx("div",{className:"top-section p-4",children:e.jsxs("div",{className:"bg-white shadow rounded py-3 px-5 flex justify-between items-center",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"",children:[e.jsx(t.Typography,{variant:"h3",className:"tracking-tight",children:"FW Site"}),e.jsxs("ul",{className:"flex gap-1 text-gray-600 text-sm",children:[e.jsx("li",{children:e.jsx(ae,{href:route("dashboard"),children:"Dashboard"})}),e.jsx("li",{children:"/"}),e.jsx("li",{children:e.jsx(ae,{href:route("site.field.name.index"),children:"FW Site"})})]})]})}),e.jsx("div",{className:"filter-wrapper md:px-4",children:e.jsxs("div",{className:"flex filter-details justify-end gap-1",children:[e.jsxs("div",{className:"search-wrapper  w-full flex relative",children:[e.jsx(Z,{placeholder:"Search...",className:"w-full text-sm rounded-md rounded-r-none border-r-0 focus:ring-0 h-8",value:b,onChange:n=>k(n.target.value)}),e.jsx("div",{className:"search-icon",children:e.jsx(t.IconButton,{size:"sm",className:"rounded-l-none",onClick:Q,children:e.jsx(fe,{color:"white",size:18})})})]}),N==="super-admin"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"import-type-field",children:[e.jsx(t.Button,{variant:"gradient",className:"capitalize",size:"sm",onClick:U,children:"Import from CSV"}),e.jsx("input",{type:"file",onChange:Y,ref:h,style:{display:"none"}})]}),e.jsx(ke,{columns:m,hidden_columns:u,deleted_columns:c||[]}),e.jsx(Ne,{type:"fw_site"})]}),e.jsx(ve,{route_name:"site.field.name.export",file_name:"FW Sites_Export"})]})})]})}),e.jsxs("div",{className:"content mt-6",children:[e.jsx(t.Card,{className:"h-full w-full rounded-none",children:e.jsxs("div",{className:"overflow-x-auto overflow-hidden",children:[(g==null?void 0:g.data)&&((G=g==null?void 0:g.data)==null?void 0:G.length)>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"ag-theme-quartz",style:{height:500},children:e.jsx(de,{rowData:g==null?void 0:g.data,columnDefs:m,defaultColDef:_,onCellValueChanged:j})}),P&&e.jsx(Pe,{tableHeader:m})]}),(g==null?void 0:g.length)===0&&e.jsx(t.Typography,{variant:"h6",color:"blue-gray",className:"text-center py-6",children:"No data found"}),e.jsxs("div",{className:"pagination flex justify-between items-center",children:[e.jsx("div",{className:"px-4",children:e.jsx(t.Button,{variant:"gradient",size:"sm",className:"capitalize rounded text-sm",onClick:()=>{v(le(!0))},children:"Add New Row"})}),e.jsxs("div",{className:"md:flex grid justify-start md:justify-end items-center pt-6 mb-8 gap-3 px-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-sm font-medium",children:"Rows per Page"}),e.jsxs("select",{className:"rounded-md text-sm font-medium border-gray-400 focus:ring-0 py-2",value:w,onChange:n=>{X(n.target.value)},children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"15",children:"15"}),e.jsx("option",{value:"20",children:"20"}),e.jsx("option",{value:"20",children:"25"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"all",children:"All"})]})]}),e.jsx("div",{className:"text-sm font-medium",children:`${r==null?void 0:r.from}-${r==null?void 0:r.to} of ${r==null?void 0:r.total} Records`}),e.jsx(je,{links:g==null?void 0:g.links,perPage:w})]})]})]})}),e.jsx(ge,{mappingDialog:q,setMappingDialog:A,mappingData:$,setBatchId:H})]})]})}export{Ve as default};
