import{R as w,W as z,j as e}from"./app-MeaRoDMw.js";import{r as t}from"./index-Ck9CppQy.js";import{u as C,F as I,I as R}from"./index-B1ynsPwE.js";import{D as U}from"./download-_xNUqRhz.js";function J(l){var h;const{data:s}=l,a=()=>p(!m),[m,p]=w.useState(!1),{data:c,setData:j,post:u,processing:g,reset:N}=z({site_id:s==null?void 0:s.id,location_id:s==null?void 0:s.loc_id,field_name:(h=l==null?void 0:l.colDef)==null?void 0:h.field,artifacts:[]}),{getRootProps:v,getInputProps:F}=C({onDrop:n=>{j("artifacts",[...c.artifacts,...n.map(o=>Object.assign(o,{preview:URL.createObjectURL(o)}))])}}),b=c==null?void 0:c.artifacts.map(n=>e.jsxs("li",{children:[n.path," - ",n.size," bytes"]},n.path)),O=()=>{u(route("wireless.sites.update.artifacts"),{preserveScroll:!0,onSuccess:()=>{N(),p(!1)}})},S=({files:n})=>{if(n){const o=JSON.parse(n),d=r=>r.split(".").pop(),f=r=>{const i=r.split("/");let x=i[i.length-1];return x=x.replace(/^\d+_/,""),x};return e.jsx("div",{className:"flex ps-2",children:o.map((r,i)=>e.jsxs("div",{className:"",children:[d(r)==="csv"&&e.jsx(t.Tooltip,{content:f(r),children:e.jsx(I,{size:18})}),d(r)==="txt"&&e.jsx("img",{src:"txt-icon.png",alt:"Text File Icon"}),d(r)==="pdf"&&e.jsx(t.Tooltip,{content:f(r),children:e.jsx(R,{})})]},i))})}};return s!=null&&s.artifacts&&console.log(JSON.parse(s==null?void 0:s.artifacts)[0]),e.jsxs("div",{className:"w-full h-full",children:[e.jsxs("div",{className:"flex justify-center items-center",children:[" ",e.jsx("button",{className:"font-medium text-[12px] w-[70%]",onClick:a,children:"upload"}),e.jsxs(e.Fragment,{children:[" ",(s==null?void 0:s.artifacts)&&e.jsx("a",{href:`/dashboard/wireless-sites/artifacts/?q=${JSON.parse(s==null?void 0:s.artifacts)}`,children:e.jsx(U,{className:"cursor-pointer",size:20})})]})]}),(s==null?void 0:s.artifacts)&&e.jsx(e.Fragment,{children:JSON.parse(s==null?void 0:s.artifacts).length>0&&e.jsx(S,{files:s!=null&&s.value?s==null?void 0:s.value:""})}),e.jsxs(t.Dialog,{open:m,handler:a,size:"xs",children:[e.jsx(t.DialogHeader,{children:"Upload Artifacts"}),e.jsxs(t.DialogBody,{children:[e.jsx("div",{className:"border-dashed border py-12 text-sm text-center font-medium rounded-md border-gray-300",children:e.jsxs("div",{...v({className:"dropzone"}),children:[e.jsx("input",{...F()}),e.jsx("p",{children:"Drag 'n' drop some files here, or click to select files"})]})}),(c==null?void 0:c.artifacts.length)>0&&e.jsxs("aside",{children:[e.jsx("h4",{className:"font-sm font-semibold",children:"Files"}),e.jsx("ul",{className:"text-[12px] font-normal",children:b})]})]}),e.jsxs(t.DialogFooter,{children:[e.jsx(t.Button,{variant:"text",color:"red",onClick:a,className:"mr-1",children:e.jsx("span",{children:"Cancel"})}),e.jsx(t.Button,{variant:"gradient",color:"green",onClick:O,loading:g,children:e.jsx("span",{children:"Confirm"})})]})]})]})}export{J as U};
