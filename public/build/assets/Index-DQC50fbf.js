import{W as Y,j as e,r as f,R as D,b as se,y as U,u as ee,c as te,i as oe,k as le,l as ue,Y as me,a as re}from"./app-CIRcvYGN.js";import{r as t}from"./index-6jRPV5pi.js";import{_ as J,A as xe}from"./AuthenticatedLayout-BtjXaohP.js";import{T as Z}from"./TextInput-_gAuWY6g.js";import{I as P}from"./InputLabel-CwVRJKMl.js";import{I as z}from"./InputError-CXbk0JLM.js";import{M as he,T as ne,S as fe,P as je}from"./Pagination-CjISjZn-.js";import{A as de,R as Ne,E as ve}from"./ag-theme-quartz-BsbbgXLY.js";import{U as ye}from"./UploadItem-DwxJk60t.js";import"./transition-prLGfJeh.js";import"./index-C6kzJobj.js";function we({addColumnDialog:o,setAddColumnDialog:a}){const{data:s,setData:d,post:n,processing:c,errors:u,reset:i}=Y({type:"wntd",name:"",key:"",input_type:"",options:""}),H=v=>{v.preventDefault(),n(route("additional.columns.save.item"),{onSuccess:()=>{a(!1),i()}})};return e.jsxs(t.Dialog,{open:o,size:"xs",children:[e.jsx(t.DialogHeader,{children:"Add New Column"}),e.jsxs(t.DialogBody,{children:[e.jsxs("div",{className:"form-item mb-4",children:[e.jsx(P,{value:"Column Name",className:"mb-1"}),e.jsx(Z,{className:"w-full text-sm font-medium text-gray-600",placeholder:"Column Name...",value:s.name,onChange:v=>d("name",v.target.value)}),e.jsx(z,{message:u.name,className:"text-sm font-medium"})]}),e.jsxs("div",{className:"form-item mb-4",children:[e.jsx(P,{value:"Column Key",className:"mb-1"}),e.jsx(Z,{className:"w-full text-sm font-medium text-gray-600",placeholder:"Column key...",value:s.key,onChange:v=>d("key",v.target.value)}),e.jsx(z,{message:u.key,className:"text-sm font-medium"})]}),e.jsxs("div",{className:"form-item mb-4",children:[e.jsx(P,{value:"Column Input Type",className:"mb-1"}),e.jsxs("select",{className:"w-full rounded text-sm border-gray-300 shadow-sm font-medium text-gray-600 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600",value:s.input_type,onChange:v=>d("input_type",v.target.value),children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"text",children:"Text"}),e.jsx("option",{value:"date",children:"Date"}),e.jsx("option",{value:"dropdown",children:"DropDown"})]}),e.jsx(z,{message:u.input_type,className:"text-sm font-medium"})]}),(s==null?void 0:s.input_type)==="dropdown"&&e.jsxs("div",{className:"form-item mb-4",children:[e.jsx(P,{value:"Dropdown Options seprated by (|)",className:"mb-1"}),e.jsx("textarea",{className:"w-full rounded text-sm border-gray-300 shadow-sm font-normal focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600",placeholder:"Dropdown Options seprated by | ...",rows:4,value:s.options,onChange:v=>d("options",v.target.value)}),e.jsx(z,{message:u.options,className:"text-sm font-medium"})]})]}),e.jsxs(t.DialogFooter,{children:[e.jsx(t.Button,{variant:"text",color:"red",onClick:()=>a(!o),className:"mr-1 capitalize",children:e.jsx("span",{children:"Cancel"})}),e.jsx(t.Button,{variant:"gradient",color:"green",onClick:v=>H(v),className:"capitalize",loading:c,children:e.jsx("span",{children:"Submit"})})]})]})}function ge({hideColumnDialog:o,setHideColumnDialog:a,columns:s,hidden_columns:d,deleted_columns:n}){const c=()=>a(!o),[u,i]=f.useState([]),{data:H,setData:v,post:m,processing:b,errors:g,reset:C}=Y({type:"wntd",key:"hide",items:(d==null?void 0:d.length)>0?d:[]});f.useEffect(()=>{o&&i(j=>[...s.filter(E=>!n.includes(E.key)).map(E=>({key:E.key,name:E.name}))])},[o]);const y=(j,k)=>{const E=j.target.checked;v(p=>E?{...p,items:[...p.items,k]}:{...p,items:p.items.filter(T=>T!==k)})},x=j=>{j.preventDefault(),m(route("hide.columns.item"),{onSuccess:()=>{a(!1),C()}})};return e.jsxs(t.Dialog,{open:o,size:"xs",children:[e.jsx(t.DialogHeader,{children:"Hide Column"}),e.jsx(t.DialogBody,{children:e.jsxs("div",{className:"form-item",children:[e.jsx("p",{className:"text-[#333] font-semibold",children:"Please select the column you want to hide"}),e.jsx("div",{className:"form-item grid grid-cols-2",children:(u==null?void 0:u.length)>0&&u.map((j,k)=>e.jsx(D.Fragment,{children:e.jsx(t.Checkbox,{containerProps:{className:"py-3"},className:"w-5 h-5 rounded-md",label:e.jsx(t.Typography,{color:"blue-gray",className:"font-medium text-sm",children:j==null?void 0:j.name}),onChange:E=>y(E,j==null?void 0:j.key),defaultChecked:d==null?void 0:d.includes(j==null?void 0:j.key)})},k))})]})}),e.jsxs(t.DialogFooter,{children:[e.jsx(t.Button,{variant:"text",color:"red",onClick:c,className:"mr-1 capitalize",children:e.jsx("span",{children:"Cancel"})}),e.jsx(t.Button,{variant:"gradient",color:"green",onClick:j=>{x(j)},className:"capitalize",loading:b,children:e.jsx("span",{children:"Confirm"})})]})]})}function Ce({renameColumnDialog:o,setRenameColumnDialog:a,columns:s,deleted_columns:d}){var g;const{data:n,setData:c,post:u,processing:i,errors:H,reset:v}=Y({type:"wntd",key:"rename",items:[]});f.useEffect(()=>{o&&c(C=>{const y=[...s.filter(x=>!d.includes(x.key)).map(x=>({key:x.key,name:x.name}))];return{...C,items:y}})},[o]);const m=(C,y)=>{c(x=>({...x,items:x.items.map(j=>j.key===C?{...j,name:y}:j)}))},b=C=>{C.preventDefault(),u(route("rename.columns.item"),{onSuccess:()=>{a(!1),v()}})};return e.jsxs(t.Dialog,{open:o,size:"xs",children:[e.jsx(t.DialogHeader,{children:"Rename Columns"}),e.jsx(t.DialogBody,{className:"max-h-[42rem] overflow-scroll",children:e.jsx("div",{className:"grid grid-cols-2 gap-3",children:(n==null?void 0:n.items.length)>0&&((g=n==null?void 0:n.items)==null?void 0:g.map((C,y)=>e.jsx("div",{className:"form-item mb-2",children:e.jsx(Z,{className:"w-full text-sm font-medium text-gray-600",value:C==null?void 0:C.name,onChange:x=>m(C==null?void 0:C.key,x.target.value)})},y)))})}),e.jsxs(t.DialogFooter,{children:[e.jsx(t.Button,{variant:"text",color:"red",className:"mr-1 capitalize",onClick:()=>a(!1),children:"Cancel"}),e.jsx(t.Button,{variant:"gradient",color:"green",className:"capitalize",onClick:C=>b(C),loading:i,children:"Submit"})]})]})}function be({deleteColumnDialog:o,setDeleteColumnDialog:a,columns:s,deleted_columns:d}){const{data:n,setData:c,post:u,processing:i,errors:H,reset:v}=Y({type:"wntd",key:"delete",items:[]}),[m,b]=f.useState([]);f.useEffect(()=>{o&&b(y=>[...s.filter(j=>!d.includes(j.key)).map(j=>({key:j.key,name:j.name}))])},[o]);const g=(y,x)=>{const j=y.target.checked;c(k=>j?{...k,items:[...k.items,x]}:{...k,items:k.items.filter(E=>E!==x)})},C=y=>{y.preventDefault(),u(route("delete.columns.item"),{onSuccess:()=>{a(!1),v()}})};return e.jsxs(t.Dialog,{open:o,size:"xs",children:[e.jsx(t.DialogHeader,{children:"Delete Columns"}),e.jsx(t.DialogBody,{className:"max-h-[42rem] overflow-scroll",children:e.jsxs("div",{className:"form-item",children:[e.jsx("p",{className:"text-[#333] font-semibold",children:"Please select the column you want to delete."}),e.jsx("div",{className:"grid grid-cols-2",children:(m==null?void 0:m.length)>0&&m.map((y,x)=>e.jsx(D.Fragment,{children:e.jsx(t.Checkbox,{containerProps:{className:"py-3"},className:"w-5 h-5 rounded-md",label:e.jsx(t.Typography,{color:"blue-gray",className:"font-medium text-sm",children:y==null?void 0:y.name}),onChange:j=>{g(j,y==null?void 0:y.key)}})},x))})]})}),e.jsxs(t.DialogFooter,{children:[e.jsx(t.Button,{variant:"text",color:"red",className:"mr-1 capitalize",onClick:()=>a(!1),children:"Cancel"}),e.jsx(t.Button,{variant:"gradient",color:"green",className:"capitalize",onClick:y=>{C(y)},loading:i,children:"Submit"})]})]})}function pe({arrangeColumnDialog:o,setArrangeColumnDialog:a,columns:s,deleted_columns:d}){const[n,c]=f.useState([]),[u,i]=f.useState(null),{data:H,setData:v,post:m,processing:b,errors:g,reset:C}=Y({type:"wntd",key:"arrange",items:[]});f.useEffect(()=>{o&&c(p=>[...(B=>B.map(($,F)=>({...$,position:F+1})))(s.filter(B=>!d.includes(B.key)).map(B=>({key:B.key,name:B.name})))])},[o]);const y=(p,T)=>{i(T)},x=()=>{i(null)},j=p=>{p.preventDefault()},k=(p,T)=>{if(!u)return;const w=n.indexOf(u),B=n.indexOf(T);if(w!==-1&&B!==-1){const F=[...(M=>M.map((l,N)=>({...l,position:N+1})))(n)],[L]=F.splice(w,1);F.splice(B,0,L);const W=F.map((M,l)=>({...M,position:l+1}));c(W);const A=W.map(M=>({key:M.key,position:M.position}));v("items",A)}},E=p=>{p.preventDefault(),m(route("rearrange.columns.item"),{onSuccess:()=>{a(!1),C()}})};return e.jsxs(t.Dialog,{open:o,size:"xs",children:[e.jsx(t.DialogHeader,{children:"Re-arrange Columns"}),e.jsxs(t.DialogBody,{className:"max-h-[42rem] overflow-scroll",children:[e.jsx("p",{className:"text-[#333] font-semibold mb-3",children:"Please drag and drop the column you want to arrange."}),e.jsx("div",{className:"draggable-wrapper border rounded-md py-2",children:(n==null?void 0:n.length)>0&&(n==null?void 0:n.map((p,T)=>e.jsx("div",{className:"text-gray-600 font-medium py-1 px-2 text-sm  cursor-move",draggable:"true",onDragStart:w=>y(w,p),onDragEnd:x,onDragOver:j,onDrop:w=>k(w,p),children:e.jsxs("div",{className:"flex items-center gap-3 border py-2 px-2 rounded-md ",children:[e.jsx("div",{className:"icon-wrapper",children:e.jsx(he,{strokeWidth:1.5,size:18})}),p.name]})},T)))})]}),e.jsxs(t.DialogFooter,{children:[e.jsx(t.Button,{variant:"text",color:"red",className:"mr-1 capitalize",onClick:()=>a(!1),children:"cancel"}),e.jsx(t.Button,{variant:"gradient",color:"green",className:"capitalize",onClick:p=>E(p),loading:b,children:"Submit"})]})]})}function Se({columns:o,hidden_columns:a,deleted_columns:s}){const[d,n]=f.useState(!1),[c,u]=f.useState(!1),[i,H]=f.useState(!1),[v,m]=f.useState(!1),[b,g]=f.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(t.Menu,{children:[e.jsx(t.MenuHandler,{children:e.jsx(t.Button,{variant:"gradient",size:"sm",className:"capitalize",children:"Column Options"})}),e.jsxs(t.MenuList,{className:"font-semibold text-gray-600",children:[e.jsx(t.MenuItem,{onClick:()=>{n(!0)},children:"Add Column"}),e.jsx(t.MenuItem,{onClick:()=>{u(!0)},children:"Show/Hide Columns"}),e.jsx(t.MenuItem,{onClick:()=>{H(!0)},children:"Rename Columns"}),e.jsx(t.MenuItem,{onClick:()=>{g(!0)},children:"Rearrange Columns"}),e.jsx(t.MenuItem,{onClick:()=>{m(!0)},className:"text-red-500",children:"Delete Columns"})]})]}),e.jsx(we,{addColumnDialog:d,setAddColumnDialog:n}),e.jsx(ge,{hideColumnDialog:c,setHideColumnDialog:u,columns:o,hidden_columns:a,deleted_columns:s}),e.jsx(Ce,{renameColumnDialog:i,setRenameColumnDialog:H,columns:o,deleted_columns:s}),e.jsx(be,{deleteColumnDialog:v,setDeleteColumnDialog:m,columns:o,deleted_columns:s}),e.jsx(pe,{arrangeColumnDialog:b,setArrangeColumnDialog:g,columns:o,deleted_columns:s})]})}function _e({mappingDialog:o,setMappingDialog:a,mappingData:s,setBatchId:d}){var k,E,p,T,w,B,$,F,L,W,A,M;const n=()=>a(!o),[c,u]=f.useState({file_path:s?s==null?void 0:s.filePath:"",loc_id:"",wntd:"",imsi:"",version:"",avc:"",bw_profile:"",lon:"",lat:"",site_name:"",home_cell:"",home_pci:"",traffic_profile:""}),[i,H]=f.useState({}),[v,m]=f.useState(!1),[b,g]=f.useState(""),[C,y]=f.useState(""),x=(l,N)=>{u(V=>({...V,[l]:N}))};f.useEffect(()=>{x("file_path",s!=null&&s.filePath?s==null?void 0:s.filePath:"")},[s]);const j=async l=>{var V,G,K,Q,X,q;l.preventDefault();let N={};if(["loc_id","wntd","imsi","version","avc","bw_profile","lon","lat","site_name","home_cell","home_pci","traffic_profile"].forEach(r=>{c[r]||(N[r]="This field is required.")}),H(N),Object.keys(N).length>0){console.log(N);return}try{m(!0);const r=await se.post(route("wireless.sites.map.save"),c);r!=null&&r.data&&(y((G=(V=r==null?void 0:r.data)==null?void 0:V.success)==null?void 0:G.message),d((K=r==null?void 0:r.data)==null?void 0:K.batch_id),setTimeout(()=>{a(!1),y(""),g("")},3e3),U.visit(route("wireless.sites.index")))}catch(r){console.log("error:",r),g(`${(q=(X=(Q=r==null?void 0:r.response)==null?void 0:Q.data)==null?void 0:X.error)==null?void 0:q.message}`)}finally{m(!1)}};return e.jsx(D.Fragment,{children:e.jsxs(t.Dialog,{open:o,size:"xs",children:[e.jsx(t.DialogHeader,{children:"CSV Mapping"}),b&&e.jsx("p",{className:"text-red-500 font-medium text-[12px] px-4",children:b}),C&&e.jsx("p",{className:"text-green-500 font-medium text-[12px] px-4",children:C}),e.jsxs(t.DialogBody,{className:"px-6 overflow-scroll",children:[e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(P,{value:"LOCID",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:c.loc_id,onChange:l=>x("loc_id",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((k=s==null?void 0:s.header)==null?void 0:k.length)>0&&(s==null?void 0:s.header.map((l,N)=>e.jsx("option",{value:l,children:l},N)))]}),e.jsx(z,{message:i.loc_id,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(P,{value:"WNTD",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:c.wntd,onChange:l=>x("wntd",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((E=s==null?void 0:s.header)==null?void 0:E.length)>0&&(s==null?void 0:s.header.map((l,N)=>e.jsx("option",{value:l,children:l},N)))]}),e.jsx(z,{message:i.wntd,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(P,{value:"IMSI",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:c.imsi,onChange:l=>x("imsi",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((p=s==null?void 0:s.header)==null?void 0:p.length)>0&&(s==null?void 0:s.header.map((l,N)=>e.jsx("option",{value:l,children:l},N)))]}),e.jsx(z,{message:i.imsi,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(P,{value:"VERSION",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:c.version,onChange:l=>x("version",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((T=s==null?void 0:s.header)==null?void 0:T.length)>0&&(s==null?void 0:s.header.map((l,N)=>e.jsx("option",{value:l,children:l},N)))]}),e.jsx(z,{message:i.version,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(P,{value:"AVC",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:c.avc,onChange:l=>x("avc",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((w=s==null?void 0:s.header)==null?void 0:w.length)>0&&(s==null?void 0:s.header.map((l,N)=>e.jsx("option",{value:l,children:l},N)))]}),e.jsx(z,{message:i.avc,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(P,{value:"BW Profile",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:c.bw_profile,onChange:l=>x("bw_profile",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((B=s==null?void 0:s.header)==null?void 0:B.length)>0&&(s==null?void 0:s.header.map((l,N)=>e.jsx("option",{value:l,children:l},N)))]}),e.jsx(z,{message:i.bw_profile,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(P,{value:"Lon",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:c.lon,onChange:l=>x("lon",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),(($=s==null?void 0:s.header)==null?void 0:$.length)>0&&(s==null?void 0:s.header.map((l,N)=>e.jsx("option",{value:l,children:l},N)))]}),e.jsx(z,{message:i.lon,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(P,{value:"Lat",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:c.lat,onChange:l=>x("lat",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((F=s==null?void 0:s.header)==null?void 0:F.length)>0&&(s==null?void 0:s.header.map((l,N)=>e.jsx("option",{value:l,children:l},N)))]}),e.jsx(z,{message:i.lat,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(P,{value:"SiteName",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:c.site_name,onChange:l=>x("site_name",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((L=s==null?void 0:s.header)==null?void 0:L.length)>0&&(s==null?void 0:s.header.map((l,N)=>e.jsx("option",{value:l,children:l},N)))]}),e.jsx(z,{message:i.site_name,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(P,{value:"HomeCell",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:c.home_cell,onChange:l=>x("home_cell",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((W=s==null?void 0:s.header)==null?void 0:W.length)>0&&(s==null?void 0:s.header.map((l,N)=>e.jsx("option",{value:l,children:l},N)))]}),e.jsx(z,{message:i.home_cell,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(P,{value:"HomePCI",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:c.home_pci,onChange:l=>x("home_pci",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((A=s==null?void 0:s.header)==null?void 0:A.length)>0&&(s==null?void 0:s.header.map((l,N)=>e.jsx("option",{value:l,children:l},N)))]}),e.jsx(z,{message:i.home_pci,className:"!text-[12px] font-medium"})]})]})}),e.jsx("div",{className:"form-item mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(P,{value:"Traffic_Profile",className:"w-1/3"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("select",{className:"w-full font-medium text-[12px] py-1 rounded-md border-gray-300",value:c.traffic_profile,onChange:l=>x("traffic_profile",l.target.value),children:[e.jsx("option",{value:"",children:"Select"}),((M=s==null?void 0:s.header)==null?void 0:M.length)>0&&(s==null?void 0:s.header.map((l,N)=>e.jsx("option",{value:l,children:l},N)))]}),e.jsx(z,{message:i.traffic_profile,className:"!text-[12px] font-medium"})]})]})})]}),e.jsxs(t.DialogFooter,{children:[e.jsx(t.Button,{variant:"text",color:"red",onClick:n,className:"mr-1",disabled:v,children:e.jsx("span",{children:"Cancel"})}),e.jsx(t.Button,{variant:"gradient",color:"green",onClick:j,loading:v,children:e.jsx("span",{children:"Confirm"})})]})]})})}function ke(o){const{changedData:a}=ee(d=>d.table),s=async()=>{var d,n,c;if(a.length>0){let u=a.filter(i=>i.site_id===o.data.id)[0];if(u){const i=await axios.post(route("wireless.sites.save.item"),{site_id:u==null?void 0:u.site_id,location_id:u==null?void 0:u.loc_id,items:u==null?void 0:u.items});(d=i==null?void 0:i.data)!=null&&d.success&&J.success((c=(n=i==null?void 0:i.data)==null?void 0:n.success)==null?void 0:c.message)}}};return e.jsx(t.Button,{size:"sm",className:"capitalize py-1 px-2 rounded font-semibold",onClick:()=>{s()},children:"Save"})}function Ie(o){const{processing:a,delete:s}=Y(),[d,n]=f.useState(!1),c={onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1)},u=()=>{s(route("wireless.sites.destroy",o.data.id),{preserveScroll:!0,onSuccess:()=>{U.visit(route("wireless.sites.index"))}})};return e.jsx(D.Fragment,{children:e.jsxs(t.Popover,{placement:"top-end",open:d,handler:n,children:[e.jsx(t.PopoverHandler,{...c,children:e.jsx(t.Button,{variant:"gradient",color:"red",size:"sm",className:"capitalize py-1 px-2 rounded",onClick:()=>setOpen(!0),children:e.jsx(ne,{size:14})})}),e.jsxs(t.PopoverContent,{...c,className:"px-3",children:[e.jsx(t.Typography,{variant:"h6",className:"text-center",children:"Are you sure?"}),e.jsx(t.Typography,{variant:"small",className:"font-normal",children:"This cannot be reverted back."}),e.jsxs("div",{className:"mt-2 flex justify-between",children:[e.jsx(t.Button,{variant:"text",color:"red",size:"sm",className:"capitalize rounded",onClick:()=>n(!1),children:"Cancel"}),e.jsx(t.Button,{variant:"gradient",color:"red",size:"sm",className:"capitalize rounded",onClick:u,children:"Delete"})]})]})]})})}const Ee=()=>{const o=te(),{addNewRowData:a}=ee(n=>n.table),s=n=>{if(n.preventDefault(),!a.loc_id)return J.error("LocId is required");U.post(route("wireless.sites.add.row"),a,{onSuccess:()=>{o(le(!1)),J.success("Row Added successfully")}})},d=()=>{o(le(!1)),oe({})};return e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsx(t.Button,{variant:"gradient",size:"sm",className:"capitalize py-1 px-2 rounded font-semibold",onClick:s,children:"Save"}),e.jsx(t.Button,{variant:"gradient",color:"red",size:"sm",className:"capitalize py-1 px-2 rounded",onClick:d,children:e.jsx(ne,{size:14})})]})};function Pe({setAddNewRow:o}){const a=te(),{addNewRowData:s}=ee(m=>m.table),d=["device_upgrade","reparent","repan","opti_type_1","opti_type_5","opti_type_6","epo"],n=["in_progress","not_started","completed"],c=f.useMemo(()=>({editable:!0})),[u]=f.useState([{headerName:"LOCID",field:"loc_id"},{headerName:"WNTD",field:"wntd"},{headerName:"IMSI",field:"imsi"},{headerName:"VERSION",field:"version"},{headerName:"AVC",field:"avc"},{headerName:"BW Profile",field:"bw_profile"},{headerName:"Lon",field:"lon"},{headerName:"Lat",field:"lat"},{headerName:"SiteName",field:"site_name"},{headerName:"HomeCell",field:"home_cell"},{headerName:"HomePCI",field:"home_pci"},{headerName:"Traffic Profile",field:"traffic_profile"},{headerName:"Start Date",field:"start_date",input_type:"date",valueFormatter:m=>{if(!m.value)return"";const b=m.value.getMonth()+1,g=m.value.getDate();return`${m.value.getFullYear()}-${b<10?"0"+b:b}-${g<10?"0"+g:g}`},cellEditor:"agDateCellEditor"},{headerName:"End Date",field:"end_date",valueFormatter:m=>{if(!m.value)return"";const b=m.value.getMonth()+1,g=m.value.getDate();return`${m.value.getFullYear()}-${b<10?"0"+b:b}-${g<10?"0"+g:g}`},cellEditor:"agDateCellEditor"},{headerName:"Solution Type",field:"solution_type",cellEditor:"agSelectCellEditor",filterParams:{caseSensitive:!0,defaultOption:"startsWith"},cellEditorParams:{values:d}},{headerName:"Status",field:"status",cellEditor:"agSelectCellEditor",filterParams:{caseSensitive:!0,defaultOption:"startsWith"},cellEditorParams:{values:n}},{headerName:"Remarks",field:"remarks"},{headerName:"Artifacts",field:"artifacts",editable:!1},{headerName:"",field:"",editable:!1,cellRenderer:Ee}]),[i,H]=f.useState([{loc_id:"",wntd:"",imsi:"",version:"",avc:"",bw_profile:"",lon:"",lat:"",site_name:"",home_cell:"",home_pci:"",traffic_profile:"",deleted_at:null,remarks:"",artifacts:"",solution_type:"",start_date:new Date,status:"",end_date:new Date}]),v=m=>{var g;const b={...s};a(oe({...b,[(g=m==null?void 0:m.colDef)==null?void 0:g.field]:m==null?void 0:m.value}))};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"overflow-x-auto overflow-hidden",children:e.jsx("div",{className:"ag-theme-quartz",style:{height:100},children:e.jsx(de,{rowData:i,columnDefs:u,defaultColDef:c,onCellValueChanged:v})})})})}const ze=o=>e.jsxs("div",{className:"flex gap-5 my-2",children:[e.jsx(ke,{...o}),e.jsx(Ie,{...o})]}),Be=o=>{var a,s;return e.jsx(re,{href:route("wireless.show.location.index",(a=o==null?void 0:o.data)==null?void 0:a.id),className:"font-semibold underline",children:(s=o==null?void 0:o.data)==null?void 0:s.loc_id})};function Ye({auth:o,sites:a,get_data:s,batch:d,additional_columns:n,hidden_columns:c,renamed_columns:u,deleted_columns:i,arrange_columns:H}){var q;const v=te(),m=f.useMemo(()=>({editable:!0,filter:!0})),{addNewRow:b}=ee(r=>r.table),{role:g}=o,C=["device_upgrade","reparent","repan","opti_type_1","opti_type_5","opti_type_6","epo"],y=["in_progress","not_started","completed"];f.useEffect(()=>{var r;((r=a==null?void 0:a.data)==null?void 0:r.length)>0&&(a==null||a.data.map(h=>{if(h.end_date||h.start_date){let S=h!=null&&h.end_date?new Date(h==null?void 0:h.end_date):new Date,I=h!=null&&h.start_date?new Date(h==null?void 0:h.start_date):new Date;h.start_date=I,h.end_date=S}return h}),B(a))},[a==null?void 0:a.data]);const[x]=f.useState([{headerName:"LOCID",field:"loc_id",editable:!1,cellRenderer:Be},{headerName:"WNTD",field:"wntd"},{headerName:"IMSI",field:"imsi"},{headerName:"VERSION",field:"version"},{headerName:"AVC",field:"avc"},{headerName:"BW Profile",field:"bw_profile"},{headerName:"Lon",field:"lon"},{headerName:"Lat",field:"lat"},{headerName:"SiteName",field:"site_name"},{headerName:"HomeCell",field:"home_cell"},{headerName:"HomePCI",field:"home_pci"},{headerName:"Traffic Profile",field:"traffic_profile"},{headerName:"Start Date",field:"start_date",input_type:"date",valueFormatter:r=>{if(!r.value)return"";const h=r.value.getMonth()+1,S=r.value.getDate();return`${r.value.getFullYear()}-${h<10?"0"+h:h}-${S<10?"0"+S:S}`},cellEditor:"agDateCellEditor",filter:!1},{headerName:"End Date",field:"end_date",valueFormatter:r=>{if(!r.value)return"";const h=r.value.getMonth()+1,S=r.value.getDate();return`${r.value.getFullYear()}-${h<10?"0"+h:h}-${S<10?"0"+S:S}`},cellEditor:"agDateCellEditor",filter:!1},{headerName:"Solution Type",field:"solution_type",cellEditor:"agSelectCellEditor",filterParams:{caseSensitive:!0,defaultOption:"startsWith"},cellEditorParams:{values:C}},{headerName:"Status",field:"status",cellEditor:"agSelectCellEditor",filterParams:{caseSensitive:!0,defaultOption:"startsWith"},cellEditorParams:{values:y}},{headerName:"Remarks",field:"remarks"},{headerName:"Artifacts",field:"artifacts",cellRenderer:ye,editable:!1},{headerName:"",field:"",editable:!1,filter:!1,cellRenderer:ze}]),j=f.useRef(null),[k,E]=f.useState(s!=null&&s.search?s==null?void 0:s.search:""),[p,T]=f.useState(s!=null&&s.per_page?s==null?void 0:s.per_page:10),[w,B]=f.useState([]),[$,F]=f.useState(!1),[L,W]=f.useState(""),[A,M]=f.useState(null),[l,N]=f.useState([]);f.useEffect(()=>{l.length>0&&v(ue(l))},[l]);const V=r=>{const h=l.findIndex(S=>{var I,R;return S.site_id===((I=r==null?void 0:r.data)==null?void 0:I.id)&&S.loc_id===((R=r==null?void 0:r.data)==null?void 0:R.loc_id)});N(h!==-1?S=>{var R;const I=[...S];return I[h]={...I[h],items:{...I[h].items,[(R=r==null?void 0:r.colDef)==null?void 0:R.field]:r==null?void 0:r.value}},I}:S=>{var I,R,_;return[...S,{site_id:(I=r==null?void 0:r.data)==null?void 0:I.id,loc_id:(R=r==null?void 0:r.data)==null?void 0:R.loc_id,items:{[(_=r==null?void 0:r.colDef)==null?void 0:_.field]:r==null?void 0:r.value}}]})},G=r=>{j.current.click()},K=async r=>{var S,I,R;const h=new FormData;h.append("import_file",r.target.files[0]);try{const _=await se.post(route("wireless.sites.import"),h);_!=null&&_.data&&(W(_==null?void 0:_.data),F(!0))}catch(_){J.error(`${(R=(I=(S=_==null?void 0:_.response)==null?void 0:S.data)==null?void 0:I.error)==null?void 0:R.message}`)}},Q=async()=>{U.get(route("wireless.sites.index",{search:k}))},X=r=>{T(r),U.get(route("wireless.sites.index",{...s,per_page:r}))};return f.useEffect(()=>{d!=null&&d.batch_site_id&&M(d==null?void 0:d.batch_site_id)},[]),f.useEffect(()=>{const r=async()=>{var S,I,R;try{let _=0;const O=await se.get(route("import.progress",{batchId:A}));if(O!=null&&O.data){let ae=parseInt((S=O==null?void 0:O.data)==null?void 0:S.total_jobs),ie=parseInt((I=O==null?void 0:O.data)==null?void 0:I.pending_jobs),ce=ae-ie;parseInt((R=O==null?void 0:O.data)==null?void 0:R.failed_jobs)>0?clearInterval(h):(_=parseInt(ce/ae*100).toFixed(0),_<100?J.loading(`CSV Data Import Progress: ${_}%.
 Please wait....`,{id:"loading-toast",style:{backgroundColor:"#424242",color:"#ffffff",fontSize:14,borderRadius:4,fontWeight:"bold"}}):(J.dismiss("loading-toast"),clearInterval(h)))}}catch(_){console.log(_)}},h=setInterval(()=>{A&&r()},5e3);return()=>clearInterval(h)},[A]),e.jsxs(xe,{user:o==null?void 0:o.user,children:[e.jsx(me,{title:"WNTD"}),e.jsx("div",{className:"top-section p-4",children:e.jsxs("div",{className:"bg-white shadow rounded py-3 px-5 flex justify-between items-center",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"",children:[e.jsx(t.Typography,{variant:"h3",className:"tracking-tight",children:"WNTD"}),e.jsxs("ul",{className:"flex gap-1 text-gray-600 text-sm",children:[e.jsx("li",{children:e.jsx(re,{href:route("dashboard"),children:"Dashboard"})}),e.jsx("li",{children:"/"}),e.jsx("li",{children:e.jsx(re,{href:route("wireless.sites.index"),children:"WNTD"})})]})]})}),e.jsx("div",{className:"filter-wrapper md:px-4",children:e.jsxs("div",{className:"flex filter-details justify-end gap-2",children:[e.jsxs("div",{className:"search-wrapper w-full flex relative",children:[e.jsx(Z,{placeholder:"Search...",className:"w-full text-sm rounded-md rounded-r-none border-r-0 focus:ring-0 h-8",value:k,onChange:r=>E(r.target.value)}),e.jsx("div",{className:"search-icon",children:e.jsx(t.IconButton,{size:"sm",className:"rounded-l-none",onClick:Q,children:e.jsx(fe,{color:"white",size:18})})})]}),g==="super-admin"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"import-type-field",children:[e.jsx(t.Button,{variant:"gradient",className:"capitalize",size:"sm",onClick:G,children:"Import from CSV"}),e.jsx("input",{type:"file",onChange:K,ref:j,style:{display:"none"}})]}),e.jsx(Se,{columns:x,hidden_columns:c,deleted_columns:i||[]}),e.jsx(Ne,{type:"wntd"})]}),e.jsx(ve,{route_name:"wireless.sites.export",file_name:"WNTD_Export"})]})})]})}),e.jsxs("div",{className:"content mt-6",children:[e.jsxs(t.Card,{className:"h-full w-full rounded-none",children:[e.jsxs("div",{className:"overflow-x-auto overflow-hidden",children:[(w==null?void 0:w.data)&&((q=w==null?void 0:w.data)==null?void 0:q.length)>0&&e.jsxs(e.Fragment,{children:[" ",e.jsx("div",{className:"ag-theme-quartz",style:{height:500},children:e.jsx(de,{rowData:w==null?void 0:w.data,columnDefs:x,defaultColDef:m,onCellValueChanged:V})}),b&&e.jsx(Pe,{tableHeader:x})]}),(w==null?void 0:w.length)===0&&e.jsx(t.Typography,{variant:"h6",color:"blue-gray",className:"text-center py-6",children:"No data found"})]}),e.jsxs("div",{className:"pagination flex justify-between items-center",children:[e.jsx("div",{className:"px-4",children:e.jsx(t.Button,{variant:"gradient",size:"sm",className:"capitalize rounded text-sm",onClick:()=>{v(le(!0))},children:"Add New Row"})}),e.jsxs("div",{className:"md:flex grid justify-start md:justify-end items-center pt-6 mb-8 gap-3 px-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-sm font-medium",children:"Rows per Page"}),e.jsxs("select",{className:"rounded-md text-sm font-medium border-gray-400 focus:ring-0 py-2",value:p,onChange:r=>{X(r.target.value)},children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"15",children:"15"}),e.jsx("option",{value:"20",children:"20"}),e.jsx("option",{value:"20",children:"25"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"all",children:"All"})]})]}),e.jsx("div",{className:"text-sm font-medium",children:`${a==null?void 0:a.from}-${a==null?void 0:a.to} of ${a==null?void 0:a.total} Records`}),e.jsx(je,{links:w==null?void 0:w.links,perPage:p})]})]})]}),e.jsx(_e,{mappingDialog:$,setMappingDialog:F,mappingData:L,setBatchId:M})]})]})}export{Ye as default};
