import{r as i,j as s,Y as H,a as N,d as F,y}from"./app-Clb9Tjji.js";import{S as Y,E as G,C as Q,P as X}from"./ExportButton-D0yc7-a8.js";import{T as Z}from"./TextInput-i9WvBNmt.js";import{A as ee,C as se}from"./AuthenticatedLayout-DnKzWWky.js";import{r as h}from"./index-DvYlRkoY.js";import{_ as g}from"./index-BADGQqIO.js";import D from"./DateItemField-JHfD1qMi.js";import E from"./SelectItemField-DLcvcCVC.js";import re from"./InputItemField-BzOAKyT6.js";import le from"./UploadItemField-CyFKneYm.js";import ae from"./CSVMapping-CplQ1Kd3.js";import ne from"./SaveBtn-BQPossqZ.js";import"./createLucideIcon-BKW23D-M.js";import"./transition-BVo9X1AF.js";import"./floating-ui.dom-BJX5GPEt.js";import"./index-h6rCvnZU.js";import"./format-utaHABU8.js";import"./index-DL_CSCJj.js";import"./InputLabel-MrzsPhm5.js";import"./InputError-BFL7XPOM.js";function ke({auth:j,sites:d,get_data:r,batch:x}){var w;const{role:z}=j,A=[{name:"Site Name",sortable:!0,sortKey:"site_name"},{name:"Cell Name",sortable:!0,sortKey:"cell_name"},{name:"Lon",sortable:!0,sortKey:"lon"},{name:"Lat",sortable:!0,sortKey:"lat"},{name:"BB Type",sortable:!0,sortKey:"bb_type"},{name:"RRU Type",sortable:!0,sortKey:"rru_type"},{name:"Antenna Type",sortable:!0,sortKey:"antenna_type"},{name:"Frequency",sortable:!0,sortKey:"frequency"},{name:"PCI",sortable:!1,sortKey:"pci"},{name:"Azimuth",sortable:!1,sortKey:"azimuth"},{name:"Height",sortable:!1,sortKey:"height"},{name:"Last EPO",sortable:!1,sortKey:"last_epo"},{name:"Next EPO",sortable:!1,sortKey:"next_epo"},{name:"Solution Type",sortable:!1,sortKey:"solution_type"},{name:"Start Date",sortable:!1,sortKey:"start_date"},{name:"End Date",sortable:!1,sortKey:"end_date"},{name:"Status",sortable:!1,sortKey:"status"},{name:"Remarks",sortable:!1,sortKey:"remarks"},{name:"Artifacts",sortable:!1,sortKey:"artifacts"},{name:""}],I=i.useRef(null),[m,B]=i.useState(r!=null&&r.search?r==null?void 0:r.search:""),[S,O]=i.useState(r!=null&&r.per_page?r==null?void 0:r.per_page:10),[p]=i.useState(d),[R,C]=i.useState(!1),[W,J]=i.useState(""),[b,_]=i.useState(null),[k,v]=i.useState([]),$=e=>{I.current.click()},L=async e=>{var o,c,t;const a=new FormData;a.append("import_file",e.target.files[0]);try{const l=await F.post(route("site.field.name.import"),a);l!=null&&l.data&&(J(l==null?void 0:l.data),C(!0))}catch(l){g.error(`${(t=(c=(o=l==null?void 0:l.response)==null?void 0:o.data)==null?void 0:c.error)==null?void 0:t.message}`)}},U=async()=>{m&&y.get(route("site.field.name.index",{search:m}))},K=async(e,a)=>{y.get(route("site.field.name.index",{order_by:e,order:a}))},u=(e,a)=>{var o;if(e)return(o=e[a])==null?void 0:o.value},T=async(e,a)=>{y.get(route("site.field.name.index",{filter_by:e,value:a}))},V=e=>{O(e),y.get(route("site.field.name.index",{...r,per_page:e}))};i.useEffect(()=>{x!=null&&x.batch_field_id&&_(x==null?void 0:x.batch_field_id)},[]),i.useEffect(()=>{const e=async()=>{var o,c,t;try{let l=0;const n=await F.get(route("import.progress",{batchId:b}));if(n!=null&&n.data){let P=parseInt((o=n==null?void 0:n.data)==null?void 0:o.total_jobs),q=parseInt((c=n==null?void 0:n.data)==null?void 0:c.pending_jobs),M=P-q;parseInt((t=n==null?void 0:n.data)==null?void 0:t.failed_jobs)>0?clearInterval(a):(l=parseInt(M/P*100).toFixed(0),l<100?g.loading(`CSV Data Import Progress: ${l}%.
 Please wait....`,{id:"loading-toast",style:{backgroundColor:"#424242",color:"#ffffff",fontSize:14,borderRadius:4,fontWeight:"bold"}}):(g.dismiss("loading-toast"),clearInterval(a)))}}catch(l){console.log(l)}},a=setInterval(()=>{b&&e()},1e3);return()=>clearInterval(a)},[b]);const f=(e,a,o)=>{const c=k.findIndex(t=>t.site_id===e);v(c!==-1?t=>{const l=[...t];return l[c]={...l[c],items:{...l[c].items,[a]:o}},l}:t=>[...t,{site_id:e,items:{[a]:o}}])};return s.jsxs(ee,{user:j==null?void 0:j.user,children:[s.jsx(H,{title:"Site Field Name"}),s.jsx("div",{className:"top-section p-4",children:s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"",children:[s.jsx(h.Typography,{variant:"h3",className:"tracking-tight",children:"FW Site"}),s.jsxs("ul",{className:"flex gap-1 text-gray-600 text-sm",children:[s.jsx("li",{children:s.jsx(N,{href:route("dashboard"),children:"Dashboard"})}),s.jsx("li",{children:"/"}),s.jsx("li",{children:s.jsx(N,{href:route("site.field.name.index"),children:"FW Site"})})]})]})})}),s.jsx("div",{className:"filter-wrapper md:px-4",children:s.jsxs("div",{className:"flex filter-details justify-end gap-3",children:[s.jsxs("div",{className:"search-wrapper w-1/3 flex relative",children:[s.jsx(Z,{placeholder:"Search...",className:"w-full text-sm rounded-md rounded-r-none border-r-0 focus:ring-0 h-8",value:m,onChange:e=>B(e.target.value)}),s.jsx("div",{className:"search-icon",children:s.jsx(h.IconButton,{size:"sm",className:"rounded-l-none",onClick:U,children:s.jsx(Y,{color:"white",size:18})})})]}),s.jsx("div",{className:"status-filter",children:s.jsxs("select",{className:"w-52 text-sm rounded-md focus:ring-0 h-8 border-gray-300 py-1 text-gray-600 font-medium",onChange:e=>T("status",e.target.value),value:(r==null?void 0:r.filter_by)==="status"?r==null?void 0:r.value:"",children:[s.jsx("option",{value:"",children:"Filter by Status"}),s.jsx("option",{value:"in_progress",children:"In Progress"}),s.jsx("option",{value:"not_started",children:"Not Started"}),s.jsx("option",{value:"completed",children:"Completed"})]})}),s.jsx("div",{className:"filter-solution-type",children:s.jsxs("select",{className:"w-52 text-sm rounded-md focus:ring-0 h-8 border-gray-300 py-1 text-gray-600 font-medium",onChange:e=>T("solution_type",e.target.value),value:(r==null?void 0:r.filter_by)==="solution_type"?r==null?void 0:r.value:"",children:[s.jsx("option",{value:"",children:"Filter by Solution Type"}),s.jsx("option",{value:"opti_type_1",children:"Opti Type-1"}),s.jsx("option",{value:"opti_type_5",children:"Opti Type-5"}),s.jsx("option",{value:"opti_type_6",children:"Opti Type-6"})]})}),z==="super-admin"&&s.jsxs("div",{className:"import-type-field",children:[s.jsx(h.Button,{variant:"gradient",className:"capitalize",size:"sm",onClick:$,children:"Import from CSV"}),s.jsx("input",{type:"file",onChange:L,ref:I,style:{display:"none"}})]}),s.jsx(G,{route_name:"site.field.name.export",file_name:"FW Sites_Export"})]})}),s.jsxs("div",{className:"content mt-6",children:[s.jsx(h.Card,{className:"h-full w-full rounded-none",children:s.jsxs("div",{className:"overflow-x-auto overflow-hidden",children:[s.jsxs("table",{className:"w-full table-auto",children:[s.jsx("thead",{children:s.jsx("tr",{children:A.map(e=>s.jsx("th",{className:"border-y border-blue-gray-100 bg-blue-gray-50/50 p-2 border-l cursor-pointer",children:s.jsxs("div",{className:"flex justify-between",children:[s.jsx(h.Typography,{variant:"small",className:"leading-none text-gray-800 font-medium text-sm",children:e.name}),(e==null?void 0:e.sortable)&&s.jsxs("div",{className:"relative mt-1",children:[s.jsx("span",{className:"absolute -top-2 right-0 hover:bg-blue-gray-100 rounded-sm",children:s.jsx(Q,{size:12,strokeWidth:2,onClick:()=>{K(e.sortKey,"asc")}})}),s.jsx("span",{className:"absolute -bottom-1 right-0 hover:bg-blue-gray-100 rounded-sm",children:s.jsx(se,{size:12,strokeWidth:2,onClick:()=>{K(e.sortKey,"desc")}})})]})]})},e.name))})}),s.jsx("tbody",{children:p==null?void 0:p.data.map((e,a)=>s.jsxs("tr",{className:"even:bg-blue-gray-50/50",children:[s.jsx("td",{className:"border-l h-10 text-[12px] font-medium ps-2",children:s.jsx(N,{href:"#",className:"font-semibold",children:e==null?void 0:e.site_name})}),s.jsx("td",{className:"border-l h-10 text-[12px] font-medium ps-2",children:e==null?void 0:e.cell_name}),s.jsx("td",{className:"border-l h-10 text-[12px] font-medium ps-2",children:e==null?void 0:e.lon}),s.jsx("td",{className:"border-l h-10 text-[12px] font-medium ps-2",children:e==null?void 0:e.lat}),s.jsx("td",{className:"border-l h-10 text-[12px] font-medium ps-2",children:e==null?void 0:e.bb_type}),s.jsx("td",{className:"border-l h-10 text-[12px] font-medium ps-2",children:e==null?void 0:e.rru_type}),s.jsx("td",{className:"border-l h-10 text-[12px] font-medium ps-2",children:e==null?void 0:e.antenna_type}),s.jsx("td",{className:"border-l h-10 text-[12px] font-medium ps-2",children:e==null?void 0:e.frequency}),s.jsx("td",{className:"border-l h-10 text-[12px] font-medium ps-2",children:e==null?void 0:e.pci}),s.jsx("td",{className:"border-l h-10 text-[12px] font-medium ps-2",children:e==null?void 0:e.azimuth}),s.jsx("td",{className:"border-l h-10 text-[12px] font-medium ps-2",children:e==null?void 0:e.height}),s.jsx("td",{className:"border-l h-10 text-[12px] font-medium ps-2",children:e==null?void 0:e.last_epo}),s.jsx("td",{className:"border-l h-10 text-[12px] font-medium ps-2",children:e==null?void 0:e.next_epo}),s.jsx("td",{className:"border-l h-10",children:s.jsx(E,{value:u(e==null?void 0:e.tracking,"solution_type"),name:"solution_type",siteId:e==null?void 0:e.id,options:[{label:"Opti Type-1",value:"opti_type_1"},{label:"Opti Type-5",value:"opti_type_5"},{label:"Opti Type-6",value:"opti_type_6"}],handleEditAbleItem:f})}),s.jsx("td",{className:"border-l h-10",children:s.jsx(D,{value:u(e==null?void 0:e.tracking,"start_date"),name:"start_date",siteId:e==null?void 0:e.id,handleEditAbleItem:f})}),s.jsx("td",{className:"border-l h-10",children:s.jsx(D,{value:u(e==null?void 0:e.tracking,"end_date"),name:"end_date",siteId:e==null?void 0:e.id,handleEditAbleItem:f})}),s.jsx("td",{className:"border-l h-10",children:s.jsx(E,{value:u(e==null?void 0:e.tracking,"status"),name:"status",siteId:e==null?void 0:e.id,options:[{label:"In Progress",value:"in_progress"},{label:"Not Started",value:"not_started"},{label:"Completed",value:"completed"}],handleEditAbleItem:f})}),s.jsx("td",{className:"border-l h-10",children:s.jsx(re,{value:u(e==null?void 0:e.tracking,"remarks"),name:"remarks",siteId:e==null?void 0:e.id,handleEditAbleItem:f})}),s.jsx("td",{className:"border-l h-10",children:s.jsx(le,{value:u(e==null?void 0:e.tracking,"artifacts"),name:"artifacts",siteId:e==null?void 0:e.id})}),s.jsx("td",{className:"border-l h-10 px-3",children:s.jsx(ne,{site_id:e==null?void 0:e.id,changedItems:k,setChangedItems:v})})]},e==null?void 0:e.id))})]}),((w=p==null?void 0:p.data)==null?void 0:w.length)===0&&s.jsx(h.Typography,{variant:"h6",color:"blue-gray",className:"text-center py-6",children:"No data found"}),s.jsxs("div",{className:"md:flex grid justify-start md:justify-end items-center pt-6 mb-8 gap-3 px-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"text-sm font-medium",children:"Rows per Page"}),s.jsxs("select",{className:"rounded-md text-sm font-medium border-gray-400 focus:ring-0 py-2",value:S,onChange:e=>{V(e.target.value)},children:[s.jsx("option",{value:"10",children:"10"}),s.jsx("option",{value:"15",children:"15"}),s.jsx("option",{value:"20",children:"20"}),s.jsx("option",{value:"20",children:"25"}),s.jsx("option",{value:"50",children:"50"}),s.jsx("option",{value:"all",children:"All"})]})]}),s.jsx("div",{className:"text-sm font-medium",children:`${d==null?void 0:d.from}-${d==null?void 0:d.to} of ${d==null?void 0:d.total} Records`}),s.jsx(X,{links:p==null?void 0:p.links,perPage:S})]})]})}),s.jsx(ae,{mappingDialog:R,setMappingDialog:C,mappingData:W,setBatchId:_})]})]})}export{ke as default};
