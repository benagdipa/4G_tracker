import{r as a,j as e,Y as z,a as d,b as N}from"./app-okMzQBCh.js";import{I as v}from"./InputError-ug9kAuqE.js";import{I as A}from"./InputLabel-J2I8uczY.js";import{c as R,A as Q}from"./AuthenticatedLayout-u_Ch8pw6.js";import{r as i}from"./index-BG5T_7Hs.js";import{A as B}from"./index.esm-DRFmu6w4.js";import"./transition-DtIsPh0T.js";import"./ApplicationLogo-DQ_0DyDy.js";/**
 * @license lucide-react v0.376.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=R("Table2",[["path",{d:"M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18",key:"gugj83"}]]);function F({auth:o,tablesNames:w}){const[m,x]=a.useState(""),[u,h]=a.useState(!1),[S,f]=a.useState(""),[c,p]=a.useState([]),[I,j]=a.useState(!1),[M,g]=a.useState(!1),[k,C]=a.useState(""),[b,T]=a.useState(""),y=async s=>{var n,l,t;s&&s.preventDefault();try{j(!0);const r=await N.post(route("sql.run"),{sql_query:m});p((n=r==null?void 0:r.data)==null?void 0:n.data),f("")}catch(r){f((t=(l=r==null?void 0:r.response)==null?void 0:l.data)==null?void 0:t.error.message),p([])}finally{j(!1),h(!1)}};a.useEffect(()=>{u&&y()},[u]);const q=async()=>{var s,n,l;if((c==null?void 0:c.length)>0)try{g(!0);const t=await N.post(route("sql.store"),{data:c});T((s=t==null?void 0:t.data)==null?void 0:s.success.message)}catch(t){C((l=(n=t==null?void 0:t.response)==null?void 0:n.data)==null?void 0:l.error.message)}finally{g(!1)}},D=a.useMemo(()=>({filter:!0})),E=s=>{x(`select * from ${s}`),h(!0)},L=({data:s})=>{if((s==null?void 0:s.length)>0){const l=Array.from(new Set(s.flatMap(t=>Object.keys(t)))).map((t,r)=>({field:t,headerName:t}));return e.jsxs("div",{className:"mt-8",children:[e.jsx("div",{className:"ag-theme-quartz w-full",style:{height:(s==null?void 0:s.length)>5?500:200},children:e.jsx(B,{rowData:s,columnDefs:l,defaultColDef:D})}),e.jsxs("div",{className:"flex justify-between mt-6",children:[e.jsxs("div",{className:"",children:[e.jsx(v,{message:k,className:"mt-0 font-medium text-red-500"}),b&&e.jsxs(i.Typography,{className:"font-medium text-green-500",children:[b,e.jsx(d,{href:route("wireless.sites.index"),className:"ps-1 underline",children:"Click here to check"})]})]}),e.jsx(i.Button,{variant:"gradient",size:"sm",className:"capitalize",onClick:q,disabled:M,children:"Import Data"})]})]})}};return e.jsxs(Q,{user:o==null?void 0:o.user,children:[e.jsx(z,{title:"Wireless Sites"}),e.jsx("div",{className:"top-section p-4",children:e.jsx("div",{className:"bg-white shadow rounded py-3 px-5 flex justify-between items-center",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"",children:[e.jsx(i.Typography,{variant:"h3",className:"tracking-tight",children:"SQL Import"}),e.jsxs("ul",{className:"flex gap-1 text-gray-600 text-sm",children:[e.jsx("li",{children:e.jsx(d,{href:route("dashboard"),children:"Dashboard"})}),e.jsx("li",{children:"/"}),e.jsx("li",{children:e.jsx(d,{href:route("sql.import"),children:"SQL Import"})})]})]})})})}),e.jsxs("div",{className:"flex w-full mt-6 ",children:[e.jsx("div",{className:" ml-2",children:e.jsxs("div",{className:" bg-white shadow rounded py-3 px-5",children:[e.jsx("h1",{className:"mb-2 text-xl font-bold",children:"Tables"}),e.jsx("div",{className:"",children:e.jsx("ul",{children:w.map(s=>e.jsxs("li",{className:" font-medium text-sm flex items-center mb-1 cursor-pointer text-gray-700 dark:text-gray-300 gap-2",onClick:()=>E(s==null?void 0:s.tablename),children:[e.jsx(H,{size:"16"}),s==null?void 0:s.tablename]},s==null?void 0:s.tablename))})})]})}),e.jsxs("div",{className:"w-[90%] filter-wrapper px-4",children:[e.jsxs(i.Card,{className:"w-full px-6 py-4",children:[e.jsx(A,{value:"SQl Code",className:"mb-2"}),e.jsx("textarea",{className:"border rounded-md border-gray-300 text-base font-medium focus:ring-0",rows:3,value:m,onChange:s=>x(s.target.value)}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:e.jsx(v,{message:S,className:"mt-0 font-medium text-red-500"})}),e.jsx(i.Button,{className:"mt-4 block capitalize",onClick:y,disabled:I,children:"Run"})]})]}),e.jsx(L,{data:c})]})]})]})}export{F as default};
