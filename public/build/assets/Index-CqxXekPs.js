import{r as a,j as e,Y as D,a as m,b as j}from"./app-ZJVYOzKk.js";import{I as g}from"./InputError-B8r5CHVD.js";import{I as E}from"./InputLabel-B7_h9EBA.js";import{A}from"./AuthenticatedLayout-GSa4eCUk.js";import{r as o}from"./index-BO9AAvUu.js";import{A as L}from"./index.esm-iTnSNEIC.js";import"./transition-BEG0F1zu.js";import"./ApplicationLogo-bjSOslKc.js";function W({auth:c}){const[d,y]=a.useState(""),[N,u]=a.useState(""),[n,x]=a.useState([]),[b,p]=a.useState(!1),[v,h]=a.useState(!1),[w,S]=a.useState(""),[f,I]=a.useState(""),M=async t=>{var i,l,s;t.preventDefault();try{p(!0);const r=await j.post(route("sql.run"),{sql_query:d});x((i=r==null?void 0:r.data)==null?void 0:i.data),u("")}catch(r){u((s=(l=r==null?void 0:r.response)==null?void 0:l.data)==null?void 0:s.error.message),x([])}finally{p(!1)}},k=async()=>{var t,i,l;if((n==null?void 0:n.length)>0)try{h(!0);const s=await j.post(route("sql.store"),{data:n});I((t=s==null?void 0:s.data)==null?void 0:t.success.message)}catch(s){S((l=(i=s==null?void 0:s.response)==null?void 0:i.data)==null?void 0:l.error.message)}finally{h(!1)}},q=a.useMemo(()=>({filter:!0})),C=({data:t})=>{if(console.log(t),(t==null?void 0:t.length)>0){const l=Array.from(new Set(t.flatMap(s=>Object.keys(s)))).map((s,r)=>({field:s,headerName:s}));return e.jsxs("div",{className:"mt-8",children:[e.jsx("div",{className:"ag-theme-quartz w-full",style:{height:t.length>5?500:200},children:e.jsx(L,{rowData:t,columnDefs:l,defaultColDef:q})}),e.jsxs("div",{className:"flex justify-between mt-6",children:[e.jsxs("div",{className:"",children:[e.jsx(g,{message:w,className:"mt-0 font-medium text-red-500"}),f&&e.jsxs(o.Typography,{className:"font-medium text-green-500",children:[f,e.jsx(m,{href:route("wireless.sites.index"),className:"ps-1 underline",children:"Click here to check"})]})]}),e.jsx(o.Button,{variant:"gradient",size:"sm",className:"capitalize",onClick:k,disabled:v,children:"Import Data"})]})]})}};return e.jsxs(A,{user:c==null?void 0:c.user,children:[e.jsx(D,{title:"Wireless Sites"}),e.jsx("div",{className:"top-section p-4",children:e.jsx("div",{className:"bg-white shadow rounded py-3 px-5 flex justify-between items-center",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"",children:[e.jsx(o.Typography,{variant:"h3",className:"tracking-tight",children:"SQL Import"}),e.jsxs("ul",{className:"flex gap-1 text-gray-600 text-sm",children:[e.jsx("li",{children:e.jsx(m,{href:route("dashboard"),children:"Dashboard"})}),e.jsx("li",{children:"/"}),e.jsx("li",{children:e.jsx(m,{href:route("sql.import"),children:"SQL Import"})})]})]})})})}),e.jsxs("div",{className:"filter-wrapper px-4",children:[e.jsxs(o.Card,{className:"mt-6 w-full px-6 py-4",children:[e.jsx(E,{value:"SQl Code",className:"mb-2"}),e.jsx("textarea",{className:"border rounded-md border-gray-300 text-base font-medium focus:ring-0",rows:3,value:d,onChange:t=>y(t.target.value)}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:e.jsx(g,{message:N,className:"mt-0 font-medium text-red-500"})}),e.jsx(o.Button,{className:"mt-4 block capitalize",onClick:M,disabled:b,children:"Run"})]})]}),e.jsx(C,{data:n})]})]})}export{W as default};
